rules:
  - id: c-crypto-hardcoded-key
    message: Hardcoded cryptographic key detected
    severity: INFO
    languages:
      - c
    patterns:
      - patterns:
          - metavariable-regex:
              metavariable: $KEY
              regex: (?i).*(key|secret|password|passphrase|aes_key|des_key|rc4_key|iv|nonce|salt|encryption_key|decryption_key).*
          - pattern-either:
              - pattern: |
                  unsigned char $KEY[] = "$STRING";
              - pattern: |
                  char $KEY[] = "$STRING";
              - pattern: |
                  const unsigned char $KEY[] = "$STRING";
              - pattern: |
                  const char $KEY[] = "$STRING";
              - pattern: |
                  static unsigned char $KEY[] = "$STRING";
              - pattern: |
                  static char $KEY[] = "$STRING";
              - pattern: |
                  #define $KEY "$STRING"
              - pattern: |
                  unsigned char $KEY[$LEN] = {$BYTES};
              - pattern: |
                  const unsigned char $KEY[$LEN] = {$BYTES};
              - pattern: |
                  static unsigned char $KEY[$LEN] = {$BYTES};
    metadata:
      category: crypto
      cwe: CWE-798
      impact: "Inventory: Hardcoded cryptographic key detected in codebase"
