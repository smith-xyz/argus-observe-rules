rules:
  - id: c-crypto-digital-signatures
    message: Digital signature operations detected
    severity: INFO
    languages:
      - c
    patterns:
      - pattern-either:
          - pattern: EVP_SignInit_ex($CTX, $TYPE, $ENGINE)
          - pattern: EVP_SignUpdate($CTX, $DATA, $DATALEN)
          - pattern: EVP_SignFinal($CTX, $SIG, $SIGLEN, $PKEY)
          - pattern: EVP_VerifyInit_ex($CTX, $TYPE, $ENGINE)
          - pattern: EVP_VerifyUpdate($CTX, $DATA, $DATALEN)
          - pattern: EVP_VerifyFinal($CTX, $SIG, $SIGLEN, $PKEY)
          - pattern: EVP_DigestSignInit($CTX, $PKCTX, $TYPE, $ENGINE, $PKEY)
          - pattern: EVP_DigestSignUpdate($CTX, $DATA, $DATALEN)
          - pattern: EVP_DigestSignFinal($CTX, $SIG, $SIGLEN)
          - pattern: EVP_DigestVerifyInit($CTX, $PKCTX, $TYPE, $ENGINE, $PKEY)
          - pattern: EVP_DigestVerifyUpdate($CTX, $DATA, $DATALEN)
          - pattern: EVP_DigestVerifyFinal($CTX, $SIG, $SIGLEN)
          - pattern: RSA_sign($TYPE, $M, $MLEN, $SIGRET, $SIGLEN, $RSA)
          - pattern: RSA_verify($TYPE, $M, $MLEN, $SIGBUF, $SIGLEN, $RSA)
          - pattern: ECDSA_sign($TYPE, $DGST, $DGSTLEN, $SIG, $SIGLEN, $ECKEY)
          - pattern: ECDSA_verify($TYPE, $DGST, $DGSTLEN, $SIG, $SIGLEN, $ECKEY)
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: Digital signature operations detected in codebase"
