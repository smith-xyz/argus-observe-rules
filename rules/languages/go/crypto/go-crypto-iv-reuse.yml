rules:
  - id: go-crypto-iv-reuse
    message: Initialization vector (IV) usage detected
    severity: INFO
    languages:
      - go
    patterns:
      - pattern-either:
          - pattern: |
              $IV := []byte("$STATIC_VALUE")
              ...
              cipher.NewCBCEncrypter($BLOCK, $IV)
          - pattern: |
              $IV := make([]byte, $SIZE)
              ...
              cipher.NewCBCEncrypter($BLOCK, $IV)
          - pattern: |
              var $IV = []byte("$STATIC_VALUE")
              ...
              cipher.NewGCM($BLOCK).Seal($DST, $IV, $PLAINTEXT, $DATA)
          - pattern: cipher.NewCBCEncrypter($BLOCK, []byte("$STATIC_IV"))
          - pattern: cipher.NewCBCDecrypter($BLOCK, []byte("$STATIC_IV"))
    metadata:
      category: crypto
      cwe: CWE-329
      impact: "Inventory: Initialization vector (IV) usage detected in codebase"
