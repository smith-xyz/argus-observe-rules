rules:
  - id: go-weak-random-crypto
    message: Weak random number generation for cryptographic use
    severity: ERROR
    languages:
      - go
    patterns:
      - pattern-either:
          - pattern: |
              $KEY := make([]byte, $SIZE)
              ...
              rand.Read($KEY)
          - pattern: |
              $IV := make([]byte, $SIZE)
              ...
              rand.Read($IV)
          - pattern: math_rand.Read($BYTES)
          - pattern: |
              rand.Seed($SEED)
              ...
              rand.Intn($MAX)
    fix: "Use crypto/rand for cryptographic randomness: crypto_rand.Read()"
    metadata:
      category: crypto
      cwe: CWE-338
