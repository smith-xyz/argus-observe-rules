rules:
  - id: go-weak-cipher-rc2
    message: RC2 cipher is cryptographically weak and obsolete
    severity: ERROR
    languages:
      - go
    patterns:
      - pattern-either:
          - pattern: rc2.NewCipher($KEY)
          - pattern: $CIPHER := rc2.NewCipher($KEY)
          - pattern: cipher.NewCBCEncrypter(rc2.NewCipher($KEY), $IV)
          - pattern: cipher.NewCBCDecrypter(rc2.NewCipher($KEY), $IV)
          - pattern: |
              $BLOCK := rc2.NewCipher($KEY)
              ...
              cipher.NewCBCEncrypter($BLOCK, $IV)
    fix: "Use AES encryption instead: aes.NewCipher()"
    metadata:
      category: crypto
      cwe: CWE-327
