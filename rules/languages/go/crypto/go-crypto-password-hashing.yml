rules:
  - id: go-crypto-password-hashing
    message: Password hashing operations detected
    severity: INFO
    languages:
      - go
    patterns:
      - pattern-either:
          - pattern: bcrypt.GenerateFromPassword($PASSWORD, $COST)
          - pattern: bcrypt.CompareHashAndPassword($HASH, $PASSWORD)
          - pattern: pbkdf2.Key($PASSWORD, $SALT, $ITER, $KEYLEN, $HASH)
          - pattern: scrypt.Key($PASSWORD, $SALT, $N, $R, $P, $KEYLEN)
          - pattern: argon2.Key($PASSWORD, $SALT, $TIME, $MEMORY, $THREADS, $KEYLEN)
          - pattern: argon2.IDKey($PASSWORD, $SALT, $TIME, $MEMORY, $THREADS, $KEYLEN)
          - pattern: |
              $HASH, $ERR := bcrypt.GenerateFromPassword($PASSWORD, $COST)
              ...
              bcrypt.CompareHashAndPassword($HASH, $INPUT)
    metadata:
      category: crypto
      cwe: CWE-326
      impact: "Inventory: Password hashing operations detected in codebase"
