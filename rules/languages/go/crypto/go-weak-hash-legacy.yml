rules:
  - id: go-weak-hash-legacy
    message: Legacy weak hash function detected
    severity: WARNING
    languages:
      - go
    patterns:
      - pattern-either:
          - pattern: md4.New()
          - pattern: md4.Sum($DATA)
          - pattern: ripemd160.New()
          - pattern: |
              hasher := md4.New()
              ...
              hasher.Write($DATA)
              ...
              $HASH := hasher.Sum(nil)
    fix: Use SHA-256 or SHA-3 for cryptographic hashing
    metadata:
      category: crypto
      cwe: CWE-327
