rules:
  - id: java-crypto-hardcoded-key
    message: Hardcoded cryptographic key detected
    severity: INFO
    languages:
      - java
    mode: taint
    pattern-sources:
      - pattern: private static final String $KEY = "$VALUE";
      - pattern: public static final String $KEY = "$VALUE";
      - pattern: private static final byte[] $KEY = {$BYTES};
      - pattern: final String $KEY = "$VALUE";
      - pattern: String $KEY = "$VALUE";
      - pattern: private String $KEY = "$VALUE";
      - pattern: final byte[] $KEY = {$BYTES};
      - pattern: byte[] $KEY = {$BYTES};
      - pattern: $KEY = "$VALUE"
      - pattern: new SecretKeySpec("$KEY".getBytes(), $ALGO)
      - pattern: new SecretKeySpec("$KEY".getBytes(), "AES")
    pattern-sinks:
      - pattern: new SecretKeySpec($KEY.getBytes(), $ALGO)
      - pattern: new SecretKeySpec($KEY, $ALGO)
      - pattern: new SecretKeySpec("$KEY".getBytes(), $ALGO)
      - pattern: new SecretKeySpec(new byte[] {$BYTES}, $ALGO)
      - pattern: $CIPHER.init(Cipher.ENCRYPT_MODE, new SecretKeySpec($KEY.getBytes(), $ALGO))
      - pattern: $CIPHER.init(Cipher.DECRYPT_MODE, new SecretKeySpec($KEY.getBytes(), $ALGO))
      - pattern: $MAC.init(new SecretKeySpec($KEY.getBytes(), $ALGO))
    metadata:
      category: crypto
      cwe: CWE-798
      impact: "Inventory: Hardcoded cryptographic key detected in codebase"
