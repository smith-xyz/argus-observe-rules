rules:
- id: rust-crypto-key-length
  message: Cryptographic key length usage detected
  severity: INFO
  languages:
  - rust
  patterns:
  - pattern-either:
    - patterns:
      - pattern: openssl::rsa::Rsa::generate($BITS)
      - metavariable-regex:
          metavariable: $BITS
          regex: \d+
    - patterns:
      - pattern: rsa::RsaPrivateKey::new($RNG, $BITS)
      - metavariable-regex:
          metavariable: $BITS
          regex: \d+
  - pattern-not-inside: |
      #[test]
      fn $TEST() {
          ...
      }
  - pattern-not-inside: |
      #[cfg(test)]
      mod $MODULE {
          ...
      }
  - pattern-not-inside: |
      mod tests {
          ...
      }
  focus-metavariable: $BITS
  metadata:
    category: crypto
    cwe: CWE-326
    impact: 'Inventory: Cryptographic key length usage detected in codebase'
