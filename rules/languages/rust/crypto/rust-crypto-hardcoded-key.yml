rules:
  - id: rust-crypto-hardcoded-key
    message: Hardcoded cryptographic key detected
    severity: INFO
    languages:
      - rust
    mode: taint
    pattern-sources:
      - pattern: |
          let $KEY = "$VALUE";
      - pattern: |
          const $KEY: &str = "$VALUE";
      - pattern: |
          const $KEY: &[u8] = b"$VALUE";
      - pattern: |
          static $KEY: &str = "$VALUE";
      - pattern: |
          static $KEY: &[u8] = b"$VALUE";
      - pattern: ring::aead::SealingKey::new(&ring::aead::AES_256_GCM, b"$KEY")
      - pattern: ring::aead::OpeningKey::new(&ring::aead::AES_256_GCM, b"$KEY")
      - pattern: ring::hmac::Key::new(&ring::hmac::HMAC_SHA256, b"$KEY")
      - pattern: aes::Aes256::new(b"$KEY")
      - pattern: aes_gcm::Aes256Gcm::new(b"$KEY")
    pattern-sinks:
      - pattern: ring::aead::SealingKey::new($ALGO, $KEY)
      - pattern: ring::aead::OpeningKey::new($ALGO, $KEY)
      - pattern: ring::hmac::Key::new($ALGO, $KEY)
      - pattern: openssl::symm::encrypt($CIPHER, $KEY, $IV, $DATA)
      - pattern: openssl::symm::decrypt($CIPHER, $KEY, $IV, $DATA)
      - pattern: openssl::symm::encrypt($CIPHER, $KEY.as_bytes(), $IV, $DATA)
      - pattern: openssl::symm::decrypt($CIPHER, $KEY.as_bytes(), $IV, $DATA)
      - pattern: aes::Aes256::new($KEY)
      - pattern: aes_gcm::Aes256Gcm::new($KEY)
    metadata:
      category: crypto
      cwe: CWE-798
      impact: "Inventory: Hardcoded cryptographic key detected in codebase"
