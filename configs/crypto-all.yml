rules:
  - id: c-crypto-blake2
    message: BLAKE2 hash function usage detected
    severity: INFO
    languages:
      - c
    patterns:
      - pattern-either:
          - pattern: EVP_DigestInit_ex($CTX, EVP_blake2b512(), $ENGINE)
          - pattern: EVP_DigestInit_ex($CTX, EVP_blake2s256(), $ENGINE)
          - pattern: EVP_Digest($DATA, $LEN, $HASH, $SIZE, EVP_blake2b512(), $ENGINE)
          - pattern: EVP_Digest($DATA, $LEN, $HASH, $SIZE, EVP_blake2s256(), $ENGINE)
          - pattern: blake2b_init($STATE, $OUTLEN)
          - pattern: blake2b_update($STATE, $DATA, $DATALEN)
          - pattern: blake2b_final($STATE, $OUT, $OUTLEN)
          - pattern: blake2s_init($STATE, $OUTLEN)
          - pattern: blake2s_update($STATE, $DATA, $DATALEN)
          - pattern: blake2s_final($STATE, $OUT, $OUTLEN)
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: BLAKE2 hash function usage detected in codebase"
      libraries:
        - OpenSSL (EVP_blake2b512, EVP_blake2s256)
        - libsodium/standalone (blake2b_*, blake2s_*)
  - id: c-crypto-cipher-aes
    message: AES cipher usage detected
    severity: INFO
    languages:
      - c
    patterns:
      - pattern-either:
          - patterns:
              - pattern: AES_set_encrypt_key($KEY, $BITS, $SCHEDULE)
              - metavariable-regex:
                  metavariable: $BITS
                  regex: (128|192|256)
              - focus-metavariable: $BITS
          - patterns:
              - pattern: AES_set_decrypt_key($KEY, $BITS, $SCHEDULE)
              - metavariable-regex:
                  metavariable: $BITS
                  regex: (128|192|256)
              - focus-metavariable: $BITS
          - pattern: AES_encrypt($INPUT, $OUTPUT, $SCHEDULE)
          - pattern: AES_decrypt($INPUT, $OUTPUT, $SCHEDULE)
          - pattern: AES_cbc_encrypt($INPUT, $OUTPUT, $LENGTH, $SCHEDULE, $IV, $ENCRYPT)
          - pattern: EVP_CipherInit_ex($CTX, EVP_aes_256_cbc(), $ENGINE, $KEY, $IV, $ENCRYPT)
          - pattern: EVP_CipherInit_ex($CTX, EVP_aes_256_gcm(), $ENGINE, $KEY, $IV, $ENCRYPT)
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: AES cipher usage detected in codebase"
  - id: c-crypto-diffie-hellman
    message: Diffie-Hellman key exchange detected
    severity: INFO
    languages:
      - c
    patterns:
      - pattern-either:
          - pattern: DH_new()
          - pattern: DH_generate_parameters_ex($DH, $PRIME_LEN, $GENERATOR, $BN)
          - pattern: DH_generate_key($DH)
          - pattern: DH_compute_key($KEY, $PUBKEY, $DH)
          - pattern: EVP_PKEY_new_DH($DH)
          - pattern: EVP_PKEY_assign_DH($PKEY, $DH)
          - pattern: EVP_PKEY_CTX_new_id(EVP_PKEY_DH, $ENGINE)
          - pattern: EVP_PKEY_derive_init($CTX)
          - pattern: EVP_PKEY_derive_set_peer($CTX, $PEER)
          - pattern: EVP_PKEY_derive($CTX, $KEY, $KEYLEN)
          - pattern: DH_set0_pqg($DH, $P, $Q, $G)
          - pattern: DH_get0_pqg($DH, $P, $Q, $G)
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: Diffie-Hellman key exchange detected in codebase"
  - id: c-crypto-random-generation
    message: Random number generation for cryptographic use detected
    severity: INFO
    languages:
      - c
    patterns:
      - pattern-either:
          - pattern: RAND_bytes($BUF, $NUM)
          - pattern: RAND_pseudo_bytes($BUF, $NUM)
          - pattern: RAND_seed($BUF, $NUM)
          - pattern: RAND_add($BUF, $NUM, $ENTROPY)
          - pattern: |
              unsigned char $BUF[$LEN];
              RAND_bytes($BUF, $LEN);
              ...
          - pattern: open("/dev/random", $FLAGS)
          - pattern: open("/dev/urandom", $FLAGS)
          - pattern: getrandom($BUF, $BUFLEN, $FLAGS)
          - pattern: arc4random()
          - pattern: arc4random_buf($BUF, $BUFLEN)
          - pattern: arc4random_uniform($UPPER_BOUND)
          - pattern: BCryptGenRandom($PROV, $BUF, $LEN, $FLAGS)
          - pattern: randombytes_buf($BUF, $BUFLEN)
          - pattern: randombytes_random()
          - pattern: randombytes_uniform($UPPER_BOUND)
    metadata:
      category: crypto
      cwe: CWE-338
      impact:
        "Inventory: Random number generation for cryptographic use detected in
        codebase"
  - id: c-crypto-key-derivation
    message: Key derivation function usage detected
    severity: INFO
    languages:
      - c
    patterns:
      - pattern-either:
          - patterns:
              - pattern:
                  PKCS5_PBKDF2_HMAC($PASS, $PASSLEN, $SALT, $SALTLEN, $ITER, $DIGEST,
                  $KEYLEN, $OUT)
              - metavariable-regex:
                  metavariable: $ITER
                  regex: \d+
              - focus-metavariable: $ITER
          - patterns:
              - pattern:
                  PKCS5_PBKDF2_HMAC_SHA1($PASS, $PASSLEN, $SALT, $SALTLEN, $ITER, $KEYLEN,
                  $OUT)
              - metavariable-regex:
                  metavariable: $ITER
                  regex: \d+
              - focus-metavariable: $ITER
          - patterns:
              - pattern:
                  EVP_BytesToKey($TYPE, $MD, $SALT, $DATA, $DATALEN, $COUNT, $KEY,
                  $IV)
              - metavariable-regex:
                  metavariable: $COUNT
                  regex: \d+
              - focus-metavariable: $COUNT
          - patterns:
              - pattern:
                  EVP_PBE_scrypt($PASS, $PASSLEN, $SALT, $SALTLEN, $N, $R, $P, $MAXMEM,
                  $KEY, $KEYLEN)
              - metavariable-regex:
                  metavariable: $N
                  regex: \d+
              - focus-metavariable: $N
          - pattern: EVP_PKEY_derive_init($CTX)
          - pattern: EVP_PKEY_derive($CTX, $KEY, $KEYLEN)
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: Key derivation function usage detected in codebase"
  - id: c-crypto-openssl-provider
    message: OpenSSL 3.0 provider API usage detected
    severity: INFO
    languages:
      - c
    patterns:
      - pattern-either:
          - pattern: OSSL_PROVIDER_load($LIBCTX, $NAME)
          - pattern: OSSL_PROVIDER_unload($PROV)
          - pattern: OSSL_PROVIDER_available($LIBCTX, $NAME)
          - pattern: EVP_CIPHER_fetch($CTX, $ALGORITHM, $PROPERTIES)
          - pattern: EVP_CIPHER_free($CIPHER)
          - pattern: EVP_MD_fetch($CTX, $ALGORITHM, $PROPERTIES)
          - pattern: EVP_MD_free($MD)
          - pattern: EVP_PKEY_sign($CTX, $SIG, $SIGLEN, $TBS, $TBSLEN)
          - pattern: EVP_PKEY_verify($CTX, $SIG, $SIGLEN, $TBS, $TBSLEN)
          - pattern: EVP_PKEY_verify_recover($CTX, $RMSG, $RMSGLEN, $SIG, $SIGLEN)
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: OpenSSL 3.0 provider API usage detected in codebase"
  - id: c-crypto-libgcrypt
    message: Libgcrypt cryptographic library usage detected
    severity: INFO
    languages:
      - c
    patterns:
      - pattern-either:
          - pattern: gcry_cipher_open($HANDLE, $ALGO, $MODE, $FLAGS)
          - pattern: gcry_cipher_close($HANDLE)
          - pattern: gcry_cipher_setkey($HANDLE, $KEY, $KEYLEN)
          - pattern: gcry_cipher_setiv($HANDLE, $IV, $IVLEN)
          - pattern: gcry_cipher_encrypt($HANDLE, $OUT, $OUTLEN, $IN, $INLEN)
          - pattern: gcry_cipher_decrypt($HANDLE, $OUT, $OUTLEN, $IN, $INLEN)
          - pattern: gcry_md_open($HANDLE, $ALGO, $FLAGS)
          - pattern: gcry_md_close($HANDLE)
          - pattern: gcry_md_write($HANDLE, $BUFFER, $LENGTH)
          - pattern: gcry_md_read($HANDLE, $ALGO)
          - pattern: gcry_md_hash_buffer($ALGO, $RESULT, $BUFFER, $LENGTH)
          - pattern: gcry_pk_generate($KEY, $ALGO, $NALGO, $PARAMS)
          - pattern: gcry_pk_encrypt($KEY, $DATA, $RESULT)
          - pattern: gcry_pk_decrypt($KEY, $DATA, $RESULT)
          - pattern: gcry_pk_sign($KEY, $SIG, $DATA)
          - pattern: gcry_pk_verify($KEY, $SIG, $DATA)
          - pattern: gcry_randomize($BUFFER, $LENGTH, $LEVEL)
          - pattern: gcry_create_nonce($BUFFER, $LENGTH)
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: Libgcrypt cryptographic library usage detected in codebase"
  - id: c-crypto-sha1
    message: SHA1 hash function usage detected
    severity: INFO
    languages:
      - c
    patterns:
      - pattern-either:
          - pattern: SHA1_Init($CTX)
          - pattern: SHA1_Update($CTX, $DATA, $LEN)
          - pattern: SHA1_Final($HASH, $CTX)
          - pattern: |
              SHA_CTX $CTX;
              SHA1_Init(&$CTX);
              SHA1_Update(&$CTX, $DATA, $LEN);
              SHA1_Final($HASH, &$CTX);
          - pattern: EVP_DigestInit_ex($CTX, EVP_sha1(), $ENGINE)
          - pattern: EVP_Digest($DATA, $LEN, $HASH, $SIZE, EVP_sha1(), $ENGINE)
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: SHA1 hash function usage detected in codebase"
  - id: c-crypto-cipher-modes
    message: Cipher mode usage detected
    severity: INFO
    languages:
      - c
    patterns:
      - pattern-either:
          - pattern: EVP_CipherInit_ex($CTX, EVP_aes_128_ecb(), $ENGINE, $KEY, $IV, $ENCRYPT)
          - pattern: EVP_CipherInit_ex($CTX, EVP_aes_256_ecb(), $ENGINE, $KEY, $IV, $ENCRYPT)
          - pattern: EVP_CipherInit_ex($CTX, EVP_aes_128_cbc(), $ENGINE, $KEY, $IV, $ENCRYPT)
          - pattern: EVP_CipherInit_ex($CTX, EVP_aes_256_cbc(), $ENGINE, $KEY, $IV, $ENCRYPT)
          - pattern: EVP_CipherInit_ex($CTX, EVP_aes_128_cfb(), $ENGINE, $KEY, $IV, $ENCRYPT)
          - pattern: EVP_CipherInit_ex($CTX, EVP_aes_256_cfb(), $ENGINE, $KEY, $IV, $ENCRYPT)
          - pattern: EVP_CipherInit_ex($CTX, EVP_aes_128_ofb(), $ENGINE, $KEY, $IV, $ENCRYPT)
          - pattern: EVP_CipherInit_ex($CTX, EVP_aes_256_ofb(), $ENGINE, $KEY, $IV, $ENCRYPT)
          - pattern: EVP_CipherInit_ex($CTX, EVP_aes_128_ctr(), $ENGINE, $KEY, $IV, $ENCRYPT)
          - pattern: EVP_CipherInit_ex($CTX, EVP_aes_256_ctr(), $ENGINE, $KEY, $IV, $ENCRYPT)
          - pattern: EVP_CipherInit_ex($CTX, EVP_aes_128_gcm(), $ENGINE, $KEY, $IV, $ENCRYPT)
          - pattern: EVP_CipherInit_ex($CTX, EVP_aes_256_gcm(), $ENGINE, $KEY, $IV, $ENCRYPT)
          - pattern: EVP_CipherInit_ex($CTX, EVP_aes_128_ccm(), $ENGINE, $KEY, $IV, $ENCRYPT)
          - pattern: EVP_CipherInit_ex($CTX, EVP_aes_256_ccm(), $ENGINE, $KEY, $IV, $ENCRYPT)
          - pattern: EVP_CipherInit_ex($CTX, EVP_aes_128_xts(), $ENGINE, $KEY, $IV, $ENCRYPT)
          - pattern: EVP_CipherInit_ex($CTX, EVP_aes_256_xts(), $ENGINE, $KEY, $IV, $ENCRYPT)
          - pattern: AES_cbc_encrypt($INPUT, $OUTPUT, $LENGTH, $SCHEDULE, $IV, $ENCRYPT)
          - pattern:
              AES_cfb128_encrypt($INPUT, $OUTPUT, $LENGTH, $SCHEDULE, $IV, $NUM,
              $ENCRYPT)
          - pattern: AES_ofb128_encrypt($INPUT, $OUTPUT, $LENGTH, $SCHEDULE, $IV, $NUM)
          - pattern:
              AES_ctr128_encrypt($INPUT, $OUTPUT, $LENGTH, $SCHEDULE, $IV, $ECBCOUNT,
              $BUFFER, $NUM)
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: Cipher mode usage detected in codebase"
  - id: c-crypto-md4
    message: MD4 hash function usage detected
    severity: INFO
    languages:
      - c
    patterns:
      - pattern-either:
          - pattern: MD4_Init($CTX)
          - pattern: MD4_Update($CTX, $DATA, $LEN)
          - pattern: MD4_Final($HASH, $CTX)
          - pattern: |
              MD4_CTX $CTX;
              MD4_Init(&$CTX);
              MD4_Update(&$CTX, $DATA, $LEN);
              MD4_Final($HASH, &$CTX);
          - pattern: EVP_DigestInit_ex($CTX, EVP_md4(), $ENGINE)
          - pattern: EVP_Digest($DATA, $LEN, $HASH, $SIZE, EVP_md4(), $ENGINE)
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: MD4 hash function usage detected in codebase"
  - id: c-crypto-sha256
    message: SHA256 hash function usage detected
    severity: INFO
    languages:
      - c
    patterns:
      - pattern-either:
          - pattern: SHA256_Init($CTX)
          - pattern: SHA256_Update($CTX, $DATA, $LEN)
          - pattern: SHA256_Final($HASH, $CTX)
          - pattern: |
              SHA256_CTX $CTX;
              SHA256_Init(&$CTX);
              SHA256_Update(&$CTX, $DATA, $LEN);
              SHA256_Final($HASH, &$CTX);
          - pattern: EVP_DigestInit_ex($CTX, EVP_sha256(), $ENGINE)
          - pattern: EVP_Digest($DATA, $LEN, $HASH, $SIZE, EVP_sha256(), $ENGINE)
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: SHA256 hash function usage detected in codebase"
  - id: c-crypto-sha3
    message: SHA3 hash function usage detected
    severity: INFO
    languages:
      - c
    patterns:
      - pattern-either:
          - pattern: EVP_DigestInit_ex($CTX, EVP_sha3_224(), $ENGINE)
          - pattern: EVP_DigestInit_ex($CTX, EVP_sha3_256(), $ENGINE)
          - pattern: EVP_DigestInit_ex($CTX, EVP_sha3_384(), $ENGINE)
          - pattern: EVP_DigestInit_ex($CTX, EVP_sha3_512(), $ENGINE)
          - pattern: EVP_Digest($DATA, $LEN, $HASH, $SIZE, EVP_sha3_224(), $ENGINE)
          - pattern: EVP_Digest($DATA, $LEN, $HASH, $SIZE, EVP_sha3_256(), $ENGINE)
          - pattern: EVP_Digest($DATA, $LEN, $HASH, $SIZE, EVP_sha3_384(), $ENGINE)
          - pattern: EVP_Digest($DATA, $LEN, $HASH, $SIZE, EVP_sha3_512(), $ENGINE)
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: SHA3 hash function usage detected in codebase"
  - id: c-crypto-hardcoded-key
    message: Hardcoded cryptographic key detected
    severity: INFO
    languages:
      - c
    patterns:
      - patterns:
          - metavariable-regex:
              metavariable: $KEY
              regex: (?i).*(key|secret|password|passphrase|aes_key|des_key|rc4_key|iv|nonce|salt|encryption_key|decryption_key).*
          - pattern-either:
              - pattern: |
                  unsigned char $KEY[] = "$STRING";
              - pattern: |
                  char $KEY[] = "$STRING";
              - pattern: |
                  const unsigned char $KEY[] = "$STRING";
              - pattern: |
                  const char $KEY[] = "$STRING";
              - pattern: |
                  static unsigned char $KEY[] = "$STRING";
              - pattern: |
                  static char $KEY[] = "$STRING";
              - pattern: |
                  #define $KEY "$STRING"
              - pattern: |
                  unsigned char $KEY[$LEN] = {$BYTES};
              - pattern: |
                  const unsigned char $KEY[$LEN] = {$BYTES};
              - pattern: |
                  static unsigned char $KEY[$LEN] = {$BYTES};
    metadata:
      category: crypto
      cwe: CWE-798
      impact: "Inventory: Hardcoded cryptographic key detected in codebase"
  - id: c-crypto-iv-nonce
    message: Initialization vector or nonce configuration detected
    severity: INFO
    languages:
      - c
    patterns:
      - pattern-either:
          - pattern: EVP_CIPHER_CTX_ctrl($CTX, EVP_CTRL_GCM_SET_IVLEN, $IVLEN, $NULL)
          - pattern: EVP_CIPHER_CTX_ctrl($CTX, EVP_CTRL_CCM_SET_IVLEN, $IVLEN, $NULL)
          - pattern: EVP_CIPHER_CTX_ctrl($CTX, EVP_CTRL_GCM_GET_TAG, $TAGLEN, $TAG)
          - pattern: EVP_CIPHER_CTX_ctrl($CTX, EVP_CTRL_CCM_SET_TAG, $TAGLEN, $TAG)
          - pattern: RAND_bytes($IV, $IVLEN)
          - pattern: RAND_pseudo_bytes($IV, $IVLEN)
    metadata:
      category: crypto
      cwe: CWE-330
      impact: "Inventory: Initialization vector or nonce configuration detected in codebase"
  - id: c-crypto-md5
    message: MD5 hash function usage detected
    severity: INFO
    languages:
      - c
    patterns:
      - pattern-either:
          - pattern: MD5_Init($CTX)
          - pattern: MD5_Update($CTX, $DATA, $LEN)
          - pattern: MD5_Final($HASH, $CTX)
          - pattern: |
              MD5_CTX $CTX;
              MD5_Init(&$CTX);
              MD5_Update(&$CTX, $DATA, $LEN);
              MD5_Final($HASH, &$CTX);
          - pattern: EVP_DigestInit_ex($CTX, EVP_md5(), $ENGINE)
          - pattern: EVP_Digest($DATA, $LEN, $HASH, $SIZE, EVP_md5(), $ENGINE)
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: MD5 hash function usage detected in codebase"
  - id: c-crypto-certificate-validation
    message: TLS certificate validation configuration detected
    severity: INFO
    languages:
      - c
    patterns:
      - pattern-either:
          - pattern: SSL_CTX_set_verify($CTX, $MODE, $CALLBACK)
          - pattern: SSL_set_verify($SSL, $MODE, $CALLBACK)
          - pattern: SSL_CTX_set_verify_depth($CTX, $DEPTH)
          - pattern: SSL_CTX_set_cert_verify_callback($CTX, $CALLBACK, $ARG)
          - pattern: SSL_get_verify_result($SSL)
          - pattern: SSL_CTX_load_verify_locations($CTX, $CAFILE, $CAPATH)
          - pattern: SSL_CTX_set_default_verify_paths($CTX)
          - pattern: X509_STORE_CTX_get_error($CTX)
          - pattern: X509_verify_cert($CTX)
    metadata:
      category: crypto
      cwe: CWE-295
      impact: "Inventory: TLS certificate validation configuration detected in codebase"
  - id: c-crypto-cipher-des
    message: DES cipher usage detected
    severity: INFO
    languages:
      - c
    patterns:
      - pattern-either:
          - pattern: DES_set_key($KEY, $SCHEDULE)
          - pattern: DES_encrypt($DATA, $SCHEDULE, $ENCRYPT)
          - pattern: DES_decrypt($DATA, $SCHEDULE, $DECRYPT)
          - pattern: DES_ecb_encrypt($INPUT, $OUTPUT, $SCHEDULE, $ENCRYPT)
          - pattern: DES_cbc_encrypt($INPUT, $OUTPUT, $LENGTH, $SCHEDULE, $IV, $ENCRYPT)
          - pattern: EVP_CipherInit_ex($CTX, EVP_des_ecb(), $ENGINE, $KEY, $IV, $ENCRYPT)
          - pattern: EVP_CipherInit_ex($CTX, EVP_des_cbc(), $ENGINE, $KEY, $IV, $ENCRYPT)
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: DES cipher usage detected in codebase"
  - id: c-crypto-secure-memory
    message: Secure memory operations detected
    severity: INFO
    languages:
      - c
    patterns:
      - pattern-either:
          - pattern: OPENSSL_cleanse($PTR, $LEN)
          - pattern: CRYPTO_secure_malloc($NUM, $FILE, $LINE)
          - pattern: CRYPTO_secure_free($PTR, $FILE, $LINE)
          - pattern: OPENSSL_secure_malloc($NUM)
          - pattern: OPENSSL_secure_free($PTR)
          - pattern: OPENSSL_secure_clear_free($PTR, $SIZE)
          - pattern: CRYPTO_secure_allocated($PTR)
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: Secure memory operations detected in codebase"
  - id: c-crypto-md2
    message: MD2 hash function usage detected
    severity: INFO
    languages:
      - c
    patterns:
      - pattern-either:
          - pattern: MD2_Init($CTX)
          - pattern: MD2_Update($CTX, $DATA, $LEN)
          - pattern: MD2_Final($HASH, $CTX)
          - pattern: |
              MD2_CTX $CTX;
              MD2_Init(&$CTX);
              MD2_Update(&$CTX, $DATA, $LEN);
              MD2_Final($HASH, &$CTX);
          - pattern: EVP_DigestInit_ex($CTX, EVP_md2(), $ENGINE)
          - pattern: EVP_Digest($DATA, $LEN, $HASH, $SIZE, EVP_md2(), $ENGINE)
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: MD2 hash function usage detected in codebase"
  - id: c-crypto-windows-cng
    message: Windows CNG (Cryptography Next Generation) usage detected
    severity: INFO
    languages:
      - c
    patterns:
      - pattern-either:
          - pattern: BCryptOpenAlgorithmProvider($ALG_HANDLE, $ALG_ID, $IMPL, $FLAGS)
          - pattern: BCryptCloseAlgorithmProvider($ALG_HANDLE, $FLAGS)
          - pattern:
              BCryptGenerateSymmetricKey($ALG_HANDLE, $KEY_HANDLE, $KEY_OBJECT, $KEY_OBJECT_LEN,
              $SECRET, $SECRET_LEN, $FLAGS)
          - pattern: BCryptGenerateKeyPair($ALG_HANDLE, $KEY_HANDLE, $KEY_LENGTH, $FLAGS)
          - pattern: BCryptFinalizeKeyPair($KEY_HANDLE, $FLAGS)
          - pattern:
              BCryptImportKeyPair($ALG_HANDLE, $NULL, $BLOB_TYPE, $KEY_HANDLE, $KEY_BLOB,
              $KEY_BLOB_LEN, $FLAGS)
          - pattern:
              BCryptExportKey($KEY_HANDLE, $NULL, $BLOB_TYPE, $OUTPUT, $OUTPUT_LEN,
              $RESULT_LEN, $FLAGS)
          - pattern:
              BCryptEncrypt($KEY_HANDLE, $INPUT, $INPUT_LEN, $PADDING_INFO, $IV,
              $IV_LEN, $OUTPUT, $OUTPUT_LEN, $RESULT_LEN, $FLAGS)
          - pattern:
              BCryptDecrypt($KEY_HANDLE, $INPUT, $INPUT_LEN, $PADDING_INFO, $IV,
              $IV_LEN, $OUTPUT, $OUTPUT_LEN, $RESULT_LEN, $FLAGS)
          - pattern: BCryptGenRandom($PROV_HANDLE, $BUFFER, $BUFFER_LEN, $FLAGS)
          - pattern:
              BCryptCreateHash($ALG_HANDLE, $HASH_HANDLE, $HASH_OBJECT, $HASH_OBJECT_LEN,
              $SECRET, $SECRET_LEN, $FLAGS)
          - pattern: BCryptHashData($HASH_HANDLE, $INPUT, $INPUT_LEN, $FLAGS)
          - pattern: BCryptFinishHash($HASH_HANDLE, $OUTPUT, $OUTPUT_LEN, $FLAGS)
          - pattern: BCryptDestroyHash($HASH_HANDLE)
          - pattern: BCryptDestroyKey($KEY_HANDLE)
          - pattern:
              BCryptSignHash($KEY_HANDLE, $PADDING_INFO, $HASH, $HASH_LEN, $SIGNATURE,
              $SIGNATURE_LEN, $RESULT_LEN, $FLAGS)
          - pattern:
              BCryptVerifySignature($KEY_HANDLE, $PADDING_INFO, $HASH, $HASH_LEN,
              $SIGNATURE, $SIGNATURE_LEN, $FLAGS)
          - pattern:
              BCryptDeriveKey($SECRET_HANDLE, $PARAM_LIST, $DERIVED_KEY, $DERIVED_KEY_LEN,
              $RESULT_LEN, $FLAGS)
          - pattern:
              BCryptDeriveKeyPBKDF2($ALG_HANDLE, $PASSWORD, $PASSWORD_LEN, $SALT,
              $SALT_LEN, $ITERATIONS, $DERIVED_KEY, $DERIVED_KEY_LEN, $FLAGS)
    metadata:
      category: crypto
      cwe: CWE-327
      impact:
        "Inventory: Windows CNG (Cryptography Next Generation) usage detected
        in codebase"
  - id: c-crypto-digital-signatures
    message: Digital signature operations detected
    severity: INFO
    languages:
      - c
    patterns:
      - pattern-either:
          - pattern: EVP_SignInit_ex($CTX, $TYPE, $ENGINE)
          - pattern: EVP_SignUpdate($CTX, $DATA, $DATALEN)
          - pattern: EVP_SignFinal($CTX, $SIG, $SIGLEN, $PKEY)
          - pattern: EVP_VerifyInit_ex($CTX, $TYPE, $ENGINE)
          - pattern: EVP_VerifyUpdate($CTX, $DATA, $DATALEN)
          - pattern: EVP_VerifyFinal($CTX, $SIG, $SIGLEN, $PKEY)
          - pattern: EVP_DigestSignInit($CTX, $PKCTX, $TYPE, $ENGINE, $PKEY)
          - pattern: EVP_DigestSignUpdate($CTX, $DATA, $DATALEN)
          - pattern: EVP_DigestSignFinal($CTX, $SIG, $SIGLEN)
          - pattern: EVP_DigestVerifyInit($CTX, $PKCTX, $TYPE, $ENGINE, $PKEY)
          - pattern: EVP_DigestVerifyUpdate($CTX, $DATA, $DATALEN)
          - pattern: EVP_DigestVerifyFinal($CTX, $SIG, $SIGLEN)
          - pattern: RSA_sign($TYPE, $M, $MLEN, $SIGRET, $SIGLEN, $RSA)
          - pattern: RSA_verify($TYPE, $M, $MLEN, $SIGBUF, $SIGLEN, $RSA)
          - pattern: ECDSA_sign($TYPE, $DGST, $DGSTLEN, $SIG, $SIGLEN, $ECKEY)
          - pattern: ECDSA_verify($TYPE, $DGST, $DGSTLEN, $SIG, $SIGLEN, $ECKEY)
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: Digital signature operations detected in codebase"
  - id: c-crypto-sha512
    message: SHA512 hash function usage detected
    severity: INFO
    languages:
      - c
    patterns:
      - pattern-either:
          - pattern: SHA512_Init($CTX)
          - pattern: SHA512_Update($CTX, $DATA, $LEN)
          - pattern: SHA512_Final($HASH, $CTX)
          - pattern: |
              SHA512_CTX $CTX;
              SHA512_Init(&$CTX);
              SHA512_Update(&$CTX, $DATA, $LEN);
              SHA512_Final($HASH, &$CTX);
          - pattern: EVP_DigestInit_ex($CTX, EVP_sha512(), $ENGINE)
          - pattern: EVP_Digest($DATA, $LEN, $HASH, $SIZE, EVP_sha512(), $ENGINE)
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: SHA512 hash function usage detected in codebase"
  - id: c-crypto-password-hashing
    message: Password hashing function usage detected
    severity: INFO
    languages:
      - c
    patterns:
      - pattern-either:
          - pattern: crypt($KEY, $SALT)
          - pattern: crypt_r($KEY, $SALT, $DATA)
          - pattern: bcrypt_hashpw($PASS, $SALT, $HASH)
          - pattern: bcrypt_checkpw($PASS, $HASH)
          - patterns:
              - pattern:
                  argon2i_hash($T_COST, $M_COST, $PARALLELISM, $PWD, $PWD_LEN, $SALT,
                  $SALT_LEN, $HASH, $HASH_LEN)
              - metavariable-regex:
                  metavariable: $T_COST
                  regex: \d+
              - metavariable-regex:
                  metavariable: $M_COST
                  regex: \d+
          - patterns:
              - pattern:
                  argon2id_hash($T_COST, $M_COST, $PARALLELISM, $PWD, $PWD_LEN, $SALT,
                  $SALT_LEN, $HASH, $HASH_LEN)
              - metavariable-regex:
                  metavariable: $T_COST
                  regex: \d+
              - metavariable-regex:
                  metavariable: $M_COST
                  regex: \d+
          - patterns:
              - pattern:
                  argon2d_hash($T_COST, $M_COST, $PARALLELISM, $PWD, $PWD_LEN, $SALT,
                  $SALT_LEN, $HASH, $HASH_LEN)
              - metavariable-regex:
                  metavariable: $T_COST
                  regex: \d+
              - metavariable-regex:
                  metavariable: $M_COST
                  regex: \d+
          - pattern: argon2i_verify($HASH, $PWD, $PWD_LEN)
          - pattern: argon2id_verify($HASH, $PWD, $PWD_LEN)
          - pattern: argon2d_verify($HASH, $PWD, $PWD_LEN)
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: Password hashing function usage detected in codebase"
  - id: c-crypto-whirlpool
    message: Whirlpool hash function usage detected
    severity: INFO
    languages:
      - c
    patterns:
      - pattern-either:
          - pattern: EVP_DigestInit_ex($CTX, EVP_whirlpool(), $ENGINE)
          - pattern: EVP_Digest($DATA, $LEN, $HASH, $SIZE, EVP_whirlpool(), $ENGINE)
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: Whirlpool hash function usage detected in codebase"
  - id: c-crypto-ecdsa
    message: ECDSA cryptographic operations detected
    severity: INFO
    languages:
      - c
    patterns:
      - pattern-either:
          - pattern: EC_KEY_new()
          - pattern: EC_KEY_new_by_curve_name($NID)
          - pattern: EC_KEY_generate_key($KEY)
          - pattern: ECDSA_sign($TYPE, $DGST, $DGSTLEN, $SIG, $SIGLEN, $ECKEY)
          - pattern: ECDSA_verify($TYPE, $DGST, $DGSTLEN, $SIG, $SIGLEN, $ECKEY)
          - pattern: ECDSA_do_sign($DGST, $DGSTLEN, $ECKEY)
          - pattern: ECDSA_do_verify($DGST, $DGSTLEN, $SIG, $ECKEY)
          - pattern: EVP_PKEY_new_EC_KEY($ECKEY)
          - pattern: EVP_PKEY_assign_EC_KEY($PKEY, $ECKEY)
          - pattern: EVP_PKEY_CTX_new_id(EVP_PKEY_EC, $ENGINE)
          - pattern: EVP_PKEY_CTX_new_id(EVP_PKEY_ECDSA, $ENGINE)
          - pattern: EVP_DigestSignInit($CTX, $PKCTX, $TYPE, $ENGINE, $PKEY)
          - pattern: EVP_DigestVerifyInit($CTX, $PKCTX, $TYPE, $ENGINE, $PKEY)
          - pattern: EC_GROUP_new_by_curve_name($NID)
          - pattern: EC_GROUP_get_curve_name($GROUP)
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: ECDSA cryptographic operations detected in codebase"
  - id: c-crypto-tls-cipher-suites
    message: TLS cipher suite configuration detected
    severity: INFO
    languages:
      - c
    patterns:
      - pattern-either:
          - pattern: SSL_CTX_set_cipher_list($CTX, $LIST)
          - pattern: SSL_set_cipher_list($SSL, $LIST)
          - pattern: SSL_CTX_set_ciphersuites($CTX, $LIST)
          - pattern: SSL_set_ciphersuites($SSL, $LIST)
          - pattern: SSL_CTX_get_ciphers($CTX)
          - pattern: SSL_get_cipher_list($SSL, $PRIORITY)
          - pattern: SSL_get_current_cipher($SSL)
          - pattern: SSL_CIPHER_get_name($CIPHER)
          - pattern: SSL_CIPHER_get_bits($CIPHER, $ALG_BITS)
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: TLS cipher suite configuration detected in codebase"
  - id: c-crypto-ripemd160
    message: RIPEMD-160 hash function usage detected
    severity: INFO
    languages:
      - c
    patterns:
      - pattern-either:
          - pattern: RIPEMD160_Init($CTX)
          - pattern: RIPEMD160_Update($CTX, $DATA, $LEN)
          - pattern: RIPEMD160_Final($HASH, $CTX)
          - pattern: |
              RIPEMD160_CTX $CTX;
              RIPEMD160_Init(&$CTX);
              RIPEMD160_Update(&$CTX, $DATA, $LEN);
              RIPEMD160_Final($HASH, &$CTX);
          - pattern: EVP_DigestInit_ex($CTX, EVP_ripemd160(), $ENGINE)
          - pattern: EVP_Digest($DATA, $LEN, $HASH, $SIZE, EVP_ripemd160(), $ENGINE)
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: RIPEMD-160 hash function usage detected in codebase"
  - id: c-crypto-openssl
    message: OpenSSL library initialization detected
    severity: INFO
    languages:
      - c
    patterns:
      - pattern-either:
          - pattern: SSL_library_init()
          - pattern: OPENSSL_init_crypto($OPTS, $SETTINGS)
          - pattern: OPENSSL_init_ssl($OPTS, $SETTINGS)
          - pattern: OpenSSL_add_all_algorithms()
          - pattern: OpenSSL_add_all_ciphers()
          - pattern: OpenSSL_add_all_digests()
          - pattern: EVP_add_cipher($CIPHER)
          - pattern: EVP_add_digest($DIGEST)
          - pattern: ENGINE_load_builtin_engines()
          - pattern: ENGINE_register_all_complete()
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: OpenSSL library initialization detected in codebase"
  - id: c-crypto-ecdh
    message: ECDH key agreement detected
    severity: INFO
    languages:
      - c
    patterns:
      - pattern-either:
          - pattern: ECDH_compute_key($OUT, $OUTLEN, $PUBKEY, $ECKEY)
          - pattern: EVP_PKEY_CTX_new_id(EVP_PKEY_EC, $ENGINE)
          - pattern: EVP_PKEY_CTX_new_id(EVP_PKEY_X25519, $ENGINE)
          - pattern: EVP_PKEY_CTX_new_id(EVP_PKEY_X448, $ENGINE)
          - pattern: EVP_PKEY_derive($CTX, $KEY, $KEYLEN)
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: ECDH key agreement detected in codebase"
  - id: c-crypto-rsa
    message: RSA cryptographic operations detected
    severity: INFO
    languages:
      - c
    patterns:
      - pattern-either:
          - patterns:
              - pattern: RSA_generate_key_ex($RSA, $BITS, $E, $BN)
              - metavariable-regex:
                  metavariable: $BITS
                  regex: \d+
              - focus-metavariable: $BITS
          - patterns:
              - pattern: RSA_generate_key($BITS, $E, $CALLBACK, $CALLBACKARG)
              - metavariable-regex:
                  metavariable: $BITS
                  regex: \d+
              - focus-metavariable: $BITS
          - pattern: RSA_new()
          - pattern: RSA_public_encrypt($FLEN, $FROM, $TO, $RSA, $PADDING)
          - pattern: RSA_private_decrypt($FLEN, $FROM, $TO, $RSA, $PADDING)
          - pattern: RSA_private_encrypt($FLEN, $FROM, $TO, $RSA, $PADDING)
          - pattern: RSA_public_decrypt($FLEN, $FROM, $TO, $RSA, $PADDING)
          - pattern: RSA_sign($TYPE, $M, $MLEN, $SIGRET, $SIGLEN, $RSA)
          - pattern: RSA_verify($TYPE, $M, $MLEN, $SIGBUF, $SIGLEN, $RSA)
          - pattern: EVP_PKEY_new_RSA($RSA)
          - pattern: EVP_PKEY_assign_RSA($PKEY, $RSA)
          - pattern: EVP_SignInit_ex($CTX, $TYPE, $ENGINE)
          - pattern: EVP_VerifyInit_ex($CTX, $TYPE, $ENGINE)
          - pattern: EVP_PKEY_CTX_new_id(EVP_PKEY_RSA, $ENGINE)
          - pattern: EVP_PKEY_keygen_init($CTX)
          - pattern: EVP_PKEY_keygen($CTX, $PKEY)
          - pattern: RSA_size($RSA)
          - pattern: RSA_get0_key($RSA, $N, $E, $D)
          - pattern: RSA_set0_key($RSA, $N, $E, $D)
          - pattern: RSA_check_key($RSA)
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: RSA cryptographic operations detected in codebase"
  - id: c-crypto-hmac
    message: HMAC usage detected
    severity: INFO
    languages:
      - c
    patterns:
      - pattern-either:
          - pattern: HMAC($EVPTYPE, $KEY, $KEYLEN, $DATA, $DATALEN, $HASH, $HASHLEN)
          - pattern: HMAC_Init_ex($CTX, $KEY, $KEYLEN, $EVPTYPE, $ENGINE)
          - pattern: HMAC_Update($CTX, $DATA, $DATALEN)
          - pattern: HMAC_Final($CTX, $HASH, $HASHLEN)
          - pattern: |
              HMAC_CTX *$CTX;
              HMAC_Init_ex($CTX, $KEY, $KEYLEN, $EVPTYPE, $ENGINE);
              HMAC_Update($CTX, $DATA, $DATALEN);
              HMAC_Final($CTX, $HASH, $HASHLEN);
          - pattern: EVP_DigestSignInit($CTX, $PKCTX, $EVPTYPE, $ENGINE, $KEY)
          - pattern: EVP_DigestVerifyInit($CTX, $PKCTX, $EVPTYPE, $ENGINE, $KEY)
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: HMAC usage detected in codebase"
  - id: c-crypto-cipher-rc4
    message: RC4 cipher usage detected
    severity: INFO
    languages:
      - c
    patterns:
      - pattern-either:
          - pattern: RC4_set_key($KEY, $LEN, $DATA)
          - pattern: RC4($KEY, $LEN, $INPUT, $OUTPUT)
          - pattern: EVP_CipherInit_ex($CTX, EVP_rc4(), $ENGINE, $KEY, $IV, $ENCRYPT)
          - pattern: EVP_CipherInit_ex($CTX, EVP_rc4_40(), $ENGINE, $KEY, $IV, $ENCRYPT)
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: RC4 cipher usage detected in codebase"
  - id: c-crypto-cipher-3des
    message: 3DES cipher usage detected
    severity: INFO
    languages:
      - c
    patterns:
      - pattern-either:
          - pattern: DES_set_key_checked($KEY, $SCHEDULE)
          - pattern: DES_set_key_unchecked($KEY, $SCHEDULE)
          - pattern: DES_ede3_set_key($KEY, $SCHEDULE)
          - pattern:
              DES_ede3_cbc_encrypt($INPUT, $OUTPUT, $LENGTH, $KS1, $KS2, $KS3, $IV,
              $ENCRYPT)
          - pattern: EVP_CipherInit_ex($CTX, EVP_des_ede3(), $ENGINE, $KEY, $IV, $ENCRYPT)
          - pattern: EVP_CipherInit_ex($CTX, EVP_des_ede3_cbc(), $ENGINE, $KEY, $IV, $ENCRYPT)
          - pattern: EVP_CipherInit_ex($CTX, EVP_des_ede3_ecb(), $ENGINE, $KEY, $IV, $ENCRYPT)
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: 3DES cipher usage detected in codebase"
  - id: c-crypto-windows-cryptoapi
    message: Windows CryptoAPI usage detected
    severity: INFO
    languages:
      - c
    patterns:
      - pattern-either:
          - pattern: CryptAcquireContext($HPROV, $CONTAINER, $PROVIDER, $PROVTYPE, $FLAGS)
          - pattern: CryptReleaseContext($HPROV, $FLAGS)
          - pattern: CryptGenKey($HPROV, $ALGID, $FLAGS, $HPROVKEY)
          - pattern: CryptDeriveKey($HPROV, $ALGID, $HHASH, $FLAGS, $HPROVKEY)
          - pattern: CryptImportKey($HPROV, $PBDATA, $DWDLEN, $HPROVKEY, $DWFLAGS, $HPROVKEYOUT)
          - pattern:
              CryptExportKey($HPROVKEY, $HPROVKEYEXP, $DWFLAGS, $DWPARAM, $PBDATA,
              $PDWLEN)
          - pattern:
              CryptEncrypt($HPROVKEY, $HHASH, $FINAL, $DWFLAGS, $PBDATA, $PDWLEN,
              $DWBUFLEN)
          - pattern: CryptDecrypt($HPROVKEY, $HHASH, $FINAL, $DWFLAGS, $PBDATA, $PDWLEN)
          - pattern: CryptCreateHash($HPROV, $ALGID, $HPROVKEY, $DWFLAGS, $HPROVHASH)
          - pattern: CryptHashData($HPROVHASH, $PBDATA, $DWDLEN, $DWFLAGS)
          - pattern: CryptHashSessionKey($HPROVHASH, $HPROVKEY, $DWFLAGS)
          - pattern: CryptGetHashParam($HPROVHASH, $DWPARAM, $PBDATA, $PDWLEN, $DWFLAGS)
          - pattern:
              CryptSignHash($HPROVHASH, $DWKEYSPEC, $DESCRIPTION, $DWFLAGS, $PBSIGNATURE,
              $PDSIGLEN)
          - pattern:
              CryptVerifySignature($HPROVHASH, $PBSIGNATURE, $DWSIGLEN, $HPROVKEY,
              $DESCRIPTION, $DWFLAGS)
          - pattern: CryptGenRandom($HPROV, $DWDLEN, $PBBUFFER)
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: Windows CryptoAPI usage detected in codebase"
  - id: c-crypto-tls-version
    message: TLS/SSL version configuration detected
    severity: INFO
    languages:
      - c
    patterns:
      - pattern-either:
          - patterns:
              - pattern: SSL_CTX_set_min_proto_version($CTX, $VERSION)
              - metavariable-regex:
                  metavariable: $VERSION
                  regex: (TLS1_[0-3]_VERSION|SSL3_VERSION|SSL2_VERSION|DTLS1_VERSION|DTLS1_2_VERSION)
              - focus-metavariable: $VERSION
          - patterns:
              - pattern: SSL_CTX_set_max_proto_version($CTX, $VERSION)
              - metavariable-regex:
                  metavariable: $VERSION
                  regex: (TLS1_[0-3]_VERSION|SSL3_VERSION|SSL2_VERSION|DTLS1_VERSION|DTLS1_2_VERSION)
              - focus-metavariable: $VERSION
          - patterns:
              - pattern: SSL_set_min_proto_version($SSL, $VERSION)
              - metavariable-regex:
                  metavariable: $VERSION
                  regex: (TLS1_[0-3]_VERSION|SSL3_VERSION|SSL2_VERSION|DTLS1_VERSION|DTLS1_2_VERSION)
              - focus-metavariable: $VERSION
          - patterns:
              - pattern: SSL_set_max_proto_version($SSL, $VERSION)
              - metavariable-regex:
                  metavariable: $VERSION
                  regex: (TLS1_[0-3]_VERSION|SSL3_VERSION|SSL2_VERSION|DTLS1_VERSION|DTLS1_2_VERSION)
              - focus-metavariable: $VERSION
          - pattern: SSL_CTX_new(SSLv2_method())
          - pattern: SSL_CTX_new(SSLv3_method())
          - pattern: SSL_CTX_new(TLSv1_method())
          - pattern: SSL_CTX_new(TLSv1_1_method())
          - pattern: SSL_CTX_new(TLSv1_2_method())
          - pattern: SSL_CTX_new(TLSv1_3_method())
          - pattern: SSL_CTX_new(SSLv23_method())
          - pattern: SSL_CTX_new(DTLSv1_method())
          - pattern: SSL_CTX_new(DTLSv1_2_method())
          - pattern: SSL_CTX_set_options($CTX, SSL_OP_NO_SSLv2)
          - pattern: SSL_CTX_set_options($CTX, SSL_OP_NO_SSLv3)
          - pattern: SSL_CTX_set_options($CTX, SSL_OP_NO_TLSv1)
          - pattern: SSL_CTX_set_options($CTX, SSL_OP_NO_TLSv1_1)
          - pattern: SSL_CTX_set_options($CTX, SSL_OP_NO_TLSv1_2)
          - pattern: SSL_CTX_set_options($CTX, SSL_OP_NO_TLSv1_3)
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: TLS/SSL version configuration detected in codebase"
  - id: javascript-crypto-pbkdf2
    message: PBKDF2 key derivation function usage detected
    severity: INFO
    languages:
      - javascript
    focus-metavariable: $PASSWORD
    patterns:
      - pattern-either:
          - pattern: crypto.pbkdf2($PASSWORD, $SALT, $ITER, $KEYLEN, $DIGEST, $CALLBACK)
          - pattern: crypto.pbkdf2Sync($PASSWORD, $SALT, $ITER, $KEYLEN, $DIGEST)
          - pattern: |
              crypto.pbkdf2($PASSWORD, $SALT, $ITER, $KEYLEN, "sha256", function($ERR, $KEY) {
                ...
              });
          - pattern: |
              $KEY = crypto.pbkdf2Sync($PASSWORD, $SALT, $ITER, $KEYLEN, "sha256");
          - patterns:
              - pattern: crypto.pbkdf2Sync($PASSWORD, $SALT, $ITER, $KEYLEN, $DIGEST)
              - metavariable-regex:
                  metavariable: $ITER
                  regex: \d+
              - metavariable-regex:
                  metavariable: $KEYLEN
                  regex: \d+
          - patterns:
              - pattern: crypto.pbkdf2Sync($PASSWORD, $SALT, $ITER, $KEYLEN, $DIGEST)
              - metavariable-comparison:
                  metavariable: $ITER
                  comparison: $ITER < 100000
          - patterns:
              - pattern: |
                  crypto.subtle.deriveKey({ name: "PBKDF2", salt: $SALT, iterations: $ITER, hash: "SHA-256" }, $BASE_KEY, $DERIVED_ALGO, $EXTRACTABLE, $USAGE)
              - metavariable-comparison:
                  metavariable: $ITER
                  comparison: $ITER < 100000
    pattern-not-inside:
      - pattern: |
          describe($NAME, function() {
            ...
          })
      - pattern: |
          describe($NAME, () => {
            ...
          })
      - pattern: |
          it($NAME, function() {
            ...
          })
      - pattern: |
          it($NAME, () => {
            ...
          })
      - pattern: |
          test($NAME, function() {
            ...
          })
      - pattern: |
          test($NAME, () => {
            ...
          })
      - pattern: |
          // $COMMENT
      - pattern: |
          /* $COMMENT */
    metadata:
      category: crypto
      cwe: CWE-326
      impact: "Inventory: PBKDF2 key derivation function usage detected in codebase"
  - id: javascript-crypto-argon2
    message: Argon2 key derivation function usage detected
    severity: INFO
    languages:
      - javascript
    focus-metavariable: $PASSWORD
    patterns:
      - pattern-either:
          - pattern: require("argon2").hash($PASSWORD, $OPTIONS)
          - pattern: require("argon2").verify($HASH, $PASSWORD)
          - pattern: require("argon2").hashSync($PASSWORD, $OPTIONS)
          - pattern: require("argon2").verifySync($HASH, $PASSWORD)
          - pattern: require("argon2-browser").hash($PASSWORD, $OPTIONS)
          - pattern: require("argon2-browser").verify($HASH, $PASSWORD)
          - pattern: require("argon2-wasm").hash($PASSWORD, $OPTIONS)
          - pattern: require("argon2-wasm").verify($HASH, $PASSWORD)
          - pattern: |
              $HASH = await argon2.hash($PASSWORD, $OPTIONS)
          - pattern: |
              $HASH = await argon2.hash($PASSWORD, {
                type: argon2.argon2i,
                ...
              })
          - pattern: |
              $HASH = await argon2.hash($PASSWORD, {
                type: argon2.argon2d,
                ...
              })
          - pattern: |
              $HASH = await argon2.hash($PASSWORD, {
                type: argon2.argon2id,
                ...
              })
          - pattern: |
              $HASH = await argon2.hash($PASSWORD, {
                type: argon2.argon2i,
                memoryCost: $MEMORY,
                timeCost: $TIME,
                parallelism: $PARALLELISM
              })
          - pattern: |
              $HASH = await argon2.hash($PASSWORD, {
                type: argon2.argon2d,
                memoryCost: $MEMORY,
                timeCost: $TIME,
                parallelism: $PARALLELISM
              })
          - pattern: |
              $HASH = await argon2.hash($PASSWORD, {
                type: argon2.argon2id,
                memoryCost: $MEMORY,
                timeCost: $TIME,
                parallelism: $PARALLELISM
              })
          - patterns:
              - pattern: |
                  $HASH = await argon2.hash($PASSWORD, {
                    type: argon2.argon2i,
                    memoryCost: $MEMORY,
                    timeCost: $TIME,
                    parallelism: $PARALLELISM
                  })
              - metavariable-comparison:
                  metavariable: $MEMORY
                  comparison: $MEMORY < 65536
          - patterns:
              - pattern: |
                  $HASH = await argon2.hash($PASSWORD, {
                    type: argon2.argon2i,
                    memoryCost: $MEMORY,
                    timeCost: $TIME,
                    parallelism: $PARALLELISM
                  })
              - metavariable-comparison:
                  metavariable: $TIME
                  comparison: $TIME < 3
          - patterns:
              - pattern: |
                  $HASH = await argon2.hash($PASSWORD, {
                    type: argon2.argon2d,
                    memoryCost: $MEMORY,
                    timeCost: $TIME,
                    parallelism: $PARALLELISM
                  })
              - metavariable-comparison:
                  metavariable: $MEMORY
                  comparison: $MEMORY < 65536
          - patterns:
              - pattern: |
                  $HASH = await argon2.hash($PASSWORD, {
                    type: argon2.argon2d,
                    memoryCost: $MEMORY,
                    timeCost: $TIME,
                    parallelism: $PARALLELISM
                  })
              - metavariable-comparison:
                  metavariable: $TIME
                  comparison: $TIME < 3
          - patterns:
              - pattern: |
                  $HASH = await argon2.hash($PASSWORD, {
                    type: argon2.argon2id,
                    memoryCost: $MEMORY,
                    timeCost: $TIME,
                    parallelism: $PARALLELISM
                  })
              - metavariable-comparison:
                  metavariable: $MEMORY
                  comparison: $MEMORY < 65536
          - patterns:
              - pattern: |
                  $HASH = await argon2.hash($PASSWORD, {
                    type: argon2.argon2id,
                    memoryCost: $MEMORY,
                    timeCost: $TIME,
                    parallelism: $PARALLELISM
                  })
              - metavariable-comparison:
                  metavariable: $TIME
                  comparison: $TIME < 3
          - pattern: |
              $HASH = await argon2Browser.hash($PASSWORD, $OPTIONS)
          - pattern: |
              $HASH = await argon2Wasm.hash($PASSWORD, $OPTIONS)
    pattern-not-inside:
      - pattern: |
          describe($NAME, function() {
            ...
          })
      - pattern: |
          describe($NAME, () => {
            ...
          })
      - pattern: |
          it($NAME, function() {
            ...
          })
      - pattern: |
          it($NAME, () => {
            ...
          })
      - pattern: |
          test($NAME, function() {
            ...
          })
      - pattern: |
          test($NAME, () => {
            ...
          })
      - pattern: |
          // $COMMENT
      - pattern: |
          /* $COMMENT */
    metadata:
      category: crypto
      cwe: CWE-326
      impact: "Inventory: Argon2 key derivation function usage detected in codebase"
  - id: javascript-crypto-static-iv-nonce
    message: Static IV or nonce value usage detected
    severity: INFO
    languages:
      - javascript
    patterns:
      - pattern-either:
          - pattern: |
              const IV = Buffer.from("$STATIC_VALUE");
              ...
              crypto.createCipheriv("aes-256-cbc", $KEY, IV);
          - pattern: |
              const IV = Buffer.from("$STATIC_VALUE");
              ...
              crypto.createCipheriv("aes-256-gcm", $KEY, IV);
          - pattern: |
              const NONCE = Buffer.from("$STATIC_VALUE");
              ...
              crypto.createCipheriv("aes-256-gcm", $KEY, NONCE);
          - pattern: crypto.createCipheriv("aes-256-cbc", $KEY, Buffer.from("$STATIC_IV"))
          - pattern: crypto.createCipheriv("aes-256-gcm", $KEY, Buffer.from("$STATIC_NONCE"))
          - pattern: |
              const IV = new Uint8Array([$STATIC_VALUES]);
              ...
              crypto.subtle.encrypt({ name: "AES-CBC", iv: IV }, $KEY, $DATA);
          - pattern: |
              const NONCE = new Uint8Array([$STATIC_VALUES]);
              ...
              crypto.subtle.encrypt({ name: "AES-GCM", iv: NONCE }, $KEY, $DATA);
          - pattern: |
              const IV = Buffer.from("$STATIC_VALUE", "hex");
              ...
              crypto.createCipheriv("aes-256-cbc", $KEY, IV);
          - pattern: |
              const IV = Buffer.from("$STATIC_VALUE", "base64");
              ...
              crypto.createCipheriv("aes-256-cbc", $KEY, IV)
          - pattern: |
              const STATIC_IV = "$VALUE";
              ...
              crypto.createCipheriv("aes-256-cbc", $KEY, Buffer.from(STATIC_IV))
          - pattern: |
              const STATIC_NONCE = "$VALUE";
              ...
              crypto.createCipheriv("aes-256-gcm", $KEY, Buffer.from(STATIC_NONCE))
          - pattern: |
              const STATIC_IV = "$VALUE";
              ...
              crypto.subtle.encrypt({ name: "AES-CBC", iv: Buffer.from(STATIC_IV) }, $KEY, $DATA)
          - patterns:
              - pattern: |
                  const IV = Buffer.from("$STATIC_VALUE");
                  ...
                  crypto.createCipheriv("aes-256-cbc", $KEY, IV);
              - metavariable-regex:
                  metavariable: $STATIC_VALUE
                  regex: ^(?!.*randomBytes|.*getRandomValues|.*random).*$
          - patterns:
              - pattern: |
                  const IV = Buffer.from("$STATIC_VALUE");
                  ...
                  crypto.createCipheriv("aes-256-gcm", $KEY, IV);
              - metavariable-regex:
                  metavariable: $STATIC_VALUE
                  regex: ^(?!.*randomBytes|.*getRandomValues|.*random).*$
    pattern-not-inside:
      - pattern: |
          describe($NAME, function() {
            ...
          })
      - pattern: |
          describe($NAME, () => {
            ...
          })
      - pattern: |
          it($NAME, function() {
            ...
          })
      - pattern: |
          it($NAME, () => {
            ...
          })
      - pattern: |
          test($NAME, function() {
            ...
          })
      - pattern: |
          test($NAME, () => {
            ...
          })
      - pattern: |
          // $COMMENT
      - pattern: |
          /* $COMMENT */
    metadata:
      category: crypto
      cwe: CWE-329
      impact: "Inventory: Static IV or nonce value usage detected in codebase"
  - id: javascript-crypto-iv-nonce
    message: IV or nonce generation for cryptographic use detected
    severity: INFO
    languages:
      - javascript
    patterns:
      - pattern-either:
          - pattern: crypto.randomBytes($LENGTH)
          - pattern: crypto.getRandomValues($ARRAY)
          - pattern: |
              $IV = crypto.randomBytes(16);
              ...
              crypto.createCipheriv("aes-256-cbc", $KEY, $IV);
          - pattern: |
              $NONCE = crypto.randomBytes(12);
              ...
              crypto.createCipheriv("aes-256-gcm", $KEY, $NONCE);
          - pattern: |
              $IV = crypto.getRandomValues(new Uint8Array(16));
              ...
              crypto.subtle.encrypt({ name: "AES-CBC", iv: $IV }, $KEY, $DATA);
          - pattern: |
              $NONCE = crypto.getRandomValues(new Uint8Array(12));
              ...
              crypto.subtle.encrypt({ name: "AES-GCM", iv: $NONCE }, $KEY, $DATA);
    pattern-not-inside:
      - pattern: |
          describe($NAME, function() {
            ...
          })
      - pattern: |
          describe($NAME, () => {
            ...
          })
      - pattern: |
          it($NAME, function() {
            ...
          })
      - pattern: |
          it($NAME, () => {
            ...
          })
      - pattern: |
          test($NAME, function() {
            ...
          })
      - pattern: |
          test($NAME, () => {
            ...
          })
      - pattern: |
          // $COMMENT
      - pattern: |
          /* $COMMENT */
    metadata:
      category: crypto
      cwe: CWE-330
      impact: "Inventory: IV or nonce generation for cryptographic use detected in codebase"
  - id: javascript-crypto-tls-cipher-suites
    message: TLS cipher suite configuration detected
    severity: INFO
    languages:
      - javascript
    patterns:
      - pattern-either:
          - pattern: |
              $OPTIONS = {
                ciphers: "$CIPHER_SUITE",
                ...
              };
          - pattern: |
              $OPTIONS = {
                ciphers: "$CIPHER_LIST",
                ...
              };
          - pattern: |
              $OPTIONS = {
                honorCipherOrder: true,
                ciphers: "$CIPHER_SUITE",
                ...
              };
          - pattern: |
              $OPTIONS = {
                secureOptions: $FLAGS,
                ciphers: "$CIPHER_SUITE",
                ...
              };
          - pattern: |
              https.createServer({
                ciphers: "$CIPHER_SUITE",
                ...
              }, $HANDLER)
          - pattern: |
              tls.createServer({
                ciphers: "$CIPHER_SUITE",
                ...
              })
          - pattern: |
              tls.connect($PORT, $HOST, {
                ciphers: "$CIPHER_SUITE",
                ...
              })
          - pattern: |
              tls.connect({
                ciphers: "$CIPHER_SUITE",
                ...
              })
    pattern-not-inside:
      - pattern: |
          describe($NAME, function() {
            ...
          })
      - pattern: |
          describe($NAME, () => {
            ...
          })
      - pattern: |
          it($NAME, function() {
            ...
          })
      - pattern: |
          it($NAME, () => {
            ...
          })
      - pattern: |
          test($NAME, function() {
            ...
          })
      - pattern: |
          test($NAME, () => {
            ...
          })
      - pattern: |
          // $COMMENT
      - pattern: |
          /* $COMMENT */
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: TLS cipher suite configuration detected in codebase"
  - id: javascript-crypto-certificate-validation
    message: Certificate validation configuration detected
    severity: INFO
    languages:
      - javascript
    patterns:
      - pattern-either:
          - pattern: |
              $OPTIONS = {
                rejectUnauthorized: true,
                ...
              };
          - pattern: |
              $OPTIONS = {
                rejectUnauthorized: false,
                ...
              };
          - pattern: |
              $OPTIONS = {
                ca: $CA_CERT,
                ...
              };
          - pattern: |
              $OPTIONS = {
                cert: $CERT,
                key: $KEY,
                ...
              };
          - pattern: |
              $OPTIONS = {
                checkServerIdentity: function($HOSTNAME, $CERT) {
                  ...
                },
                ...
              };
          - pattern: |
              $AGENT = new https.Agent({
                rejectUnauthorized: $VALUE,
                ...
              });
          - pattern: |
              $AGENT = new https.Agent({
                ca: $CA_CERT,
                ...
              });
    pattern-not-inside:
      - pattern: |
          describe($NAME, function() {
            ...
          })
      - pattern: |
          describe($NAME, () => {
            ...
          })
      - pattern: |
          it($NAME, function() {
            ...
          })
      - pattern: |
          it($NAME, () => {
            ...
          })
      - pattern: |
          test($NAME, function() {
            ...
          })
      - pattern: |
          test($NAME, () => {
            ...
          })
      - pattern: |
          // $COMMENT
      - pattern: |
          /* $COMMENT */
    metadata:
      category: crypto
      cwe: CWE-295
      impact: "Inventory: Certificate validation configuration detected in codebase"
  - id: javascript-crypto-cipher-rc4
    message: RC4 stream cipher usage detected
    severity: INFO
    languages:
      - javascript
    patterns:
      - pattern-either:
          - pattern: crypto.createCipher("rc4", $KEY)
          - pattern: crypto.createCipher("rc4-40", $KEY)
          - pattern: crypto.createCipher("rc4-hmac-md5", $KEY)
          - pattern: crypto.createDecipher("rc4", $KEY)
          - pattern: crypto.createDecipher("rc4-40", $KEY)
          - pattern: crypto.createDecipher("rc4-hmac-md5", $KEY)
          - pattern: require("crypto-js").RC4.encrypt($DATA, $KEY)
          - pattern: CryptoJS.RC4.encrypt($DATA, $KEY)
    pattern-not-inside:
      - pattern: |
          describe($NAME, function() {
            ...
          })
      - pattern: |
          describe($NAME, () => {
            ...
          })
      - pattern: |
          it($NAME, function() {
            ...
          })
      - pattern: |
          it($NAME, () => {
            ...
          })
      - pattern: |
          test($NAME, function() {
            ...
          })
      - pattern: |
          test($NAME, () => {
            ...
          })
      - pattern: |
          // $COMMENT
      - pattern: |
          /* $COMMENT */
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: RC4 stream cipher usage detected in codebase"
  - id: javascript-crypto-sha3
    message: SHA3 hash function usage detected
    severity: INFO
    languages:
      - javascript
    focus-metavariable: $DATA
    patterns:
      - pattern-either:
          - pattern: crypto.createHash("sha3-224")
          - pattern: crypto.createHash("sha3-256")
          - pattern: crypto.createHash("sha3-384")
          - pattern: crypto.createHash("sha3-512")
          - pattern: crypto.createHash("shake128")
          - pattern: crypto.createHash("shake256")
          - pattern: crypto.createHash('sha3-224')
          - pattern: crypto.createHash('sha3-256')
          - pattern: crypto.createHash('sha3-384')
          - pattern: crypto.createHash('sha3-512')
          - pattern: crypto.createHash('shake128')
          - pattern: crypto.createHash('shake256')
          - pattern: |
              $HASHER = crypto.createHash("sha3-256");
              $HASHER.update($DATA);
              $HASH = $HASHER.digest();
          - pattern: crypto.createHash("sha3-256").update($DATA).digest()
          - pattern: crypto.createHash("shake128").update($DATA).digest()
          - pattern: crypto.createHash("shake256").update($DATA).digest()
          - pattern: require("crypto-js").SHA3($DATA)
          - pattern: CryptoJS.SHA3($DATA)
          - pattern: require("@noble/hashes").sha3_224($DATA)
          - pattern: require("@noble/hashes").sha3_256($DATA)
          - pattern: require("@noble/hashes").sha3_384($DATA)
          - pattern: require("@noble/hashes").sha3_512($DATA)
          - pattern: require("@noble/hashes").shake128($DATA)
          - pattern: require("@noble/hashes").shake256($DATA)
          - pattern: |
              const { sha3_256 } = require("@noble/hashes");
              sha3_256($DATA)
          - pattern: |
              const { shake128 } = require("@noble/hashes");
              shake128($DATA)
    pattern-not-inside:
      - pattern: |
          describe($NAME, function() {
            ...
          })
      - pattern: |
          describe($NAME, () => {
            ...
          })
      - pattern: |
          it($NAME, function() {
            ...
          })
      - pattern: |
          it($NAME, () => {
            ...
          })
      - pattern: |
          test($NAME, function() {
            ...
          })
      - pattern: |
          test($NAME, () => {
            ...
          })
      - pattern: |
          // $COMMENT
      - pattern: |
          /* $COMMENT */
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: SHA3 hash function usage detected in codebase"
  - id: javascript-crypto-md5
    message: MD5 hash function usage detected
    severity: INFO
    languages:
      - javascript
    focus-metavariable: $DATA
    patterns:
      - pattern-either:
          - pattern: crypto.createHash("md5")
          - pattern: crypto.createHash('md5')
          - pattern: |
              $HASHER = crypto.createHash("md5");
              $HASHER.update($DATA);
              $HASH = $HASHER.digest();
          - pattern: crypto.createHash("md5").update($DATA).digest()
          - pattern: |
              $HASHER = crypto.createHash("md5");
              $HASHER.update($DATA);
              $HASH = $HASHER.digest("hex");
          - pattern: |
              $HASHER = crypto.createHash("md5");
              $HASHER.update($DATA);
              $HASH = $HASHER.digest("base64");
          - pattern: crypto.createHash("md5").update($DATA).digest("hex")
          - pattern: crypto.createHash("md5").update($DATA).digest("base64")
          - pattern: require("crypto-js").MD5($DATA)
          - pattern: CryptoJS.MD5($DATA)
          - pattern: |
              const crypto = await import('crypto');
              crypto.createHash("md5")
          - pattern: |
              const { createHash } = require('crypto');
              createHash("md5")
          - pattern: |
              const { createHash } = await import('crypto');
              createHash("md5")
          - patterns:
              - pattern: crypto.createHash($ALGO)
              - metavariable-regex:
                  metavariable: $ALGO
                  regex: '"(md5|MD5)"'
          - patterns:
              - pattern: |
                  $HASHER = crypto.createHash($ALGO);
                  $HASHER.update($DATA);
                  $HASH = $HASHER.digest();
              - metavariable-regex:
                  metavariable: $ALGO
                  regex: '"(md5|MD5)"'
    pattern-not-inside:
      - pattern: |
          describe($NAME, function() {
            ...
          })
      - pattern: |
          describe($NAME, () => {
            ...
          })
      - pattern: |
          it($NAME, function() {
            ...
          })
      - pattern: |
          it($NAME, () => {
            ...
          })
      - pattern: |
          test($NAME, function() {
            ...
          })
      - pattern: |
          test($NAME, () => {
            ...
          })
      - pattern: |
          // $COMMENT
      - pattern: |
          /* $COMMENT */
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: MD5 hash function usage detected in codebase"
  - id: javascript-crypto-tls-version
    message: TLS version configuration detected
    severity: INFO
    languages:
      - javascript
    patterns:
      - pattern-either:
          - pattern: |
              $OPTIONS = {
                secureProtocol: "TLSv1_method",
                ...
              };
          - pattern: |
              $OPTIONS = {
                secureProtocol: "TLSv1_1_method",
                ...
              };
          - pattern: |
              $OPTIONS = {
                secureProtocol: "TLSv1_2_method",
                ...
              };
          - pattern: |
              $OPTIONS = {
                minVersion: "TLSv1.2",
                maxVersion: "TLSv1.3",
                ...
              };
          - pattern: |
              $OPTIONS = {
                minVersion: "TLSv1",
                ...
              };
          - pattern: |
              $OPTIONS = {
                minVersion: "TLSv1.1",
                ...
              };
          - pattern: |
              $OPTIONS = {
                minVersion: "TLSv1.2",
                ...
              };
          - pattern: |
              $OPTIONS = {
                minVersion: "TLSv1.3",
                ...
              };
          - pattern: |
              $OPTIONS = {
                maxVersion: "TLSv1",
                ...
              };
          - pattern: |
              $OPTIONS = {
                maxVersion: "TLSv1.1",
                ...
              };
          - pattern: |
              $OPTIONS = {
                maxVersion: "TLSv1.2",
                ...
              };
          - pattern: |
              $OPTIONS = {
                maxVersion: "TLSv1.3",
                ...
              };
          - pattern: https.createServer($OPTIONS, $HANDLER)
          - pattern: tls.createServer($OPTIONS)
          - pattern: tls.connect($PORT, $HOST, $OPTIONS)
          - pattern: tls.connect($OPTIONS)
          - pattern: |
              https.createServer({
                secureProtocol: $PROTOCOL,
                ...
              }, $HANDLER)
          - pattern: |
              https.createServer({
                minVersion: $VERSION,
                ...
              }, $HANDLER)
          - pattern: |
              https.createServer({
                maxVersion: $VERSION,
                ...
              }, $HANDLER)
          - pattern: |
              tls.createServer({
                secureProtocol: $PROTOCOL,
                ...
              })
          - pattern: |
              tls.createServer({
                minVersion: $VERSION,
                ...
              })
          - pattern: |
              tls.createServer({
                maxVersion: $VERSION,
                ...
              })
          - pattern: |
              tls.connect($PORT, $HOST, {
                secureProtocol: $PROTOCOL,
                ...
              })
          - pattern: |
              tls.connect($PORT, $HOST, {
                minVersion: $VERSION,
                ...
              })
          - pattern: |
              tls.connect($PORT, $HOST, {
                maxVersion: $VERSION,
                ...
              })
    pattern-not-inside:
      - pattern: |
          describe($NAME, function() {
            ...
          })
      - pattern: |
          describe($NAME, () => {
            ...
          })
      - pattern: |
          it($NAME, function() {
            ...
          })
      - pattern: |
          it($NAME, () => {
            ...
          })
      - pattern: |
          test($NAME, function() {
            ...
          })
      - pattern: |
          test($NAME, () => {
            ...
          })
      - pattern: |
          // $COMMENT
      - pattern: |
          /* $COMMENT */
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: TLS version configuration detected in codebase"
  - id: javascript-crypto-sha512
    message: SHA512 hash function usage detected
    severity: INFO
    languages:
      - javascript
    focus-metavariable: $DATA
    patterns:
      - pattern-either:
          - pattern: crypto.createHash("sha512")
          - pattern: crypto.createHash('sha512')
          - pattern: crypto.createHash("sha384")
          - pattern: crypto.createHash('sha384')
          - pattern: |
              $HASHER = crypto.createHash("sha512");
              $HASHER.update($DATA);
              $HASH = $HASHER.digest();
          - pattern: |
              $HASHER = crypto.createHash("sha384");
              $HASHER.update($DATA);
              $HASH = $HASHER.digest();
          - pattern: crypto.createHash("sha512").update($DATA).digest()
          - pattern: crypto.createHash("sha384").update($DATA).digest()
          - pattern: |
              $HASHER = crypto.createHash("sha512");
              $HASHER.update($DATA);
              $HASH = $HASHER.digest("hex");
          - pattern: |
              $HASHER = crypto.createHash("sha512");
              $HASHER.update($DATA);
              $HASH = $HASHER.digest("base64");
          - pattern: crypto.createHash("sha512").update($DATA).digest("hex")
          - pattern: crypto.createHash("sha512").update($DATA).digest("base64")
          - pattern: require("crypto-js").SHA512($DATA)
          - pattern: require("crypto-js").SHA384($DATA)
          - pattern: CryptoJS.SHA512($DATA)
          - pattern: CryptoJS.SHA384($DATA)
    pattern-not-inside:
      - pattern: |
          describe($NAME, function() {
            ...
          })
      - pattern: |
          describe($NAME, () => {
            ...
          })
      - pattern: |
          it($NAME, function() {
            ...
          })
      - pattern: |
          it($NAME, () => {
            ...
          })
      - pattern: |
          test($NAME, function() {
            ...
          })
      - pattern: |
          test($NAME, () => {
            ...
          })
      - pattern: |
          // $COMMENT
      - pattern: |
          /* $COMMENT */
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: SHA512 hash function usage detected in codebase"
  - id: javascript-crypto-sha1
    message: SHA1 hash function usage detected
    severity: INFO
    languages:
      - javascript
    focus-metavariable: $DATA
    patterns:
      - pattern-either:
          - pattern: crypto.createHash("sha1")
          - pattern: crypto.createHash('sha1')
          - pattern: |
              $HASHER = crypto.createHash("sha1");
              $HASHER.update($DATA);
              $HASH = $HASHER.digest();
          - pattern: crypto.createHash("sha1").update($DATA).digest()
          - pattern: |
              $HASHER = crypto.createHash("sha1");
              $HASHER.update($DATA);
              $HASH = $HASHER.digest("hex");
          - pattern: |
              $HASHER = crypto.createHash("sha1");
              $HASHER.update($DATA);
              $HASH = $HASHER.digest("base64");
          - pattern: crypto.createHash("sha1").update($DATA).digest("hex")
          - pattern: crypto.createHash("sha1").update($DATA).digest("base64")
          - pattern: require("crypto-js").SHA1($DATA)
          - pattern: CryptoJS.SHA1($DATA)
    pattern-not-inside:
      - pattern: |
          describe($NAME, function() {
            ...
          })
      - pattern: |
          describe($NAME, () => {
            ...
          })
      - pattern: |
          it($NAME, function() {
            ...
          })
      - pattern: |
          it($NAME, () => {
            ...
          })
      - pattern: |
          test($NAME, function() {
            ...
          })
      - pattern: |
          test($NAME, () => {
            ...
          })
      - pattern: |
          // $COMMENT
      - pattern: |
          /* $COMMENT */
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: SHA1 hash function usage detected in codebase"
  - id: javascript-crypto-hardcoded-key
    message: Hardcoded cryptographic key detected
    severity: INFO
    languages:
      - javascript
    patterns:
      - pattern-either:
          - pattern: crypto.createCipheriv($ALGO, "$KEY", $IV)
          - pattern: crypto.createDecipheriv($ALGO, "$KEY", $IV)
          - pattern: crypto.createCipher($ALGO, "$KEY")
          - pattern: crypto.createDecipher($ALGO, "$KEY")
          - pattern: |
              const $KEY = "$VALUE";
              ...
              crypto.createCipheriv($ALGO, $KEY, $IV)
          - pattern: |
              const $KEY = "$VALUE";
              ...
              crypto.createDecipheriv($ALGO, $KEY, $IV)
          - pattern: |
              let $KEY = "$VALUE";
              ...
              crypto.createCipheriv($ALGO, $KEY, $IV)
          - pattern: |
              let $KEY = "$VALUE";
              ...
              crypto.createDecipheriv($ALGO, $KEY, $IV)
          - pattern: |
              var $KEY = "$VALUE";
              ...
              crypto.createCipheriv($ALGO, $KEY, $IV)
          - pattern: |
              var $KEY = "$VALUE";
              ...
              crypto.createDecipheriv($ALGO, $KEY, $IV)
          - pattern: |
              const $KEY = Buffer.from("$VALUE");
              ...
              crypto.createCipheriv($ALGO, $KEY, $IV)
          - pattern: |
              const $KEY = Buffer.from("$VALUE", "hex");
              ...
              crypto.createCipheriv($ALGO, $KEY, $IV)
          - pattern: |
              const $KEY = Buffer.from("$VALUE", "base64");
              ...
              crypto.createCipheriv($ALGO, $KEY, $IV)
          - pattern: |
              const $CONFIG = {
                key: "$VALUE",
                ...
              };
              ...
              crypto.createCipheriv($ALGO, $CONFIG.key, $IV)
          - pattern: |
              let $CONFIG = {
                key: "$VALUE",
                ...
              };
              ...
              crypto.createCipheriv($ALGO, $CONFIG.key, $IV)
          - pattern: |
              var $CONFIG = {
                key: "$VALUE",
                ...
              };
              ...
              crypto.createCipheriv($ALGO, $CONFIG.key, $IV)
          - pattern: crypto.createCipheriv($ALGO, Buffer.from("$KEY"), $IV)
          - pattern: crypto.createCipheriv($ALGO, Buffer.from("$KEY", "hex"), $IV)
          - pattern: crypto.createCipheriv($ALGO, Buffer.from("$KEY", "base64"), $IV)
          - pattern: crypto.subtle.encrypt($ALGO, Buffer.from("$KEY"), $DATA)
          - pattern: crypto.subtle.encrypt($ALGO, Buffer.from("$KEY", "hex"), $DATA)
          - pattern: crypto.subtle.encrypt($ALGO, Buffer.from("$KEY", "base64"), $DATA)
    pattern-not-inside:
      - pattern: |
          describe($NAME, function() {
            ...
          })
      - pattern: |
          describe($NAME, () => {
            ...
          })
      - pattern: |
          it($NAME, function() {
            ...
          })
      - pattern: |
          it($NAME, () => {
            ...
          })
      - pattern: |
          test($NAME, function() {
            ...
          })
      - pattern: |
          test($NAME, () => {
            ...
          })
      - pattern: |
          // $COMMENT
      - pattern: |
          /* $COMMENT */
    pattern-not:
      - pattern: |
          $KEY = process.env.$VAR
          ...
          crypto.createCipheriv($ALGO, $KEY, $IV)
      - pattern: |
          const $KEY = process.env.$VAR
          ...
          crypto.createCipheriv($ALGO, $KEY, $IV)
      - pattern: |
          $KEY = require($MODULE).$PROP
          ...
          crypto.createCipheriv($ALGO, $KEY, $IV)
      - pattern: |
          const $KEY = require($MODULE).$PROP
          ...
          crypto.createCipheriv($ALGO, $KEY, $IV)
      - pattern: |
          $KEY = $CONFIG.$PROP
          ...
          crypto.createCipheriv($ALGO, $KEY, $IV)
      - pattern: |
          const $KEY = $CONFIG.$PROP
          ...
          crypto.createCipheriv($ALGO, $KEY, $IV)
    metadata:
      category: crypto
      cwe: CWE-798
      impact: "Inventory: Hardcoded cryptographic key detected in codebase"
  - id: javascript-crypto-ecdsa
    message: ECDSA cryptographic operations detected
    severity: INFO
    languages:
      - javascript
    patterns:
      - pattern-either:
          - pattern: crypto.createSign("ecdsa-with-SHA256")
          - pattern: crypto.createSign("ecdsa-with-SHA512")
          - pattern: crypto.createVerify("ecdsa-with-SHA256")
          - pattern: crypto.createVerify("ecdsa-with-SHA512")
          - pattern: |
              $SIGN = crypto.createSign("ecdsa-with-SHA256");
              $SIGN.update($DATA);
              $SIGNATURE = $SIGN.sign($PRIVATE_KEY);
          - pattern: |
              $VERIFY = crypto.createVerify("ecdsa-with-SHA256");
              $VERIFY.update($DATA);
              $VERIFY.verify($PUBLIC_KEY, $SIGNATURE);
          - pattern: crypto.createECDH("prime256v1")
          - pattern: crypto.createECDH("secp256k1")
          - pattern: crypto.createECDH("secp384r1")
          - pattern: crypto.createECDH("secp521r1")
          - pattern: |
              $ECDH = crypto.createECDH("prime256v1");
              $ECDH.generateKeys();
              $SHARED = $ECDH.computeSecret($PUBLIC_KEY);
          - pattern: |
              crypto.subtle.generateKey({ name: "ECDSA", namedCurve: "P-256" }, $EXTRACTABLE, $USAGE)
          - pattern: |
              crypto.subtle.generateKey({ name: "ECDSA", namedCurve: "P-384" }, $EXTRACTABLE, $USAGE)
          - pattern: |
              crypto.subtle.generateKey({ name: "ECDSA", namedCurve: "P-521" }, $EXTRACTABLE, $USAGE)
          - pattern: |
              crypto.subtle.sign({ name: "ECDSA", hash: "SHA-256" }, $PRIVATE_KEY, $DATA)
          - pattern: |
              crypto.subtle.verify({ name: "ECDSA", hash: "SHA-256" }, $PUBLIC_KEY, $SIGNATURE, $DATA)
    pattern-not-inside:
      - pattern: |
          describe($NAME, function() {
            ...
          })
      - pattern: |
          describe($NAME, () => {
            ...
          })
      - pattern: |
          it($NAME, function() {
            ...
          })
      - pattern: |
          it($NAME, () => {
            ...
          })
      - pattern: |
          test($NAME, function() {
            ...
          })
      - pattern: |
          test($NAME, () => {
            ...
          })
      - pattern: |
          // $COMMENT
      - pattern: |
          /* $COMMENT */
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: ECDSA cryptographic operations detected in codebase"
  - id: javascript-crypto-key-length
    message: Cryptographic key length usage detected
    severity: INFO
    languages:
      - javascript
    patterns:
      - pattern-either:
          - patterns:
              - pattern: |
                  crypto.subtle.generateKey({ name: "RSA-OAEP", modulusLength: $BITS, publicExponent: new Uint8Array([1, 0, 1]), hash: "SHA-256" }, $EXTRACTABLE, $USAGE)
              - metavariable-regex:
                  metavariable: $BITS
                  regex: \d+
          - patterns:
              - pattern: |
                  crypto.subtle.generateKey({ name: "RSA-OAEP", modulusLength: $BITS, publicExponent: new Uint8Array([1, 0, 1]), hash: "SHA-256" }, $EXTRACTABLE, $USAGE)
              - metavariable-comparison:
                  metavariable: $BITS
                  comparison: $BITS < 2048
          - patterns:
              - pattern: |
                  crypto.subtle.generateKey({ name: "RSASSA-PKCS1-v1_5", modulusLength: $BITS, publicExponent: new Uint8Array([1, 0, 1]), hash: "SHA-256" }, $EXTRACTABLE, $USAGE)
              - metavariable-regex:
                  metavariable: $BITS
                  regex: \d+
          - patterns:
              - pattern: |
                  crypto.subtle.generateKey({ name: "RSASSA-PKCS1-v1_5", modulusLength: $BITS, publicExponent: new Uint8Array([1, 0, 1]), hash: "SHA-256" }, $EXTRACTABLE, $USAGE)
              - metavariable-comparison:
                  metavariable: $BITS
                  comparison: $BITS < 2048
          - patterns:
              - pattern: |
                  crypto.subtle.generateKey({ name: "ECDSA", namedCurve: $CURVE }, $EXTRACTABLE, $USAGE)
              - metavariable-regex:
                  metavariable: $CURVE
                  regex: '"(P-224|P-256|P-384|P-521|secp160k1|secp256k1|prime256v1)"'
          - pattern: crypto.createECDH($CURVE)
          - patterns:
              - pattern: |
                  crypto.subtle.generateKey({ name: "AES-GCM", length: $LENGTH }, $EXTRACTABLE, $USAGE)
              - metavariable-regex:
                  metavariable: $LENGTH
                  regex: \d+
          - patterns:
              - pattern: |
                  crypto.subtle.generateKey({ name: "AES-GCM", length: $LENGTH }, $EXTRACTABLE, $USAGE)
              - metavariable-comparison:
                  metavariable: $LENGTH
                  comparison: $LENGTH < 128
          - patterns:
              - pattern: |
                  crypto.subtle.generateKey({ name: "AES-CBC", length: $LENGTH }, $EXTRACTABLE, $USAGE)
              - metavariable-regex:
                  metavariable: $LENGTH
                  regex: \d+
          - patterns:
              - pattern: |
                  crypto.subtle.generateKey({ name: "AES-CBC", length: $LENGTH }, $EXTRACTABLE, $USAGE)
              - metavariable-comparison:
                  metavariable: $LENGTH
                  comparison: $LENGTH < 128
          - patterns:
              - pattern: |
                  crypto.subtle.generateKey({ name: "AES-KW", length: $LENGTH }, $EXTRACTABLE, $USAGE)
              - metavariable-regex:
                  metavariable: $LENGTH
                  regex: \d+
          - patterns:
              - pattern: |
                  crypto.subtle.generateKey({ name: "AES-KW", length: $LENGTH }, $EXTRACTABLE, $USAGE)
              - metavariable-comparison:
                  metavariable: $LENGTH
                  comparison: $LENGTH < 128
    pattern-not-inside:
      - pattern: |
          describe($NAME, function() {
            ...
          })
      - pattern: |
          describe($NAME, () => {
            ...
          })
      - pattern: |
          it($NAME, function() {
            ...
          })
      - pattern: |
          it($NAME, () => {
            ...
          })
      - pattern: |
          test($NAME, function() {
            ...
          })
      - pattern: |
          test($NAME, () => {
            ...
          })
      - pattern: |
          // $COMMENT
      - pattern: |
          /* $COMMENT */
    metadata:
      category: crypto
      cwe: CWE-326
      impact: "Inventory: Cryptographic key length usage detected in codebase"
  - id: javascript-crypto-sha256
    message: SHA256 hash function usage detected
    severity: INFO
    languages:
      - javascript
    focus-metavariable: $DATA
    patterns:
      - pattern-either:
          - pattern: crypto.createHash("sha256")
          - pattern: crypto.createHash('sha256')
          - pattern: |
              $HASHER = crypto.createHash("sha256");
              $HASHER.update($DATA);
              $HASH = $HASHER.digest();
          - pattern: crypto.createHash("sha256").update($DATA).digest()
          - pattern: |
              $HASHER = crypto.createHash("sha256");
              $HASHER.update($DATA);
              $HASH = $HASHER.digest("hex");
          - pattern: |
              $HASHER = crypto.createHash("sha256");
              $HASHER.update($DATA);
              $HASH = $HASHER.digest("base64");
          - pattern: crypto.createHash("sha256").update($DATA).digest("hex")
          - pattern: crypto.createHash("sha256").update($DATA).digest("base64")
          - pattern: require("crypto-js").SHA256($DATA)
          - pattern: CryptoJS.SHA256($DATA)
          - pattern: |
              const crypto = await import('crypto');
              crypto.createHash("sha256")
          - pattern: |
              const { createHash } = require('crypto');
              createHash("sha256")
          - pattern: |
              const { createHash } = await import('crypto');
              createHash("sha256")
    pattern-not-inside:
      - pattern: |
          describe($NAME, function() {
            ...
          })
      - pattern: |
          describe($NAME, () => {
            ...
          })
      - pattern: |
          it($NAME, function() {
            ...
          })
      - pattern: |
          it($NAME, () => {
            ...
          })
      - pattern: |
          test($NAME, function() {
            ...
          })
      - pattern: |
          test($NAME, () => {
            ...
          })
      - pattern: |
          // $COMMENT
      - pattern: |
          /* $COMMENT */
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: SHA256 hash function usage detected in codebase"
  - id: javascript-crypto-cipher-aes
    message: AES cipher usage detected
    severity: INFO
    languages:
      - javascript
    patterns:
      - pattern-either:
          - pattern: crypto.createCipher("aes-256-cbc", $KEY)
          - pattern: crypto.createCipheriv("aes-256-cbc", $KEY, $IV)
          - pattern: crypto.createDecipher("aes-256-cbc", $KEY)
          - pattern: crypto.createDecipheriv("aes-256-cbc", $KEY, $IV)
          - pattern: |
              $CIPHER = crypto.createCipheriv("aes-256-gcm", $KEY, $IV);
              $CIPHERTEXT = $CIPHER.update($PLAINTEXT);
              $CIPHERTEXT += $CIPHER.final();
          - pattern: require("crypto-js").AES.encrypt($DATA, $KEY)
          - pattern: CryptoJS.AES.encrypt($DATA, $KEY)
          - pattern: |
              const crypto = await import('crypto');
              crypto.createCipheriv("aes-256-cbc", $KEY, $IV)
          - pattern: |
              const { createCipheriv } = require('crypto');
              createCipheriv("aes-256-cbc", $KEY, $IV)
          - pattern: |
              const { createCipheriv } = await import('crypto');
              createCipheriv("aes-256-cbc", $KEY, $IV)
          - patterns:
              - pattern: crypto.createCipheriv($ALGO, $KEY, $IV)
              - metavariable-regex:
                  metavariable: $ALGO
                  regex: '"aes-.*"'
          - patterns:
              - pattern: crypto.createDecipheriv($ALGO, $KEY, $IV)
              - metavariable-regex:
                  metavariable: $ALGO
                  regex: '"aes-.*"'
          - patterns:
              - pattern: crypto.createCipher($ALGO, $KEY)
              - metavariable-regex:
                  metavariable: $ALGO
                  regex: '"aes-.*"'
          - patterns:
              - pattern: crypto.createDecipher($ALGO, $KEY)
              - metavariable-regex:
                  metavariable: $ALGO
                  regex: '"aes-.*"'
    pattern-not-inside:
      - pattern: |
          describe($NAME, function() {
            ...
          })
      - pattern: |
          describe($NAME, () => {
            ...
          })
      - pattern: |
          it($NAME, function() {
            ...
          })
      - pattern: |
          it($NAME, () => {
            ...
          })
      - pattern: |
          test($NAME, function() {
            ...
          })
      - pattern: |
          test($NAME, () => {
            ...
          })
      - pattern: |
          // $COMMENT
      - pattern: |
          /* $COMMENT */
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: AES cipher usage detected in codebase"
  - id: javascript-crypto-random-generation
    message: Random number generation for cryptographic use detected
    severity: INFO
    languages:
      - javascript
    patterns:
      - pattern-either:
          - pattern: crypto.randomBytes($LENGTH)
          - pattern: crypto.getRandomValues($ARRAY)
          - pattern: |
              $BYTES = crypto.randomBytes($LENGTH);
              ...
              $BYTES
          - pattern: Math.random()
          - pattern: Math.floor(Math.random() * $MAX)
    focus-metavariable: $LENGTH
    pattern-not-inside:
      - pattern: |
          describe($NAME, function() {
            ...
          })
      - pattern: |
          describe($NAME, () => {
            ...
          })
      - pattern: |
          it($NAME, function() {
            ...
          })
      - pattern: |
          it($NAME, () => {
            ...
          })
      - pattern: |
          test($NAME, function() {
            ...
          })
      - pattern: |
          test($NAME, () => {
            ...
          })
      - pattern: |
          // $COMMENT
      - pattern: |
          /* $COMMENT */
    metadata:
      category: crypto
      cwe: CWE-338
      impact:
        "Inventory: Random number generation for cryptographic use detected in
        codebase"
  - id: javascript-crypto-password-hashing
    message: Password hashing operations detected
    severity: INFO
    languages:
      - javascript
    focus-metavariable: $PASSWORD
    patterns:
      - pattern-either:
          - pattern: crypto.pbkdf2($PASSWORD, $SALT, $ITER, $KEYLEN, $DIGEST, $CALLBACK)
          - pattern: crypto.pbkdf2Sync($PASSWORD, $SALT, $ITER, $KEYLEN, $DIGEST)
          - pattern: crypto.scrypt($PASSWORD, $SALT, $KEYLEN, $OPTIONS, $CALLBACK)
          - pattern: crypto.scryptSync($PASSWORD, $SALT, $KEYLEN, $OPTIONS)
          - pattern: require("bcrypt").hash($PASSWORD, $ROUNDS, $CALLBACK)
          - pattern: require("bcrypt").hashSync($PASSWORD, $ROUNDS)
          - pattern: require("bcrypt").compare($PASSWORD, $HASH, $CALLBACK)
          - pattern: require("bcrypt").compareSync($PASSWORD, $HASH)
          - pattern: require("bcryptjs").hash($PASSWORD, $ROUNDS, $CALLBACK)
          - pattern: require("bcryptjs").hashSync($PASSWORD, $ROUNDS)
          - pattern: require("bcryptjs").compare($PASSWORD, $HASH, $CALLBACK)
          - pattern: require("bcryptjs").compareSync($PASSWORD, $HASH)
          - pattern: $BCRYPT.hash($PASSWORD, $ROUNDS, $CALLBACK)
          - pattern: $BCRYPT.hashSync($PASSWORD, $ROUNDS)
          - pattern: $BCRYPT.compare($PASSWORD, $HASH, $CALLBACK)
          - pattern: $BCRYPT.compareSync($PASSWORD, $HASH)
          - pattern: bcrypt.hash($PASSWORD, $ROUNDS, $CALLBACK)
          - pattern: bcrypt.hashSync($PASSWORD, $ROUNDS)
          - pattern: bcrypt.compare($PASSWORD, $HASH, $CALLBACK)
          - pattern: bcrypt.compareSync($PASSWORD, $HASH)
          - pattern: bcryptjs.hash($PASSWORD, $ROUNDS, $CALLBACK)
          - pattern: bcryptjs.hashSync($PASSWORD, $ROUNDS)
          - pattern: bcryptjs.compare($PASSWORD, $HASH, $CALLBACK)
          - pattern: bcryptjs.compareSync($PASSWORD, $HASH)
          - patterns:
              - pattern: require("bcrypt").hashSync($PASSWORD, $ROUNDS)
              - metavariable-comparison:
                  metavariable: $ROUNDS
                  comparison: $ROUNDS < 10
          - patterns:
              - pattern: require("bcryptjs").hashSync($PASSWORD, $ROUNDS)
              - metavariable-comparison:
                  metavariable: $ROUNDS
                  comparison: $ROUNDS < 10
          - patterns:
              - pattern: bcrypt.hashSync($PASSWORD, $ROUNDS)
              - metavariable-comparison:
                  metavariable: $ROUNDS
                  comparison: $ROUNDS < 10
          - patterns:
              - pattern: bcryptjs.hashSync($PASSWORD, $ROUNDS)
              - metavariable-comparison:
                  metavariable: $ROUNDS
                  comparison: $ROUNDS < 10
          - pattern: |
              $HASH = await bcrypt.hash($PASSWORD, $ROUNDS);
              ...
              $MATCH = await bcrypt.compare($PASSWORD, $HASH);
    pattern-not-inside:
      - pattern: |
          describe($NAME, function() {
            ...
          })
      - pattern: |
          describe($NAME, () => {
            ...
          })
      - pattern: |
          it($NAME, function() {
            ...
          })
      - pattern: |
          it($NAME, () => {
            ...
          })
      - pattern: |
          test($NAME, function() {
            ...
          })
      - pattern: |
          test($NAME, () => {
            ...
          })
      - pattern: |
          // $COMMENT
      - pattern: |
          /* $COMMENT */
    metadata:
      category: crypto
      cwe: CWE-326
      impact: "Inventory: Password hashing operations detected in codebase"
  - id: javascript-crypto-ed25519
    message: Ed25519 signature operations detected
    severity: INFO
    languages:
      - javascript
    patterns:
      - pattern-either:
          - pattern: crypto.createSign("ed25519")
          - pattern: crypto.createVerify("ed25519")
          - pattern: |
              $SIGN = crypto.createSign("ed25519");
              $SIGN.update($DATA);
              $SIGNATURE = $SIGN.sign($PRIVATE_KEY);
          - pattern: |
              $VERIFY = crypto.createVerify("ed25519");
              $VERIFY.update($DATA);
              $VERIFY.verify($PUBLIC_KEY, $SIGNATURE);
          - pattern: |
              crypto.subtle.generateKey({ name: "Ed25519" }, $EXTRACTABLE, $USAGE)
          - pattern: |
              crypto.subtle.sign({ name: "Ed25519" }, $PRIVATE_KEY, $DATA)
          - pattern: |
              crypto.subtle.verify({ name: "Ed25519" }, $PUBLIC_KEY, $SIGNATURE, $DATA)
          - pattern: require("@noble/ed25519").sign($MESSAGE, $PRIVATE_KEY)
          - pattern: require("@noble/ed25519").verify($SIGNATURE, $MESSAGE, $PUBLIC_KEY)
          - pattern: require("@noble/ed25519").getPublicKey($PRIVATE_KEY)
          - pattern: require("@noble/curves").ed25519.sign($MESSAGE, $PRIVATE_KEY)
          - pattern: require("@noble/curves").ed25519.verify($SIGNATURE, $MESSAGE, $PUBLIC_KEY)
          - pattern: require("@noble/curves").ed25519.getPublicKey($PRIVATE_KEY)
          - pattern: require("@noble/curves").ed448.sign($MESSAGE, $PRIVATE_KEY)
          - pattern: require("@noble/curves").ed448.verify($SIGNATURE, $MESSAGE, $PUBLIC_KEY)
          - pattern: require("@noble/curves").ed448.getPublicKey($PRIVATE_KEY)
          - pattern: |
              const { ed25519 } = require("@noble/curves");
              ed25519.sign($MESSAGE, $PRIVATE_KEY)
          - pattern: |
              const { ed25519 } = require("@noble/curves");
              ed25519.verify($SIGNATURE, $MESSAGE, $PUBLIC_KEY)
          - pattern: require("tweetnacl").sign.detached($MESSAGE, $SECRET_KEY)
          - pattern: require("tweetnacl").sign($MESSAGE, $SECRET_KEY)
          - pattern: require("tweetnacl").sign.open($SIGNED_MESSAGE, $PUBLIC_KEY)
          - pattern: require("tweetnacl").sign.detached.verify($MESSAGE, $SIGNATURE, $PUBLIC_KEY)
          - pattern: require("libsodium-wrappers").crypto_sign($MESSAGE, $SECRET_KEY)
          - pattern: require("libsodium-wrappers").crypto_sign_open($SIGNED_MESSAGE, $PUBLIC_KEY)
          - pattern: require("libsodium-wrappers").crypto_sign_detached($MESSAGE, $SECRET_KEY)
          - pattern:
              require("libsodium-wrappers").crypto_sign_verify_detached($SIGNATURE,
              $MESSAGE, $PUBLIC_KEY)
          - pattern: require("sjcl").ecc.ecdsa.generateKeys($CURVE, $PARANOIA)
          - pattern: require("sjcl").ecc.ecdsa.secretKey($KEY)
          - pattern: require("sjcl").ecc.ecdsa.publicKey($KEY)
    pattern-not-inside:
      - pattern: |
          describe($NAME, function() {
            ...
          })
      - pattern: |
          describe($NAME, () => {
            ...
          })
      - pattern: |
          it($NAME, function() {
            ...
          })
      - pattern: |
          it($NAME, () => {
            ...
          })
      - pattern: |
          test($NAME, function() {
            ...
          })
      - pattern: |
          test($NAME, () => {
            ...
          })
      - pattern: |
          // $COMMENT
      - pattern: |
          /* $COMMENT */
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: Ed25519 signature operations detected in codebase"
  - id: javascript-crypto-hash-comparison
    message: Hash function used in comparison or verification detected
    severity: INFO
    languages:
      - javascript
    patterns:
      - pattern-either:
          - pattern: |
              $HASH1 = crypto.createHash("md5");
              $HASH1.update($DATA1);
              $HASH2 = crypto.createHash("md5");
              $HASH2.update($DATA2);
              $HASH1.digest("hex") === $HASH2.digest("hex")
          - pattern: |
              $HASH1 = crypto.createHash("sha1");
              $HASH1.update($DATA1);
              $HASH2 = crypto.createHash("sha1");
              $HASH2.update($DATA2);
              $HASH1.digest("hex") === $HASH2.digest("hex")
          - pattern: |
              $HASH1 = crypto.createHash("sha256");
              $HASH1.update($DATA1);
              $HASH2 = crypto.createHash("sha256");
              $HASH2.update($DATA2);
              $HASH1.digest("hex") === $HASH2.digest("hex")
          - pattern: |
              $HASH = crypto.createHash("md5");
              $HASH.update($DATA);
              if ($HASH.digest("hex") === $EXPECTED) {
                ...
              }
          - pattern: |
              $HASH = crypto.createHash("sha1");
              $HASH.update($DATA);
              if ($HASH.digest("hex") === $EXPECTED) {
                ...
              }
          - pattern: |
              $HASH = crypto.createHash("sha256");
              $HASH.update($DATA);
              if ($HASH.digest("hex") === $EXPECTED) {
                ...
              }
          - pattern: |
              $HASH = crypto.createHash("md5");
              $HASH.update($DATA);
              crypto.timingSafeEqual($HASH.digest(), $EXPECTED)
          - pattern: |
              $HASH = crypto.createHash("sha256");
              $HASH.update($DATA);
              crypto.timingSafeEqual($HASH.digest(), $EXPECTED)
    pattern-not-inside:
      - pattern: |
          describe($NAME, function() {
            ...
          })
      - pattern: |
          describe($NAME, () => {
            ...
          })
      - pattern: |
          it($NAME, function() {
            ...
          })
      - pattern: |
          it($NAME, () => {
            ...
          })
      - pattern: |
          test($NAME, function() {
            ...
          })
      - pattern: |
          test($NAME, () => {
            ...
          })
      - pattern: |
          // $COMMENT
      - pattern: |
          /* $COMMENT */
    metadata:
      category: crypto
      cwe: CWE-327
      impact:
        "Inventory: Hash function used in comparison or verification detected
        in codebase"
  - id: javascript-crypto-rsa
    message: RSA cryptographic operations detected
    severity: INFO
    languages:
      - javascript
    patterns:
      - pattern-either:
          - pattern: crypto.publicEncrypt($KEY, $DATA)
          - pattern: crypto.privateDecrypt($KEY, $DATA)
          - pattern: crypto.privateEncrypt($KEY, $DATA)
          - pattern: crypto.publicDecrypt($KEY, $DATA)
          - pattern: |
              $CIPHERTEXT = crypto.publicEncrypt($PUBLIC_KEY, $PLAINTEXT);
          - pattern: |
              $PLAINTEXT = crypto.privateDecrypt($PRIVATE_KEY, $CIPHERTEXT);
          - pattern: crypto.createSign("RSA-SHA256")
          - pattern: crypto.createSign("RSA-SHA512")
          - pattern: crypto.createVerify("RSA-SHA256")
          - pattern: crypto.createVerify("RSA-SHA512")
          - pattern: |
              $SIGN = crypto.createSign("RSA-SHA256");
              $SIGN.update($DATA);
              $SIGNATURE = $SIGN.sign($PRIVATE_KEY);
          - pattern: |
              $VERIFY = crypto.createVerify("RSA-SHA256");
              $VERIFY.update($DATA);
              $VERIFY.verify($PUBLIC_KEY, $SIGNATURE);
          - pattern: require("node-forge").pki.rsa.generateKeyPair($BITS)
          - pattern: require("node-forge").pki.rsa.encrypt($DATA, $PUBLIC_KEY)
          - pattern: require("node-forge").pki.rsa.decrypt($DATA, $PRIVATE_KEY)
    pattern-not-inside:
      - pattern: |
          describe($NAME, function() {
            ...
          })
      - pattern: |
          describe($NAME, () => {
            ...
          })
      - pattern: |
          it($NAME, function() {
            ...
          })
      - pattern: |
          it($NAME, () => {
            ...
          })
      - pattern: |
          test($NAME, function() {
            ...
          })
      - pattern: |
          test($NAME, () => {
            ...
          })
      - pattern: |
          // $COMMENT
      - pattern: |
          /* $COMMENT */
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: RSA cryptographic operations detected in codebase"
  - id: javascript-crypto-salt-generation
    message: Salt generation for cryptographic use detected
    severity: INFO
    languages:
      - javascript
    patterns:
      - pattern-either:
          - pattern: crypto.randomBytes($LENGTH)
          - pattern: crypto.getRandomValues($ARRAY)
          - pattern: |
              $SALT = crypto.randomBytes(16);
              ...
              crypto.pbkdf2($PASSWORD, $SALT, $ITER, $KEYLEN, $DIGEST, $CALLBACK);
          - pattern: |
              $SALT = crypto.randomBytes(32);
              ...
              crypto.scryptSync($PASSWORD, $SALT, $KEYLEN, $OPTIONS);
          - pattern: |
              $SALT = crypto.getRandomValues(new Uint8Array(16));
              ...
              crypto.pbkdf2($PASSWORD, $SALT, $ITER, $KEYLEN, $DIGEST, $CALLBACK);
          - pattern: |
              $SALT = crypto.randomBytes($SALT_LENGTH);
              ...
              require("bcrypt").hashSync($PASSWORD, $ROUNDS);
    pattern-not-inside:
      - pattern: |
          describe($NAME, function() {
            ...
          })
      - pattern: |
          describe($NAME, () => {
            ...
          })
      - pattern: |
          it($NAME, function() {
            ...
          })
      - pattern: |
          it($NAME, () => {
            ...
          })
      - pattern: |
          test($NAME, function() {
            ...
          })
      - pattern: |
          test($NAME, () => {
            ...
          })
      - pattern: |
          // $COMMENT
      - pattern: |
          /* $COMMENT */
    metadata:
      category: crypto
      cwe: CWE-330
      impact: "Inventory: Salt generation for cryptographic use detected in codebase"
  - id: javascript-crypto-hmac
    message: HMAC usage detected
    severity: INFO
    languages:
      - javascript
    focus-metavariable: $KEY
    patterns:
      - pattern-either:
          - pattern: crypto.createHmac("sha256", $KEY)
          - pattern: crypto.createHmac("sha512", $KEY)
          - pattern: crypto.createHmac("sha1", $KEY)
          - pattern: crypto.createHmac("md5", $KEY)
          - pattern: crypto.createHmac("sha384", $KEY)
          - pattern: |
              $HMAC = crypto.createHmac("sha256", $KEY);
              $HMAC.update($DATA);
              $RESULT = $HMAC.digest();
          - pattern: crypto.createHmac("sha256", $KEY).update($DATA).digest()
          - pattern: require("crypto-js").HmacSHA256($DATA, $KEY)
          - pattern: require("crypto-js").HmacSHA512($DATA, $KEY)
          - pattern: require("crypto-js").HmacSHA1($DATA, $KEY)
          - pattern: CryptoJS.HmacSHA256($DATA, $KEY)
          - pattern: CryptoJS.HmacSHA512($DATA, $KEY)
          - pattern: CryptoJS.HmacSHA1($DATA, $KEY)
          - pattern: |
              $HMAC1 = crypto.createHmac("sha256", $KEY);
              $HMAC1.update($DATA);
              $HMAC2 = crypto.createHmac("sha256", $KEY);
              $HMAC2.update($DATA);
              crypto.timingSafeEqual($HMAC1.digest(), $HMAC2.digest())
          - pattern: |
              $HMAC1 = crypto.createHmac("sha256", $KEY);
              $HMAC1.update($DATA);
              $HMAC2 = crypto.createHmac("sha256", $KEY);
              $HMAC2.update($DATA);
              $HMAC1.digest() === $HMAC2.digest()
          - pattern: |
              $HMAC = crypto.createHmac("sha256", $KEY);
              $HMAC.update($DATA);
              $EXPECTED = Buffer.from($EXPECTED_STRING, "hex");
              crypto.timingSafeEqual($HMAC.digest(), $EXPECTED)
          - patterns:
              - pattern: crypto.createHmac($ALGO, $KEY)
              - metavariable-regex:
                  metavariable: $ALGO
                  regex: '"(sha256|sha512|sha1|md5|sha384)"'
          - patterns:
              - pattern: |
                  $HMAC = crypto.createHmac($ALGO, $KEY);
                  $HMAC.update($DATA);
                  $RESULT = $HMAC.digest();
              - metavariable-regex:
                  metavariable: $ALGO
                  regex: '"(sha256|sha512|sha1|md5|sha384)"'
          - pattern: |
              crypto.subtle.sign({ name: "HMAC", hash: $HASH }, $KEY, $DATA)
          - pattern: |
              crypto.subtle.verify({ name: "HMAC", hash: $HASH }, $KEY, $SIG, $DATA)
    pattern-not-inside:
      - pattern: |
          describe($NAME, function() {
            ...
          })
      - pattern: |
          describe($NAME, () => {
            ...
          })
      - pattern: |
          it($NAME, function() {
            ...
          })
      - pattern: |
          it($NAME, () => {
            ...
          })
      - pattern: |
          test($NAME, function() {
            ...
          })
      - pattern: |
          test($NAME, () => {
            ...
          })
      - pattern: |
          // $COMMENT
      - pattern: |
          /* $COMMENT */
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: HMAC usage detected in codebase"
  - id: javascript-crypto-ripemd160
    message: RIPEMD-160 hash function usage detected
    severity: INFO
    languages:
      - javascript
    focus-metavariable: $DATA
    patterns:
      - pattern-either:
          - pattern: crypto.createHash("ripemd160")
          - pattern: crypto.createHash("rmd160")
          - pattern: crypto.createHash('ripemd160')
          - pattern: crypto.createHash('rmd160')
          - pattern: |
              $HASHER = crypto.createHash("ripemd160");
              $HASHER.update($DATA);
              $HASH = $HASHER.digest();
          - pattern: crypto.createHash("ripemd160").update($DATA).digest()
          - pattern: |
              $HASHER = crypto.createHash("ripemd160");
              $HASHER.update($DATA);
              $HASH = $HASHER.digest("hex");
          - pattern: |
              $HASHER = crypto.createHash("ripemd160");
              $HASHER.update($DATA);
              $HASH = $HASHER.digest("base64");
          - pattern: crypto.createHash("ripemd160").update($DATA).digest("hex")
          - pattern: crypto.createHash("ripemd160").update($DATA).digest("base64")
    pattern-not-inside:
      - pattern: |
          describe($NAME, function() {
            ...
          })
      - pattern: |
          describe($NAME, () => {
            ...
          })
      - pattern: |
          it($NAME, function() {
            ...
          })
      - pattern: |
          it($NAME, () => {
            ...
          })
      - pattern: |
          test($NAME, function() {
            ...
          })
      - pattern: |
          test($NAME, () => {
            ...
          })
      - pattern: |
          // $COMMENT
      - pattern: |
          /* $COMMENT */
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: RIPEMD-160 hash function usage detected in codebase"
  - id: javascript-crypto-digital-signatures
    message: Digital signature operations detected
    severity: INFO
    languages:
      - javascript
    patterns:
      - pattern-either:
          - pattern: crypto.createSign("RSA-SHA256")
          - pattern: crypto.createSign("RSA-SHA512")
          - pattern: crypto.createSign("ecdsa-with-SHA256")
          - pattern: crypto.createSign("ecdsa-with-SHA512")
          - pattern: crypto.createVerify("RSA-SHA256")
          - pattern: crypto.createVerify("RSA-SHA512")
          - pattern: crypto.createVerify("ecdsa-with-SHA256")
          - pattern: crypto.createVerify("ecdsa-with-SHA512")
          - pattern: |
              $SIGN = crypto.createSign("RSA-SHA256");
              $SIGN.update($DATA);
              $SIGNATURE = $SIGN.sign($PRIVATE_KEY);
          - pattern: |
              $VERIFY = crypto.createVerify("RSA-SHA256");
              $VERIFY.update($DATA);
              $VERIFY.verify($PUBLIC_KEY, $SIGNATURE);
          - pattern: |
              crypto.subtle.sign({ name: "RSASSA-PKCS1-v1_5", hash: "SHA-256" }, $PRIVATE_KEY, $DATA)
          - pattern: |
              crypto.subtle.sign({ name: "RSA-PSS", hash: "SHA-256" }, $PRIVATE_KEY, $DATA)
          - pattern: |
              crypto.subtle.sign({ name: "ECDSA", hash: "SHA-256" }, $PRIVATE_KEY, $DATA)
          - pattern: |
              crypto.subtle.verify({ name: "RSASSA-PKCS1-v1_5", hash: "SHA-256" }, $PUBLIC_KEY, $SIGNATURE, $DATA)
          - pattern: |
              crypto.subtle.verify({ name: "RSA-PSS", hash: "SHA-256" }, $PUBLIC_KEY, $SIGNATURE, $DATA)
          - pattern: |
              crypto.subtle.verify({ name: "ECDSA", hash: "SHA-256" }, $PUBLIC_KEY, $SIGNATURE, $DATA)
    pattern-not-inside:
      - pattern: |
          describe($NAME, function() {
            ...
          })
      - pattern: |
          describe($NAME, () => {
            ...
          })
      - pattern: |
          it($NAME, function() {
            ...
          })
      - pattern: |
          it($NAME, () => {
            ...
          })
      - pattern: |
          test($NAME, function() {
            ...
          })
      - pattern: |
          test($NAME, () => {
            ...
          })
      - pattern: |
          // $COMMENT
      - pattern: |
          /* $COMMENT */
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: Digital signature operations detected in codebase"
  - id: javascript-crypto-blake2
    message: BLAKE2 hash function usage detected
    severity: INFO
    languages:
      - javascript
    patterns:
      - pattern-either:
          - pattern: crypto.createHash("blake2b512")
          - pattern: crypto.createHash("blake2s256")
          - pattern: crypto.createHash('blake2b512')
          - pattern: crypto.createHash('blake2s256')
          - pattern: |
              $HASHER = crypto.createHash("blake2b512");
              $HASHER.update($DATA);
              $HASH = $HASHER.digest();
          - pattern: |
              $HASHER = crypto.createHash("blake2s256");
              $HASHER.update($DATA);
              $HASH = $HASHER.digest();
          - pattern: crypto.createHash("blake2b512").update($DATA).digest()
          - pattern: crypto.createHash("blake2s256").update($DATA).digest()
          - pattern: require("@noble/hashes").blake2b($DATA)
          - pattern: require("@noble/hashes").blake2s($DATA)
          - pattern: require("@noble/hashes").blake2b512($DATA)
          - pattern: require("@noble/hashes").blake2s256($DATA)
          - pattern: |
              const { blake2b } = require("@noble/hashes");
              blake2b($DATA)
          - pattern: |
              const { blake2s } = require("@noble/hashes");
              blake2s($DATA)
    focus-metavariable: $DATA
    pattern-not-inside:
      - pattern: |
          describe($NAME, function() {
            ...
          })
      - pattern: |
          describe($NAME, () => {
            ...
          })
      - pattern: |
          it($NAME, function() {
            ...
          })
      - pattern: |
          it($NAME, () => {
            ...
          })
      - pattern: |
          test($NAME, function() {
            ...
          })
      - pattern: |
          test($NAME, () => {
            ...
          })
      - pattern: |
          // $COMMENT
      - pattern: |
          /* $COMMENT */
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: BLAKE2 hash function usage detected in codebase"
  - id: javascript-crypto-webcrypto-api
    message: Web Crypto API usage detected
    severity: INFO
    languages:
      - javascript
    patterns:
      - pattern-either:
          - pattern: crypto.subtle.encrypt($ALGO, $KEY, $DATA)
          - pattern: crypto.subtle.decrypt($ALGO, $KEY, $DATA)
          - pattern: crypto.subtle.sign($ALGO, $KEY, $DATA)
          - pattern: crypto.subtle.verify($ALGO, $KEY, $SIG, $DATA)
          - pattern: crypto.subtle.generateKey($ALGO, $EXTRACTABLE, $USAGE)
          - pattern:
              crypto.subtle.deriveKey($ALGO, $BASE_KEY, $DERIVED_ALGO, $EXTRACTABLE,
              $USAGE)
          - pattern: crypto.subtle.deriveBits($ALGO, $BASE_KEY, $LENGTH)
          - pattern: crypto.subtle.digest($ALGO, $DATA)
          - pattern: crypto.subtle.importKey($FORMAT, $KEY_DATA, $ALGO, $EXTRACTABLE, $USAGE)
          - pattern: crypto.subtle.exportKey($FORMAT, $KEY)
          - pattern: crypto.subtle.wrapKey($FORMAT, $KEY, $WRAPPING_KEY, $WRAP_ALGO)
          - pattern:
              crypto.subtle.unwrapKey($FORMAT, $WRAPPED_KEY, $UNWRAPPING_KEY, $UNWRAP_ALGO,
              $UNWRAPPED_ALGO, $EXTRACTABLE, $USAGE)
          - pattern: |
              $KEY = await crypto.subtle.generateKey(
                { name: "AES-GCM", length: 256 },
                true,
                ["encrypt", "decrypt"]
              );
          - pattern: |
              $HASH = await crypto.subtle.digest("SHA-256", $DATA);
          - pattern: |
              $KEY = await crypto.subtle.importKey("raw", $KEY_DATA, "AES-GCM", false, ["encrypt"]);
          - pattern: |
              $KEY_DATA = await crypto.subtle.exportKey("raw", $KEY);
          - pattern: |
              $WRAPPED = await crypto.subtle.wrapKey("raw", $KEY, $WRAPPING_KEY, { name: "AES-KW" });
          - pattern: |
              $UNWRAPPED = await crypto.subtle.unwrapKey("raw", $WRAPPED_KEY, $UNWRAPPING_KEY, { name: "AES-KW" }, "AES-GCM", false, ["encrypt"]);
          - pattern: |
              crypto.subtle.encrypt({ name: "ChaCha20-Poly1305", iv: $IV }, $KEY, $DATA)
          - pattern: |
              crypto.subtle.decrypt({ name: "ChaCha20-Poly1305", iv: $IV }, $KEY, $DATA)
          - pattern: |
              crypto.subtle.generateKey({ name: "X25519" }, $EXTRACTABLE, $USAGE)
          - pattern: |
              crypto.subtle.generateKey({ name: "X448" }, $EXTRACTABLE, $USAGE)
          - pattern: |
              crypto.subtle.generateKey({ name: "Ed25519" }, $EXTRACTABLE, $USAGE)
          - pattern: |
              crypto.subtle.generateKey({ name: "Ed448" }, $EXTRACTABLE, $USAGE)
          - pattern: |
              crypto.subtle.sign({ name: "Ed25519" }, $PRIVATE_KEY, $DATA)
          - pattern: |
              crypto.subtle.verify({ name: "Ed25519" }, $PUBLIC_KEY, $SIG, $DATA)
          - pattern: |
              crypto.subtle.sign({ name: "Ed448" }, $PRIVATE_KEY, $DATA)
          - pattern: |
              crypto.subtle.verify({ name: "Ed448" }, $PUBLIC_KEY, $SIG, $DATA)
          - pattern: |
              crypto.subtle.deriveKey({ name: "X25519" }, $PRIVATE_KEY, $PUBLIC_KEY, $DERIVED_ALGO, $EXTRACTABLE, $USAGE)
          - pattern: |
              crypto.subtle.deriveKey({ name: "X448" }, $PRIVATE_KEY, $PUBLIC_KEY, $DERIVED_ALGO, $EXTRACTABLE, $USAGE)
          - pattern: |
              crypto.subtle.deriveBits({ name: "X25519" }, $PRIVATE_KEY, $PUBLIC_KEY, $LENGTH)
          - pattern: |
              crypto.subtle.deriveBits({ name: "X448" }, $PRIVATE_KEY, $PUBLIC_KEY, $LENGTH)
    pattern-not-inside:
      - pattern: |
          describe($NAME, function() {
            ...
          })
      - pattern: |
          describe($NAME, () => {
            ...
          })
      - pattern: |
          it($NAME, function() {
            ...
          })
      - pattern: |
          it($NAME, () => {
            ...
          })
      - pattern: |
          test($NAME, function() {
            ...
          })
      - pattern: |
          test($NAME, () => {
            ...
          })
      - pattern: |
          // $COMMENT
      - pattern: |
          /* $COMMENT */
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: Web Crypto API usage detected in codebase"
  - id: javascript-crypto-scrypt
    message: Scrypt key derivation function usage detected
    severity: INFO
    languages:
      - javascript
    focus-metavariable: $PASSWORD
    patterns:
      - pattern-either:
          - pattern: crypto.scrypt($PASSWORD, $SALT, $KEYLEN, $OPTIONS, $CALLBACK)
          - pattern: crypto.scryptSync($PASSWORD, $SALT, $KEYLEN, $OPTIONS)
          - pattern: |
              crypto.scrypt($PASSWORD, $SALT, $KEYLEN, { N: $N, r: $R, p: $P }, function($ERR, $KEY) {
                ...
              });
          - pattern: |
              $KEY = crypto.scryptSync($PASSWORD, $SALT, $KEYLEN, { N: $N, r: $R, p: $P });
          - patterns:
              - pattern: crypto.scryptSync($PASSWORD, $SALT, $KEYLEN, $OPTIONS)
              - metavariable-regex:
                  metavariable: $KEYLEN
                  regex: \d+
          - patterns:
              - pattern: |
                  crypto.scryptSync($PASSWORD, $SALT, $KEYLEN, { N: $N, r: $R, p: $P })
              - metavariable-comparison:
                  metavariable: $N
                  comparison: $N < 16384
          - patterns:
              - pattern: |
                  crypto.scrypt($PASSWORD, $SALT, $KEYLEN, { N: $N, r: $R, p: $P }, $CALLBACK)
              - metavariable-comparison:
                  metavariable: $N
                  comparison: $N < 16384
    pattern-not-inside:
      - pattern: |
          describe($NAME, function() {
            ...
          })
      - pattern: |
          describe($NAME, () => {
            ...
          })
      - pattern: |
          it($NAME, function() {
            ...
          })
      - pattern: |
          it($NAME, () => {
            ...
          })
      - pattern: |
          test($NAME, function() {
            ...
          })
      - pattern: |
          test($NAME, () => {
            ...
          })
      - pattern: |
          // $COMMENT
      - pattern: |
          /* $COMMENT */
    metadata:
      category: crypto
      cwe: CWE-326
      impact: "Inventory: Scrypt key derivation function usage detected in codebase"
  - id: javascript-crypto-cipher-des
    message: DES cipher usage detected
    severity: INFO
    languages:
      - javascript
    patterns:
      - pattern-either:
          - pattern: crypto.createCipher("des", $KEY)
          - pattern: crypto.createCipher("des-ede", $KEY)
          - pattern: crypto.createCipher("des-ede3", $KEY)
          - pattern: crypto.createCipheriv("des", $KEY, $IV)
          - pattern: crypto.createCipheriv("des-ede", $KEY, $IV)
          - pattern: crypto.createCipheriv("des-ede3", $KEY, $IV)
          - pattern: crypto.createDecipher("des", $KEY)
          - pattern: crypto.createDecipher("des-ede", $KEY)
          - pattern: crypto.createDecipher("des-ede3", $KEY)
          - pattern: crypto.createDecipheriv("des", $KEY, $IV)
          - pattern: crypto.createDecipheriv("des-ede", $KEY, $IV)
          - pattern: crypto.createDecipheriv("des-ede3", $KEY, $IV)
          - pattern: require("crypto-js").DES.encrypt($DATA, $KEY)
          - pattern: CryptoJS.DES.encrypt($DATA, $KEY)
          - pattern: require("crypto-js").TripleDES.encrypt($DATA, $KEY)
          - pattern: CryptoJS.TripleDES.encrypt($DATA, $KEY)
    pattern-not-inside:
      - pattern: |
          describe($NAME, function() {
            ...
          })
      - pattern: |
          describe($NAME, () => {
            ...
          })
      - pattern: |
          it($NAME, function() {
            ...
          })
      - pattern: |
          it($NAME, () => {
            ...
          })
      - pattern: |
          test($NAME, function() {
            ...
          })
      - pattern: |
          test($NAME, () => {
            ...
          })
      - pattern: |
          // $COMMENT
      - pattern: |
          /* $COMMENT */
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: DES cipher usage detected in codebase"
  - id: javascript-crypto-cipher-modes
    message: Cryptographic cipher mode usage detected
    severity: INFO
    languages:
      - javascript
    patterns:
      - pattern-either:
          - pattern: crypto.createCipheriv("aes-256-cbc", $KEY, $IV)
          - pattern: crypto.createCipheriv("aes-256-ecb", $KEY, $IV)
          - pattern: crypto.createCipheriv("aes-256-cfb", $KEY, $IV)
          - pattern: crypto.createCipheriv("aes-256-ofb", $KEY, $IV)
          - pattern: crypto.createCipheriv("aes-256-ctr", $KEY, $IV)
          - pattern: crypto.createCipheriv("aes-256-gcm", $KEY, $IV)
          - pattern: crypto.createDecipheriv("aes-256-cbc", $KEY, $IV)
          - pattern: crypto.createDecipheriv("aes-256-ecb", $KEY, $IV)
          - pattern: crypto.createDecipheriv("aes-256-cfb", $KEY, $IV)
          - pattern: crypto.createDecipheriv("aes-256-ofb", $KEY, $IV)
          - pattern: crypto.createDecipheriv("aes-256-ctr", $KEY, $IV)
          - pattern: crypto.createDecipheriv("aes-256-gcm", $KEY, $IV)
          - pattern: |
              crypto.subtle.encrypt({ name: "ChaCha20-Poly1305", iv: $IV }, $KEY, $DATA)
          - pattern: |
              crypto.subtle.decrypt({ name: "ChaCha20-Poly1305", iv: $IV }, $KEY, $DATA)
          - pattern: require("@noble/ciphers").chacha20poly1305($KEY, $NONCE)
          - pattern: require("tweetnacl").secretbox($MESSAGE, $NONCE, $KEY)
          - pattern: require("tweetnacl").secretbox.open($CIPHERTEXT, $NONCE, $KEY)
          - pattern: require("libsodium-wrappers").crypto_secretbox($MESSAGE, $NONCE, $KEY)
          - pattern:
              require("libsodium-wrappers").crypto_secretbox_open($CIPHERTEXT, $NONCE,
              $KEY)
          - pattern: require("sjcl").mode.ocb2.encrypt($CIPHER, $PLAINTEXT, $IV)
          - pattern: require("sjcl").mode.ocb2.decrypt($CIPHER, $CIPHERTEXT, $IV)
          - pattern: require("sjcl").mode.gcm.encrypt($CIPHER, $PLAINTEXT, $IV)
          - pattern: require("sjcl").mode.gcm.decrypt($CIPHER, $CIPHERTEXT, $IV)
          - pattern: |
              $CIPHER = crypto.createCipheriv("aes-256-$MODE", $KEY, $IV);
              $CIPHERTEXT = $CIPHER.update($PLAINTEXT);
              $CIPHERTEXT += $CIPHER.final();
          - pattern: |
              $DECIPHER = crypto.createDecipheriv("aes-256-$MODE", $KEY, $IV);
              $PLAINTEXT = $DECIPHER.update($CIPHERTEXT);
              $PLAINTEXT += $DECIPHER.final();
    pattern-not-inside:
      - pattern: |
          describe($NAME, function() {
            ...
          })
      - pattern: |
          describe($NAME, () => {
            ...
          })
      - pattern: |
          it($NAME, function() {
            ...
          })
      - pattern: |
          it($NAME, () => {
            ...
          })
      - pattern: |
          test($NAME, function() {
            ...
          })
      - pattern: |
          test($NAME, () => {
            ...
          })
      - pattern: |
          // $COMMENT
      - pattern: |
          /* $COMMENT */
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: Cryptographic cipher mode usage detected in codebase"
  - id: javascript-crypto-static-salt
    message: Static salt value usage detected
    severity: INFO
    languages:
      - javascript
    patterns:
      - pattern-either:
          - pattern: |
              const SALT = Buffer.from("$STATIC_VALUE");
              ...
              crypto.pbkdf2Sync($PASSWORD, SALT, $ITER, $KEYLEN, $DIGEST);
          - pattern: |
              const SALT = Buffer.from("$STATIC_VALUE");
              ...
              crypto.scryptSync($PASSWORD, SALT, $KEYLEN);
          - pattern:
              crypto.pbkdf2Sync($PASSWORD, Buffer.from("$STATIC_SALT"), $ITER, $KEYLEN,
              $DIGEST)
          - pattern: crypto.scryptSync($PASSWORD, Buffer.from("$STATIC_SALT"), $KEYLEN)
          - pattern: |
              const SALT = new Uint8Array([$STATIC_VALUES]);
              ...
              crypto.subtle.deriveKey({ name: "PBKDF2", salt: SALT, iterations: $ITER, hash: "SHA-256" }, $BASE_KEY, $DERIVED_ALGO, $EXTRACTABLE, $USAGE);
          - pattern: |
              const SALT = Buffer.from("$STATIC_VALUE", "hex");
              ...
              crypto.pbkdf2Sync($PASSWORD, SALT, $ITER, $KEYLEN, $DIGEST);
          - pattern: |
              const SALT = Buffer.from("$STATIC_VALUE", "base64");
              ...
              crypto.pbkdf2Sync($PASSWORD, SALT, $ITER, $KEYLEN, $DIGEST)
          - pattern: |
              const STATIC_SALT = "$VALUE";
              ...
              crypto.pbkdf2Sync($PASSWORD, Buffer.from(STATIC_SALT), $ITER, $KEYLEN, $DIGEST)
          - pattern: |
              const STATIC_SALT = "$VALUE";
              ...
              crypto.scryptSync($PASSWORD, Buffer.from(STATIC_SALT), $KEYLEN)
          - pattern: |
              const STATIC_SALT = "$VALUE";
              ...
              crypto.subtle.deriveKey({ name: "PBKDF2", salt: Buffer.from(STATIC_SALT), iterations: $ITER, hash: "SHA-256" }, $BASE_KEY, $DERIVED_ALGO, $EXTRACTABLE, $USAGE)
          - patterns:
              - pattern: |
                  const SALT = Buffer.from("$STATIC_VALUE");
                  ...
                  crypto.pbkdf2Sync($PASSWORD, SALT, $ITER, $KEYLEN, $DIGEST);
              - metavariable-regex:
                  metavariable: $STATIC_VALUE
                  regex: ^(?!.*randomBytes|.*getRandomValues|.*random).*$
          - patterns:
              - pattern: |
                  const SALT = Buffer.from("$STATIC_VALUE");
                  ...
                  crypto.scryptSync($PASSWORD, SALT, $KEYLEN);
              - metavariable-regex:
                  metavariable: $STATIC_VALUE
                  regex: ^(?!.*randomBytes|.*getRandomValues|.*random).*$
    pattern-not-inside:
      - pattern: |
          describe($NAME, function() {
            ...
          })
      - pattern: |
          describe($NAME, () => {
            ...
          })
      - pattern: |
          it($NAME, function() {
            ...
          })
      - pattern: |
          it($NAME, () => {
            ...
          })
      - pattern: |
          test($NAME, function() {
            ...
          })
      - pattern: |
          test($NAME, () => {
            ...
          })
      - pattern: |
          // $COMMENT
      - pattern: |
          /* $COMMENT */
    metadata:
      category: crypto
      cwe: CWE-330
      impact: "Inventory: Static salt value usage detected in codebase"
  - id: javascript-crypto-key-derivation
    message: Key derivation function usage detected
    severity: INFO
    languages:
      - javascript
    patterns:
      - pattern-either:
          - pattern: crypto.pbkdf2($PASSWORD, $SALT, $ITER, $KEYLEN, $DIGEST, $CALLBACK)
          - pattern: crypto.pbkdf2Sync($PASSWORD, $SALT, $ITER, $KEYLEN, $DIGEST)
          - pattern: crypto.scrypt($PASSWORD, $SALT, $KEYLEN, $OPTIONS, $CALLBACK)
          - pattern: crypto.scryptSync($PASSWORD, $SALT, $KEYLEN, $OPTIONS)
          - pattern: crypto.createECDH("prime256v1")
          - pattern: |
              $ECDH = crypto.createECDH("prime256v1");
              $ECDH.generateKeys();
              $SHARED = $ECDH.computeSecret($PUBLIC_KEY);
          - pattern:
              crypto.subtle.deriveKey($ALGO, $BASE_KEY, $DERIVED_ALGO, $EXTRACTABLE,
              $USAGE)
          - pattern: crypto.subtle.deriveBits($ALGO, $BASE_KEY, $LENGTH)
          - pattern: |
              $KEY = await crypto.subtle.deriveKey(
                { name: "PBKDF2", salt: $SALT, iterations: $ITER, hash: "SHA-256" },
                $BASE_KEY,
                { name: "AES-GCM", length: 256 },
                false,
                ["encrypt", "decrypt"]
              );
          - pattern: |
              crypto.subtle.deriveKey({ name: "HKDF", hash: "SHA-256", salt: $SALT, info: $INFO }, $BASE_KEY, $DERIVED_ALGO, $EXTRACTABLE, $USAGE)
          - pattern: |
              crypto.subtle.deriveBits({ name: "HKDF", hash: "SHA-256", salt: $SALT, info: $INFO }, $BASE_KEY, $LENGTH)
          - pattern: |
              $KEY = await crypto.subtle.deriveKey(
                { name: "HKDF", hash: "SHA-256", salt: $SALT, info: $INFO },
                $BASE_KEY,
                { name: "AES-GCM", length: 256 },
                false,
                ["encrypt", "decrypt"]
              );
    pattern-not-inside:
      - pattern: |
          describe($NAME, function() {
            ...
          })
      - pattern: |
          describe($NAME, () => {
            ...
          })
      - pattern: |
          it($NAME, function() {
            ...
          })
      - pattern: |
          it($NAME, () => {
            ...
          })
      - pattern: |
          test($NAME, function() {
            ...
          })
      - pattern: |
          test($NAME, () => {
            ...
          })
      - pattern: |
          // $COMMENT
      - pattern: |
          /* $COMMENT */
    metadata:
      category: crypto
      cwe: CWE-326
      impact: "Inventory: Key derivation function usage detected in codebase"
  - id: javascript-crypto-diffie-hellman
    message: Diffie-Hellman key exchange usage detected
    severity: INFO
    languages:
      - javascript
    patterns:
      - pattern-either:
          - pattern: crypto.createDiffieHellman($PRIME, $ENCODING)
          - pattern: crypto.createDiffieHellman($PRIME_LENGTH)
          - pattern: crypto.createDiffieHellmanGroup("modp14")
          - pattern: crypto.createDiffieHellmanGroup("modp15")
          - pattern: crypto.createDiffieHellmanGroup("modp16")
          - pattern: |
              $DH = crypto.createDiffieHellman($PRIME_LENGTH);
              $DH.generateKeys();
              $SHARED = $DH.computeSecret($PUBLIC_KEY);
          - pattern: |
              $DH = crypto.createDiffieHellmanGroup("modp14");
              $DH.generateKeys();
              $SHARED = $DH.computeSecret($PUBLIC_KEY);
          - pattern: crypto.createECDH("prime256v1")
          - pattern: crypto.createECDH("secp256k1")
          - pattern: |
              $ECDH = crypto.createECDH("prime256v1");
              $ECDH.generateKeys();
              $SHARED = $ECDH.computeSecret($PUBLIC_KEY);
          - pattern: |
              crypto.subtle.generateKey({ name: "X25519" }, $EXTRACTABLE, $USAGE)
          - pattern: |
              crypto.subtle.deriveKey({ name: "X25519" }, $BASE_KEY, $DERIVED_ALGO, $EXTRACTABLE, $USAGE)
          - pattern: require("@noble/curves").x25519.getSharedSecret($PRIVATE_KEY, $PUBLIC_KEY)
          - pattern: require("@noble/curves").x25519.getPublicKey($PRIVATE_KEY)
          - pattern: require("@noble/curves").x448.getSharedSecret($PRIVATE_KEY, $PUBLIC_KEY)
          - pattern: require("@noble/curves").x448.getPublicKey($PRIVATE_KEY)
          - pattern: require("@noble/curves").secp256k1.getSharedSecret($PRIVATE_KEY, $PUBLIC_KEY)
          - pattern: require("@noble/curves").secp256k1.getPublicKey($PRIVATE_KEY)
          - pattern: require("@noble/curves").p256.getSharedSecret($PRIVATE_KEY, $PUBLIC_KEY)
          - pattern: require("@noble/curves").p256.getPublicKey($PRIVATE_KEY)
          - pattern: require("@noble/curves").p384.getSharedSecret($PRIVATE_KEY, $PUBLIC_KEY)
          - pattern: require("@noble/curves").p384.getPublicKey($PRIVATE_KEY)
          - pattern: require("@noble/curves").p521.getSharedSecret($PRIVATE_KEY, $PUBLIC_KEY)
          - pattern: require("@noble/curves").p521.getPublicKey($PRIVATE_KEY)
          - pattern: |
              const { x25519 } = require("@noble/curves");
              x25519.getSharedSecret($PRIVATE_KEY, $PUBLIC_KEY)
          - pattern: |
              const { secp256k1 } = require("@noble/curves");
              secp256k1.getSharedSecret($PRIVATE_KEY, $PUBLIC_KEY)
          - pattern: require("tweetnacl").box.keyPair()
          - pattern: require("tweetnacl").box($MESSAGE, $NONCE, $PUBLIC_KEY, $SECRET_KEY)
          - pattern: require("tweetnacl").box.open($CIPHERTEXT, $NONCE, $PUBLIC_KEY, $SECRET_KEY)
          - pattern: require("libsodium-wrappers").crypto_box_keypair()
          - pattern:
              require("libsodium-wrappers").crypto_box($MESSAGE, $NONCE, $PUBLIC_KEY,
              $SECRET_KEY)
          - pattern:
              require("libsodium-wrappers").crypto_box_open($CIPHERTEXT, $NONCE,
              $PUBLIC_KEY, $SECRET_KEY)
          - pattern: require("sjcl").ecc.elGamal.generateKeys($CURVE, $PARANOIA)
    pattern-not-inside:
      - pattern: |
          describe($NAME, function() {
            ...
          })
      - pattern: |
          describe($NAME, () => {
            ...
          })
      - pattern: |
          it($NAME, function() {
            ...
          })
      - pattern: |
          it($NAME, () => {
            ...
          })
      - pattern: |
          test($NAME, function() {
            ...
          })
      - pattern: |
          test($NAME, () => {
            ...
          })
      - pattern: |
          // $COMMENT
      - pattern: |
          /* $COMMENT */
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: Diffie-Hellman key exchange usage detected in codebase"
  - id: csharp-crypto-cipher-des
    message: DES cipher usage detected
    severity: INFO
    languages:
      - csharp
    focus-metavariable: $KEY
    patterns:
      - pattern-either:
          - pattern: DES.Create()
          - pattern: TripleDES.Create()
          - pattern: new DESCryptoServiceProvider()
          - pattern: new TripleDESCryptoServiceProvider()
          - pattern: |
              using ($CIPHER = DES.Create()) {
                $CIPHER.Key = $KEY;
                $CIPHER.IV = $IV;
                $ENCRYPTOR = $CIPHER.CreateEncryptor();
                $CIPHERTEXT = $ENCRYPTOR.TransformFinalBlock($PLAINTEXT, 0, $PLAINTEXT.Length);
              }
    pattern-not-inside:
      - pattern: |
          [Test]
          public void $NAME() {
            ...
          }
      - pattern: |
          [Fact]
          public void $NAME() {
            ...
          }
      - pattern: |
          [Theory]
          public void $NAME() {
            ...
          }
      - pattern: |
          // $COMMENT
      - pattern: |
          /* $COMMENT */
      - pattern: |
          /// $DOCSTRING
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: DES cipher usage detected in codebase"
  - id: csharp-crypto-sha1
    message: SHA1 hash function usage detected
    severity: INFO
    languages:
      - csharp
    focus-metavariable: $DATA
    patterns:
      - pattern-either:
          - pattern: SHA1.Create()
          - pattern: new SHA1CryptoServiceProvider()
          - pattern: SHA1Managed()
          - pattern: new SHA1Managed()
          - pattern: SHA1Cng()
          - pattern: new SHA1Cng()
          - pattern: |
              using ($HASHER = SHA1.Create()) {
                $BYTES = $HASHER.ComputeHash($DATA);
              }
          - pattern: |
              $HASHER = SHA1.Create();
              $HASH = $HASHER.ComputeHash($DATA);
          - pattern: |
              SHA1 $HASHER = SHA1.Create();
              $HASH = $HASHER.ComputeHash($DATA);
    pattern-not-inside:
      - pattern: |
          [Test]
          public void $NAME() {
            ...
          }
      - pattern: |
          [Fact]
          public void $NAME() {
            ...
          }
      - pattern: |
          [Theory]
          public void $NAME() {
            ...
          }
      - pattern: |
          // $COMMENT
      - pattern: |
          /* $COMMENT */
      - pattern: |
          /// $DOCSTRING
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: SHA1 hash function usage detected in codebase"
  - id: csharp-crypto-sha3
    message: SHA3 hash function usage detected
    severity: INFO
    languages:
      - csharp
    focus-metavariable: $DATA
    patterns:
      - pattern-either:
          - pattern: SHA3_256.Create()
          - pattern: SHA3_384.Create()
          - pattern: SHA3_512.Create()
          - pattern: new SHA3_256()
          - pattern: new SHA3_384()
          - pattern: new SHA3_512()
          - pattern: |
              using ($HASHER = SHA3_256.Create()) {
                $BYTES = $HASHER.ComputeHash($DATA);
              }
          - pattern: |
              using ($HASHER = SHA3_384.Create()) {
                $BYTES = $HASHER.ComputeHash($DATA);
              }
          - pattern: |
              using ($HASHER = SHA3_512.Create()) {
                $BYTES = $HASHER.ComputeHash($DATA);
              }
          - pattern: |
              $HASHER = SHA3_256.Create();
              $HASH = $HASHER.ComputeHash($DATA);
          - pattern: |
              SHA3_256 $HASHER = SHA3_256.Create();
              $HASH = $HASHER.ComputeHash($DATA);
    pattern-not-inside:
      - pattern: |
          [Test]
          public void $NAME() {
            ...
          }
      - pattern: |
          [Fact]
          public void $NAME() {
            ...
          }
      - pattern: |
          [Theory]
          public void $NAME() {
            ...
          }
      - pattern: |
          // $COMMENT
      - pattern: |
          /* $COMMENT */
      - pattern: |
          /// $DOCSTRING
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: SHA3 hash function usage detected in codebase"
  - id: csharp-crypto-pbkdf2
    message: PBKDF2 key derivation function usage detected
    severity: INFO
    languages:
      - csharp
    focus-metavariable: $PASSWORD
    patterns:
      - pattern-either:
          - pattern: new Rfc2898DeriveBytes($PASSWORD, $SALT, $ITER)
          - pattern: new Rfc2898DeriveBytes($PASSWORD, $SALT, $ITER, HashAlgorithmName.$ALGO)
          - pattern: |
              using ($KDF = new Rfc2898DeriveBytes($PASSWORD, $SALT, $ITER)) {
                $KEY = $KDF.GetBytes($KEYLEN);
              }
          - pattern: |
              $KDF = new Rfc2898DeriveBytes($PASSWORD, $SALT, $ITER);
              $KEY = $KDF.GetBytes($KEYLEN);
          - patterns:
              - pattern: new Rfc2898DeriveBytes($PASSWORD, $SALT, $ITER)
              - metavariable-regex:
                  metavariable: $ITER
                  regex: \d+
          - patterns:
              - pattern: new Rfc2898DeriveBytes($PASSWORD, $SALT, $ITER)
              - metavariable-comparison:
                  metavariable: $ITER
                  comparison: $ITER < 100000
          - patterns:
              - pattern: |
                  $KDF = new Rfc2898DeriveBytes($PASSWORD, $SALT, $ITER);
                  $KEY = $KDF.GetBytes($KEYLEN);
              - metavariable-comparison:
                  metavariable: $KEYLEN
                  comparison: $KEYLEN < 32
    pattern-not-inside:
      - pattern: |
          [Test]
          public void $NAME() {
            ...
          }
      - pattern: |
          [Fact]
          public void $NAME() {
            ...
          }
      - pattern: |
          [Theory]
          public void $NAME() {
            ...
          }
      - pattern: |
          // $COMMENT
      - pattern: |
          /* $COMMENT */
      - pattern: |
          /// $DOCSTRING
    metadata:
      category: crypto
      cwe: CWE-326
      impact: "Inventory: PBKDF2 key derivation function usage detected in codebase"
  - id: csharp-crypto-password-hashing
    message: Password hashing operations detected
    severity: INFO
    languages:
      - csharp
    focus-metavariable: $PASSWORD
    patterns:
      - pattern-either:
          - pattern: BCrypt.Net.BCrypt.HashPassword($PASSWORD, $WORK_FACTOR)
          - pattern: BCrypt.Net.BCrypt.HashPassword($PASSWORD)
          - pattern: BCrypt.Net.BCrypt.Verify($PASSWORD, $HASH)
          - pattern: new Rfc2898DeriveBytes($PASSWORD, $SALT, $ITER)
          - pattern: |
              $HASH = BCrypt.Net.BCrypt.HashPassword($PASSWORD);
              ...
              BCrypt.Net.BCrypt.Verify($INPUT, $HASH);
          - patterns:
              - pattern: BCrypt.Net.BCrypt.HashPassword($PASSWORD, $WORK_FACTOR)
              - metavariable-comparison:
                  metavariable: $WORK_FACTOR
                  comparison: $WORK_FACTOR < 10
    pattern-not-inside:
      - pattern: |
          [Test]
          public void $NAME() {
            ...
          }
      - pattern: |
          [Fact]
          public void $NAME() {
            ...
          }
      - pattern: |
          [Theory]
          public void $NAME() {
            ...
          }
      - pattern: |
          // $COMMENT
      - pattern: |
          /* $COMMENT */
      - pattern: |
          /// $DOCSTRING
    metadata:
      category: crypto
      cwe: CWE-326
      impact: "Inventory: Password hashing operations detected in codebase"
  - id: csharp-crypto-aes-gcm
    message: AES-GCM AEAD mode usage detected
    severity: INFO
    languages:
      - csharp
    focus-metavariable: $KEY
    patterns:
      - pattern-either:
          - pattern: new AesGcm($KEY)
          - pattern: |
              using ($AESGCM = new AesGcm($KEY)) {
                $AESGCM.Encrypt($NONCE, $PLAINTEXT, $CIPHERTEXT, $TAG, $ADDITIONAL_DATA);
              }
          - pattern: |
              $AESGCM = new AesGcm($KEY);
              $AESGCM.Encrypt($NONCE, $PLAINTEXT, $CIPHERTEXT, $TAG, $ADDITIONAL_DATA);
          - pattern: |
              using ($AESGCM = new AesGcm($KEY)) {
                $AESGCM.Decrypt($NONCE, $CIPHERTEXT, $TAG, $PLAINTEXT, $ADDITIONAL_DATA);
              }
          - pattern: |
              $AESGCM = new AesGcm($KEY);
              $AESGCM.Decrypt($NONCE, $CIPHERTEXT, $TAG, $PLAINTEXT, $ADDITIONAL_DATA);
          - pattern: $AESGCM.Encrypt($NONCE, $PLAINTEXT, $CIPHERTEXT, $TAG, $ADDITIONAL_DATA)
          - pattern: $AESGCM.Decrypt($NONCE, $CIPHERTEXT, $TAG, $PLAINTEXT, $ADDITIONAL_DATA)
    pattern-not-inside:
      - pattern: |
          [Test]
          public void $NAME() {
            ...
          }
      - pattern: |
          [Fact]
          public void $NAME() {
            ...
          }
      - pattern: |
          [Theory]
          public void $NAME() {
            ...
          }
      - pattern: |
          // $COMMENT
      - pattern: |
          /* $COMMENT */
      - pattern: |
          /// $DOCSTRING
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: AES-GCM AEAD mode usage detected in codebase"
  - id: csharp-crypto-random-generation
    message: Random number generation for cryptographic use detected
    severity: INFO
    languages:
      - csharp
    focus-metavariable: $BYTES
    patterns:
      - pattern-either:
          - pattern: RandomNumberGenerator.Create()
          - pattern: new RNGCryptoServiceProvider()
          - pattern: |
              using ($RNG = RandomNumberGenerator.Create()) {
                $BYTES = new byte[$LENGTH];
                $RNG.GetBytes($BYTES);
              }
          - pattern: RandomNumberGenerator.Fill($BYTES)
    pattern-not-inside:
      - pattern: |
          [Test]
          public void $NAME() {
            ...
          }
      - pattern: |
          [Fact]
          public void $NAME() {
            ...
          }
      - pattern: |
          [Theory]
          public void $NAME() {
            ...
          }
      - pattern: |
          // $COMMENT
      - pattern: |
          /* $COMMENT */
      - pattern: |
          /// $DOCSTRING
    metadata:
      category: crypto
      cwe: CWE-338
      impact:
        "Inventory: Random number generation for cryptographic use detected in
        codebase"
  - id: csharp-crypto-key-length
    message: Cryptographic key length usage detected
    severity: INFO
    languages:
      - csharp
    focus-metavariable: $SIZE
    patterns:
      - pattern-either:
          - pattern: |
              $KEY = new byte[$SIZE];
              $CIPHER.Key = $KEY;
          - pattern: |
              $KEY = new byte[8];
              $CIPHER.Key = $KEY;
          - pattern: |
              $KEY = new byte[16];
              $CIPHER.Key = $KEY;
          - pattern: |
              $KEY = new byte[24];
              $CIPHER.Key = $KEY;
          - pattern: |
              $KEY = new byte[32];
              $CIPHER.Key = $KEY;
          - pattern: $CIPHER.KeySize = $SIZE
          - patterns:
              - pattern: $CIPHER.Key = new byte[$SIZE]
              - metavariable-regex:
                  metavariable: $SIZE
                  regex: \d+
          - patterns:
              - pattern: $CIPHER.Key = new byte[$SIZE]
              - metavariable-comparison:
                  metavariable: $SIZE
                  comparison: $SIZE < 16
          - patterns:
              - pattern: $CIPHER.KeySize = $SIZE
              - metavariable-comparison:
                  metavariable: $SIZE
                  comparison: $SIZE < 128
    pattern-not-inside:
      - pattern: |
          [Test]
          public void $NAME() {
            ...
          }
      - pattern: |
          [Fact]
          public void $NAME() {
            ...
          }
      - pattern: |
          [Theory]
          public void $NAME() {
            ...
          }
      - pattern: |
          // $COMMENT
      - pattern: |
          /* $COMMENT */
      - pattern: |
          /// $DOCSTRING
    metadata:
      category: crypto
      cwe: CWE-326
      impact: "Inventory: Cryptographic key length usage detected in codebase"
  - id: csharp-crypto-cipher-aes
    message: AES cipher usage detected
    severity: INFO
    languages:
      - csharp
    focus-metavariable: $KEY
    patterns:
      - pattern-either:
          - pattern: Aes.Create()
          - pattern: Aes.Create($ALGORITHM_NAME)
          - pattern: new AesCryptoServiceProvider()
          - pattern: AesManaged()
          - pattern: new AesManaged()
          - pattern: AesCng()
          - pattern: new AesCng()
          - pattern: |
              using ($CIPHER = Aes.Create()) {
                $CIPHER.Key = $KEY;
                $CIPHER.Mode = CipherMode.$MODE;
                $ENCRYPTOR = $CIPHER.CreateEncryptor();
                $CIPHERTEXT = $ENCRYPTOR.TransformFinalBlock($PLAINTEXT, 0, $PLAINTEXT.Length);
              }
          - pattern: |
              $CIPHER = Aes.Create();
              $CIPHER.KeySize = 128;
          - pattern: |
              $CIPHER = Aes.Create();
              $CIPHER.KeySize = 192;
          - pattern: |
              $CIPHER = Aes.Create();
              $CIPHER.KeySize = 256;
          - pattern: $CIPHER.KeySize = 128
          - pattern: $CIPHER.KeySize = 192
          - pattern: $CIPHER.KeySize = 256
          - patterns:
              - pattern: $CIPHER.KeySize = $SIZE
              - metavariable-comparison:
                  metavariable: $SIZE
                  comparison: $SIZE < 128
          - pattern: await $CIPHER.EncryptAsync($DATA)
          - pattern: await $CIPHER.DecryptAsync($CIPHERTEXT)
    pattern-not-inside:
      - pattern: |
          [Test]
          public void $NAME() {
            ...
          }
      - pattern: |
          [Fact]
          public void $NAME() {
            ...
          }
      - pattern: |
          [Theory]
          public void $NAME() {
            ...
          }
      - pattern: |
          // $COMMENT
      - pattern: |
          /* $COMMENT */
      - pattern: |
          /// $DOCSTRING
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: AES cipher usage detected in codebase"
  - id: csharp-crypto-sp800108
    message: SP800108DeriveBytes key derivation function usage detected
    severity: INFO
    languages:
      - csharp
    focus-metavariable: $KEY
    patterns:
      - pattern-either:
          - pattern: new SP800108DeriveBytes($KEY, $LABEL, $CONTEXT, $HASH_ALGORITHM)
          - pattern: |
              using ($KDF = new SP800108DeriveBytes($KEY, $LABEL, $CONTEXT, $HASH_ALGORITHM)) {
                $DERIVED_KEY = $KDF.GetBytes($KEYLEN);
              }
          - pattern: |
              $KDF = new SP800108DeriveBytes($KEY, $LABEL, $CONTEXT, $HASH_ALGORITHM);
              $DERIVED_KEY = $KDF.GetBytes($KEYLEN);
    pattern-not-inside:
      - pattern: |
          [Test]
          public void $NAME() {
            ...
          }
      - pattern: |
          [Fact]
          public void $NAME() {
            ...
          }
      - pattern: |
          [Theory]
          public void $NAME() {
            ...
          }
      - pattern: |
          // $COMMENT
      - pattern: |
          /* $COMMENT */
      - pattern: |
          /// $DOCSTRING
    metadata:
      category: crypto
      cwe: CWE-326
      impact:
        "Inventory: SP800108DeriveBytes key derivation function usage detected
        in codebase"
  - id: csharp-crypto-rsa
    message: RSA cryptographic operations detected
    severity: INFO
    languages:
      - csharp
    focus-metavariable: $BITS
    patterns:
      - pattern-either:
          - pattern: RSA.Create($BITS)
          - pattern: new RSACryptoServiceProvider($BITS)
          - pattern: |
              using ($RSA = RSA.Create($BITS)) {
                $PUBLIC_KEY = $RSA.ExportParameters(false);
                $PRIVATE_KEY = $RSA.ExportParameters(true);
              }
          - patterns:
              - pattern: RSA.Create($BITS)
              - metavariable-comparison:
                  metavariable: $BITS
                  comparison: $BITS < 2048
          - pattern: $RSA.Encrypt($DATA, $PADDING)
          - pattern: $RSA.Decrypt($CIPHERTEXT, $PADDING)
          - pattern: $RSA.ExportParameters($INCLUDE_PRIVATE)
          - pattern: $RSA.ImportParameters($PARAMETERS)
          - pattern: $RSA.ExportRSAPublicKey()
          - pattern: $RSA.ExportRSAPrivateKey()
          - pattern: $RSA.ImportRSAPublicKey($KEY_DATA)
          - pattern: $RSA.ImportRSAPrivateKey($KEY_DATA)
    pattern-not-inside:
      - pattern: |
          [Test]
          public void $NAME() {
            ...
          }
      - pattern: |
          [Fact]
          public void $NAME() {
            ...
          }
      - pattern: |
          [Theory]
          public void $NAME() {
            ...
          }
      - pattern: |
          // $COMMENT
      - pattern: |
          /* $COMMENT */
      - pattern: |
          /// $DOCSTRING
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: RSA cryptographic operations detected in codebase"
  - id: csharp-crypto-sha512
    message: SHA512 hash function usage detected
    severity: INFO
    languages:
      - csharp
    focus-metavariable: $DATA
    patterns:
      - pattern-either:
          - pattern: SHA512.Create()
          - pattern: new SHA512CryptoServiceProvider()
          - pattern: SHA512Managed()
          - pattern: new SHA512Managed()
          - pattern: SHA512Cng()
          - pattern: new SHA512Cng()
          - pattern: |
              using ($HASHER = SHA512.Create()) {
                $BYTES = $HASHER.ComputeHash($DATA);
              }
          - pattern: |
              $HASHER = SHA512.Create();
              $HASH = $HASHER.ComputeHash($DATA);
          - pattern: |
              SHA512 $HASHER = SHA512.Create();
              $HASH = $HASHER.ComputeHash($DATA);
    pattern-not-inside:
      - pattern: |
          [Test]
          public void $NAME() {
            ...
          }
      - pattern: |
          [Fact]
          public void $NAME() {
            ...
          }
      - pattern: |
          [Theory]
          public void $NAME() {
            ...
          }
      - pattern: |
          // $COMMENT
      - pattern: |
          /* $COMMENT */
      - pattern: |
          /// $DOCSTRING
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: SHA512 hash function usage detected in codebase"
  - id: csharp-crypto-tls-version
    message: TLS version configuration detected
    severity: INFO
    languages:
      - csharp
    focus-metavariable: $VERSION
    patterns:
      - pattern-either:
          - pattern: SecurityProtocolType.Ssl3
          - pattern: SecurityProtocolType.Tls
          - pattern: SecurityProtocolType.Tls11
          - pattern: SecurityProtocolType.Tls12
          - pattern: SecurityProtocolType.Tls13
          - pattern: ServicePointManager.SecurityProtocol = SecurityProtocolType.$VERSION
          - pattern: |
              ServicePointManager.SecurityProtocol = SecurityProtocolType.Tls12 | SecurityProtocolType.Tls13;
          - pattern: SslStream($STREAM, false, $VALIDATION_CALLBACK, $SELECTION_CALLBACK)
          - pattern: new SslStream($STREAM, false, $VALIDATION_CALLBACK)
          - pattern: $HANDLER.SslProtocols = SslProtocols.$PROTOCOL
          - pattern: HttpClientHandler.SslProtocols
    pattern-not-inside:
      - pattern: |
          [Test]
          public void $NAME() {
            ...
          }
      - pattern: |
          [Fact]
          public void $NAME() {
            ...
          }
      - pattern: |
          [Theory]
          public void $NAME() {
            ...
          }
      - pattern: |
          // $COMMENT
      - pattern: |
          /* $COMMENT */
      - pattern: |
          /// $DOCSTRING
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: TLS version configuration detected in codebase"
  - id: csharp-crypto-md5
    message: MD5 hash function usage detected
    severity: INFO
    languages:
      - csharp
    focus-metavariable: $DATA
    patterns:
      - pattern-either:
          - pattern: MD5.Create()
          - pattern: new MD5CryptoServiceProvider()
          - pattern: MD5Managed()
          - pattern: new MD5Managed()
          - pattern: MD5Cng()
          - pattern: new MD5Cng()
          - pattern: |
              using ($HASHER = MD5.Create()) {
                $BYTES = $HASHER.ComputeHash($DATA);
              }
          - pattern: |
              $HASHER = MD5.Create();
              $HASH = $HASHER.ComputeHash($DATA);
          - pattern: |
              MD5 $HASHER = MD5.Create();
              $HASH = $HASHER.ComputeHash($DATA);
          - pattern: await $HASHER.ComputeHashAsync($DATA)
    pattern-not-inside:
      - pattern: |
          [Test]
          public void $NAME() {
            ...
          }
      - pattern: |
          [Fact]
          public void $NAME() {
            ...
          }
      - pattern: |
          [Theory]
          public void $NAME() {
            ...
          }
      - pattern: |
          // $COMMENT
      - pattern: |
          /* $COMMENT */
      - pattern: |
          /// $DOCSTRING
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: MD5 hash function usage detected in codebase"
  - id: csharp-crypto-ecdsa
    message: ECDSA cryptographic operations detected
    severity: INFO
    languages:
      - csharp
    focus-metavariable: $DATA
    patterns:
      - pattern-either:
          - pattern: ECDsa.Create($CURVE)
          - pattern: new ECDsaCng($CURVE)
          - pattern: |
              using ($ECDSA = ECDsa.Create($CURVE)) {
                $SIGNATURE = $ECDSA.SignData($DATA, $HASH_ALGORITHM);
              }
          - pattern: |
              $ECDSA = ECDsa.Create($CURVE);
              $SIGNATURE = $ECDSA.SignData($DATA, $HASH_ALGORITHM);
              $VERIFIED = $ECDSA.VerifyData($DATA, $SIGNATURE, $HASH_ALGORITHM);
          - pattern: $ECDSA.SignData($DATA, $HASH_ALGORITHM)
          - pattern: $ECDSA.VerifyData($DATA, $SIGNATURE, $HASH_ALGORITHM)
          - pattern: ECCurve.NamedCurves.nistP256
          - pattern: ECCurve.NamedCurves.nistP384
          - pattern: ECCurve.NamedCurves.nistP521
    pattern-not-inside:
      - pattern: |
          [Test]
          public void $NAME() {
            ...
          }
      - pattern: |
          [Fact]
          public void $NAME() {
            ...
          }
      - pattern: |
          [Theory]
          public void $NAME() {
            ...
          }
      - pattern: |
          // $COMMENT
      - pattern: |
          /* $COMMENT */
      - pattern: |
          /// $DOCSTRING
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: ECDSA cryptographic operations detected in codebase"
  - id: csharp-crypto-iv-nonce
    message: Initialization vector (IV) or nonce usage detected
    severity: INFO
    languages:
      - csharp
    focus-metavariable: $IV
    patterns:
      - pattern-either:
          - pattern: $CIPHER.IV = $IV
          - pattern: $CIPHER.IV = Encoding.UTF8.GetBytes("$STATIC_IV")
          - pattern: |
              $CIPHER.IV = new byte[$SIZE];
              $CIPHER.CreateEncryptor();
          - pattern: |
              $CIPHER.IV = Encoding.UTF8.GetBytes("$STATIC_VALUE");
              $ENCRYPTOR = $CIPHER.CreateEncryptor();
          - pattern: |
              using ($CIPHER = Aes.Create()) {
                $CIPHER.IV = $IV;
                $ENCRYPTOR = $CIPHER.CreateEncryptor();
              }
          - pattern: $GCM.Encrypt($NONCE, $PLAINTEXT, $ADDITIONAL_DATA)
          - pattern: $GCM.Decrypt($NONCE, $CIPHERTEXT, $ADDITIONAL_DATA)
    pattern-not-inside:
      - pattern: |
          [Test]
          public void $NAME() {
            ...
          }
      - pattern: |
          [Fact]
          public void $NAME() {
            ...
          }
      - pattern: |
          [Theory]
          public void $NAME() {
            ...
          }
      - pattern: |
          // $COMMENT
      - pattern: |
          /* $COMMENT */
      - pattern: |
          /// $DOCSTRING
    metadata:
      category: crypto
      cwe: CWE-329
      impact: "Inventory: Initialization vector (IV) or nonce usage detected in codebase"
  - id: csharp-crypto-chacha20poly1305
    message: ChaCha20-Poly1305 AEAD mode usage detected
    severity: INFO
    languages:
      - csharp
    focus-metavariable: $KEY
    patterns:
      - pattern-either:
          - pattern: new ChaCha20Poly1305($KEY)
          - pattern: |
              using ($CHACHA = new ChaCha20Poly1305($KEY)) {
                $CHACHA.Encrypt($NONCE, $PLAINTEXT, $CIPHERTEXT, $TAG, $ADDITIONAL_DATA);
              }
          - pattern: |
              $CHACHA = new ChaCha20Poly1305($KEY);
              $CHACHA.Encrypt($NONCE, $PLAINTEXT, $CIPHERTEXT, $TAG, $ADDITIONAL_DATA);
          - pattern: |
              using ($CHACHA = new ChaCha20Poly1305($KEY)) {
                $CHACHA.Decrypt($NONCE, $CIPHERTEXT, $TAG, $PLAINTEXT, $ADDITIONAL_DATA);
              }
          - pattern: |
              $CHACHA = new ChaCha20Poly1305($KEY);
              $CHACHA.Decrypt($NONCE, $CIPHERTEXT, $TAG, $PLAINTEXT, $ADDITIONAL_DATA);
          - pattern: $CHACHA.Encrypt($NONCE, $PLAINTEXT, $CIPHERTEXT, $TAG, $ADDITIONAL_DATA)
          - pattern: $CHACHA.Decrypt($NONCE, $CIPHERTEXT, $TAG, $PLAINTEXT, $ADDITIONAL_DATA)
    pattern-not-inside:
      - pattern: |
          [Test]
          public void $NAME() {
            ...
          }
      - pattern: |
          [Fact]
          public void $NAME() {
            ...
          }
      - pattern: |
          [Theory]
          public void $NAME() {
            ...
          }
      - pattern: |
          // $COMMENT
      - pattern: |
          /* $COMMENT */
      - pattern: |
          /// $DOCSTRING
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: ChaCha20-Poly1305 AEAD mode usage detected in codebase"
  - id: csharp-crypto-key-derivation
    message: Key derivation function usage detected
    severity: INFO
    languages:
      - csharp
    focus-metavariable: $PASSWORD
    patterns:
      - pattern-either:
          - pattern: new Rfc2898DeriveBytes($PASSWORD, $SALT, $ITER)
          - pattern: new Rfc2898DeriveBytes($PASSWORD, $SALT, $ITER, HashAlgorithmName.$ALGO)
          - pattern: |
              using ($KDF = new Rfc2898DeriveBytes($PASSWORD, $SALT, $ITER)) {
                $KEY = $KDF.GetBytes($KEYLEN);
              }
    pattern-not-inside:
      - pattern: |
          [Test]
          public void $NAME() {
            ...
          }
      - pattern: |
          [Fact]
          public void $NAME() {
            ...
          }
      - pattern: |
          [Theory]
          public void $NAME() {
            ...
          }
      - pattern: |
          // $COMMENT
      - pattern: |
          /* $COMMENT */
      - pattern: |
          /// $DOCSTRING
    metadata:
      category: crypto
      cwe: CWE-326
      impact: "Inventory: Key derivation function usage detected in codebase"
  - id: csharp-crypto-digital-signatures
    message: Digital signature operations detected
    severity: INFO
    languages:
      - csharp
    focus-metavariable: $DATA
    patterns:
      - pattern-either:
          - pattern: $RSA.SignData($DATA, $HASH_ALGORITHM, $PADDING)
          - pattern: $RSA.VerifyData($DATA, $SIGNATURE, $HASH_ALGORITHM, $PADDING)
          - pattern: $ECDSA.SignData($DATA, $HASH_ALGORITHM)
          - pattern: $ECDSA.VerifyData($DATA, $SIGNATURE, $HASH_ALGORITHM)
          - pattern: $DSA.CreateSignature($HASH)
          - pattern: $DSA.VerifySignature($HASH, $SIGNATURE)
          - pattern: |
              using ($RSA = RSA.Create($BITS)) {
                $SIGNATURE = $RSA.SignData($DATA, $HASH_ALGORITHM, $PADDING);
              }
          - pattern: |
              using ($ECDSA = ECDsa.Create($CURVE)) {
                $SIGNATURE = $ECDSA.SignData($DATA, $HASH_ALGORITHM);
              }
          - pattern: $RSA.SignHash($HASH, $HASH_ALGORITHM, $PADDING)
          - pattern: $RSA.VerifyHash($HASH, $SIGNATURE, $HASH_ALGORITHM, $PADDING)
          - pattern: $ECDSA.SignHash($HASH)
          - pattern: $ECDSA.VerifyHash($HASH, $SIGNATURE)
          - pattern: $DSA.SignHash($HASH)
          - pattern: $DSA.VerifyHash($HASH, $SIGNATURE)
          - pattern: await $RSA.SignDataAsync($DATA, $HASH_ALGORITHM, $PADDING)
          - pattern: await $RSA.VerifyDataAsync($DATA, $SIGNATURE, $HASH_ALGORITHM, $PADDING)
          - pattern: await $ECDSA.SignDataAsync($DATA, $HASH_ALGORITHM)
          - pattern: await $ECDSA.VerifyDataAsync($DATA, $SIGNATURE, $HASH_ALGORITHM)
    pattern-not-inside:
      - pattern: |
          [Test]
          public void $NAME() {
            ...
          }
      - pattern: |
          [Fact]
          public void $NAME() {
            ...
          }
      - pattern: |
          [Theory]
          public void $NAME() {
            ...
          }
      - pattern: |
          // $COMMENT
      - pattern: |
          /* $COMMENT */
      - pattern: |
          /// $DOCSTRING
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: Digital signature operations detected in codebase"
  - id: csharp-crypto-sha256
    message: SHA256 hash function usage detected
    severity: INFO
    languages:
      - csharp
    focus-metavariable: $DATA
    patterns:
      - pattern-either:
          - pattern: SHA256.Create()
          - pattern: new SHA256CryptoServiceProvider()
          - pattern: SHA256Managed()
          - pattern: new SHA256Managed()
          - pattern: SHA256Cng()
          - pattern: new SHA256Cng()
          - pattern: |
              using ($HASHER = SHA256.Create()) {
                $BYTES = $HASHER.ComputeHash($DATA);
              }
          - pattern: |
              $HASHER = SHA256.Create();
              $HASH = $HASHER.ComputeHash($DATA);
          - pattern: |
              SHA256 $HASHER = SHA256.Create();
              $HASH = $HASHER.ComputeHash($DATA);
          - pattern: await $HASHER.ComputeHashAsync($DATA)
    pattern-not-inside:
      - pattern: |
          [Test]
          public void $NAME() {
            ...
          }
      - pattern: |
          [Fact]
          public void $NAME() {
            ...
          }
      - pattern: |
          [Theory]
          public void $NAME() {
            ...
          }
      - pattern: |
          // $COMMENT
      - pattern: |
          /* $COMMENT */
      - pattern: |
          /// $DOCSTRING
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: SHA256 hash function usage detected in codebase"
  - id: csharp-crypto-ripemd160
    message: RIPEMD160 hash function usage detected
    severity: INFO
    languages:
      - csharp
    focus-metavariable: $DATA
    patterns:
      - pattern-either:
          - pattern: RIPEMD160.Create()
          - pattern: RIPEMD160Managed()
          - pattern: new RIPEMD160Managed()
          - pattern: |
              using ($HASHER = RIPEMD160.Create()) {
                $BYTES = $HASHER.ComputeHash($DATA);
              }
          - pattern: |
              $HASHER = RIPEMD160.Create();
              $HASH = $HASHER.ComputeHash($DATA);
    pattern-not-inside:
      - pattern: |
          [Test]
          public void $NAME() {
            ...
          }
      - pattern: |
          [Fact]
          public void $NAME() {
            ...
          }
      - pattern: |
          [Theory]
          public void $NAME() {
            ...
          }
      - pattern: |
          // $COMMENT
      - pattern: |
          /* $COMMENT */
      - pattern: |
          /// $DOCSTRING
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: RIPEMD160 hash function usage detected in codebase"
  - id: csharp-crypto-diffie-hellman
    message: Diffie-Hellman key exchange usage detected
    severity: INFO
    languages:
      - csharp
    focus-metavariable: $PUBLIC_KEY
    patterns:
      - pattern-either:
          - pattern: ECDiffieHellman.Create($CURVE)
          - pattern: new ECDiffieHellmanCng($CURVE)
          - pattern: |
              using ($ALICE = ECDiffieHellman.Create($CURVE)) {
                $PUBLIC_KEY = $ALICE.PublicKey;
              }
          - pattern: |
              $ALICE = ECDiffieHellman.Create($CURVE);
              $BOB = ECDiffieHellman.Create($CURVE);
              $SHARED_SECRET = $ALICE.DeriveKeyMaterial($BOB.PublicKey);
          - pattern: $ECDH.DeriveKeyMaterial($PUBLIC_KEY)
          - pattern: ECDiffieHellmanCng()
    pattern-not-inside:
      - pattern: |
          [Test]
          public void $NAME() {
            ...
          }
      - pattern: |
          [Fact]
          public void $NAME() {
            ...
          }
      - pattern: |
          [Theory]
          public void $NAME() {
            ...
          }
      - pattern: |
          // $COMMENT
      - pattern: |
          /* $COMMENT */
      - pattern: |
          /// $DOCSTRING
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: Diffie-Hellman key exchange usage detected in codebase"
  - id: csharp-crypto-hardcoded-key
    message: Hardcoded cryptographic key detected
    severity: INFO
    languages:
      - csharp
    mode: taint
    pattern-sources:
      - pattern: |
          string $KEY = "$VALUE";
      - pattern: |
          private static readonly byte[] $KEY = Encoding.UTF8.GetBytes("$VALUE");
      - pattern: |
          const string $KEY = "$VALUE";
      - pattern: |
          private byte[] $KEY = Encoding.UTF8.GetBytes("$VALUE");
      - pattern: |
          $KEY = "$VALUE";
      - pattern: |
          $KEY = Encoding.UTF8.GetBytes("$VALUE");
    pattern-sinks:
      - pattern: $CIPHER.Key = Encoding.UTF8.GetBytes($KEY)
      - pattern: $CIPHER.Key = $KEY
      - pattern: new AesGcm($KEY)
      - pattern: new ChaCha20Poly1305($KEY)
      - pattern: new HMACSHA256($KEY)
      - pattern: new HMACSHA1($KEY)
      - pattern: new HMACSHA512($KEY)
      - pattern: new HMACMD5($KEY)
      - pattern: $HMAC.Key = $KEY
      - pattern: $CIPHER.Key = new byte[$SIZE]
    metavariable-propagator:
      metavariable: $KEY
      from: $KEY = $VALUE
      to: $KEY
    pattern-not-inside:
      - pattern: |
          [Test]
          public void $NAME() {
            ...
          }
      - pattern: |
          [Fact]
          public void $NAME() {
            ...
          }
      - pattern: |
          [Theory]
          public void $NAME() {
            ...
          }
      - pattern: |
          // $COMMENT
      - pattern: |
          /* $COMMENT */
      - pattern: |
          /// $DOCSTRING
    metadata:
      category: crypto
      cwe: CWE-798
      impact: "Inventory: Hardcoded cryptographic key detected in codebase"
  - id: csharp-crypto-cipher-modes
    message: Cipher mode usage detected
    severity: INFO
    languages:
      - csharp
    focus-metavariable: $MODE
    patterns:
      - pattern-either:
          - pattern: CipherMode.CBC
          - pattern: CipherMode.CFB
          - pattern: CipherMode.CTS
          - pattern: CipherMode.ECB
          - pattern: CipherMode.OFB
          - pattern: CipherMode.CTS
          - pattern: |
              $CIPHER.Mode = CipherMode.CBC;
              $ENCRYPTOR = $CIPHER.CreateEncryptor();
          - pattern: |
              $CIPHER.Mode = CipherMode.CFB;
              $ENCRYPTOR = $CIPHER.CreateEncryptor();
          - pattern: |
              $CIPHER.Mode = CipherMode.ECB;
              $ENCRYPTOR = $CIPHER.CreateEncryptor();
          - pattern: |
              $CIPHER.Mode = CipherMode.OFB;
              $ENCRYPTOR = $CIPHER.CreateEncryptor();
    pattern-not-inside:
      - pattern: |
          [Test]
          public void $NAME() {
            ...
          }
      - pattern: |
          [Fact]
          public void $NAME() {
            ...
          }
      - pattern: |
          [Theory]
          public void $NAME() {
            ...
          }
      - pattern: |
          // $COMMENT
      - pattern: |
          /* $COMMENT */
      - pattern: |
          /// $DOCSTRING
    metadata:
      category: crypto
      cwe: CWE-327
      impact:
        "Inventory: Cipher mode usage detected in codebase (CBC, CFB, ECB, OFB,
        CTS)"
  - id: csharp-crypto-sha384
    message: SHA384 hash function usage detected
    severity: INFO
    languages:
      - csharp
    focus-metavariable: $DATA
    patterns:
      - pattern-either:
          - pattern: SHA384.Create()
          - pattern: new SHA384CryptoServiceProvider()
          - pattern: |
              using ($HASHER = SHA384.Create()) {
                $BYTES = $HASHER.ComputeHash($DATA);
              }
          - pattern: |
              $HASHER = SHA384.Create();
              $HASH = $HASHER.ComputeHash($DATA);
          - pattern: SHA384Managed()
          - pattern: new SHA384Managed()
          - pattern: SHA384Cng()
          - pattern: new SHA384Cng()
    pattern-not-inside:
      - pattern: |
          [Test]
          public void $NAME() {
            ...
          }
      - pattern: |
          [Fact]
          public void $NAME() {
            ...
          }
      - pattern: |
          [Theory]
          public void $NAME() {
            ...
          }
      - pattern: |
          // $COMMENT
      - pattern: |
          /* $COMMENT */
      - pattern: |
          /// $DOCSTRING
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: SHA384 hash function usage detected in codebase"
  - id: csharp-crypto-cipher-rc4
    message: RC4 stream cipher usage detected
    severity: INFO
    languages:
      - csharp
    focus-metavariable: $KEY
    patterns:
      - pattern-either:
          - pattern: RC4CryptoServiceProvider()
          - pattern: new RC4CryptoServiceProvider()
          - pattern: |
              using ($RC4 = new RC4CryptoServiceProvider()) {
                $RC4.Key = $KEY;
                $ENCRYPTOR = $RC4.CreateEncryptor();
              }
          - pattern: |
              $RC4 = new RC4CryptoServiceProvider();
              $RC4.Key = $KEY;
              $CIPHERTEXT = $RC4.TransformFinalBlock($PLAINTEXT, 0, $PLAINTEXT.Length);
    pattern-not-inside:
      - pattern: |
          [Test]
          public void $NAME() {
            ...
          }
      - pattern: |
          [Fact]
          public void $NAME() {
            ...
          }
      - pattern: |
          [Theory]
          public void $NAME() {
            ...
          }
      - pattern: |
          // $COMMENT
      - pattern: |
          /* $COMMENT */
      - pattern: |
          /// $DOCSTRING
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: RC4 stream cipher usage detected in codebase"
  - id: csharp-crypto-salt-generation
    message: Salt generation for cryptographic use detected
    severity: INFO
    languages:
      - csharp
    focus-metavariable: $SALT
    patterns:
      - pattern-either:
          - pattern: RandomNumberGenerator.Fill($SALT)
          - pattern: |
              $SALT = new byte[$SIZE];
              RandomNumberGenerator.Fill($SALT);
          - pattern: |
              RandomNumberGenerator $RNG = RandomNumberGenerator.Create();
              $SALT = new byte[$SIZE];
              $RNG.GetBytes($SALT);
          - pattern: |
              using (RandomNumberGenerator $RNG = RandomNumberGenerator.Create()) {
                $SALT = new byte[$SIZE];
                $RNG.GetBytes($SALT);
              }
          - patterns:
              - pattern: |
                  $SALT = new byte[$SIZE];
                  RandomNumberGenerator.Fill($SALT);
              - metavariable-comparison:
                  metavariable: $SIZE
                  comparison: $SIZE < 16
          - patterns:
              - pattern: |
                  RandomNumberGenerator $RNG = RandomNumberGenerator.Create();
                  $SALT = new byte[$SIZE];
                  $RNG.GetBytes($SALT);
              - metavariable-comparison:
                  metavariable: $SIZE
                  comparison: $SIZE < 16
    pattern-not-inside:
      - pattern: |
          [Test]
          public void $NAME() {
            ...
          }
      - pattern: |
          [Fact]
          public void $NAME() {
            ...
          }
      - pattern: |
          [Theory]
          public void $NAME() {
            ...
          }
      - pattern: |
          // $COMMENT
      - pattern: |
          /* $COMMENT */
      - pattern: |
          /// $DOCSTRING
    metadata:
      category: crypto
      cwe: CWE-759
      impact: "Inventory: Salt generation for cryptographic use detected in codebase"
  - id: csharp-crypto-rc2
    message: RC2 cipher usage detected
    severity: INFO
    languages:
      - csharp
    focus-metavariable: $KEY
    patterns:
      - pattern-either:
          - pattern: RC2.Create()
          - pattern: new RC2CryptoServiceProvider()
          - pattern: RC2Managed()
          - pattern: new RC2Managed()
          - pattern: |
              using ($CIPHER = RC2.Create()) {
                $CIPHER.Key = $KEY;
                $CIPHER.IV = $IV;
                $ENCRYPTOR = $CIPHER.CreateEncryptor();
                $CIPHERTEXT = $ENCRYPTOR.TransformFinalBlock($PLAINTEXT, 0, $PLAINTEXT.Length);
              }
    pattern-not-inside:
      - pattern: |
          [Test]
          public void $NAME() {
            ...
          }
      - pattern: |
          [Fact]
          public void $NAME() {
            ...
          }
      - pattern: |
          [Theory]
          public void $NAME() {
            ...
          }
      - pattern: |
          // $COMMENT
      - pattern: |
          /* $COMMENT */
      - pattern: |
          /// $DOCSTRING
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: RC2 cipher usage detected in codebase"
  - id: csharp-crypto-tls-cipher-suites
    message: TLS cipher suite configuration detected
    severity: INFO
    languages:
      - csharp
    focus-metavariable: $SUITES
    patterns:
      - pattern-either:
          - pattern: CipherSuitesPolicy($SUITES)
          - pattern: new CipherSuitesPolicy($SUITES)
          - pattern: |
              $CONFIG.CipherSuitesPolicy = new CipherSuitesPolicy($SUITES);
          - pattern: TlsCipherSuite.TLS_AES_256_GCM_SHA384
          - pattern: TlsCipherSuite.TLS_AES_128_GCM_SHA256
          - pattern: TlsCipherSuite.TLS_CHACHA20_POLY1305_SHA256
          - pattern: TlsCipherSuite.TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384
          - pattern: TlsCipherSuite.TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384
    pattern-not-inside:
      - pattern: |
          [Test]
          public void $NAME() {
            ...
          }
      - pattern: |
          [Fact]
          public void $NAME() {
            ...
          }
      - pattern: |
          [Theory]
          public void $NAME() {
            ...
          }
      - pattern: |
          // $COMMENT
      - pattern: |
          /* $COMMENT */
      - pattern: |
          /// $DOCSTRING
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: TLS cipher suite configuration detected in codebase"
  - id: csharp-crypto-certificate-validation
    message: TLS certificate validation configuration detected
    severity: INFO
    languages:
      - csharp
    focus-metavariable: $CALLBACK
    patterns:
      - pattern-either:
          - pattern: ServicePointManager.ServerCertificateValidationCallback = $CALLBACK
          - pattern: ServicePointManager.ServerCertificateValidationCallback = null
          - pattern: |
              ServicePointManager.ServerCertificateValidationCallback =
                delegate { return true; };
          - pattern: |
              $HANDLER.ServerCertificateCustomValidationCallback =
                ($REQUEST, $CERT, $CHAIN, $ERRORS) => true;
          - pattern: |
              $HANDLER.ServerCertificateCustomValidationCallback =
                ($REQUEST, $CERT, $CHAIN, $ERRORS) => { return true; };
          - pattern: $HANDLER.ServerCertificateCustomValidationCallback
          - pattern: X509Certificate2.Verify()
          - pattern: $CERT.Verify()
          - pattern: $CHAIN.Build($CERT)
          - pattern: SslStream($STREAM, false, $VALIDATION_CALLBACK)
    pattern-not-inside:
      - pattern: |
          [Test]
          public void $NAME() {
            ...
          }
      - pattern: |
          [Fact]
          public void $NAME() {
            ...
          }
      - pattern: |
          [Theory]
          public void $NAME() {
            ...
          }
      - pattern: |
          // $COMMENT
      - pattern: |
          /* $COMMENT */
      - pattern: |
          /// $DOCSTRING
    metadata:
      category: crypto
      cwe: CWE-295
      impact: "Inventory: TLS certificate validation configuration detected in codebase"
  - id: csharp-crypto-hmac
    message: HMAC usage detected
    severity: INFO
    languages:
      - csharp
    focus-metavariable: $KEY
    patterns:
      - pattern-either:
          - pattern: HMAC.Create($ALGORITHM)
          - pattern: new HMACSHA1($KEY)
          - pattern: new HMACSHA256($KEY)
          - pattern: new HMACSHA384($KEY)
          - pattern: new HMACSHA512($KEY)
          - pattern: new HMACMD5($KEY)
          - pattern: |
              using ($HMAC = new HMACSHA256($KEY)) {
                $BYTES = $HMAC.ComputeHash($DATA);
              }
          - pattern: |
              $HMAC = new HMACSHA256($KEY);
              $HMAC.Key = $KEY;
              $RESULT = $HMAC.ComputeHash($DATA);
          - pattern: |
              $HMAC = HMAC.Create($ALGORITHM);
              $HMAC.Key = $KEY;
              $RESULT = $HMAC.ComputeHash($DATA);
          - pattern: |
              using ($HMAC = new HMACSHA512($KEY)) {
                $BYTES = $HMAC.ComputeHash($DATA);
              }
          - pattern: new HMACSHA3_256($KEY)
          - pattern: new HMACSHA3_512($KEY)
          - pattern: HMAC.Create("SHA3-256")
          - pattern: HMAC.Create("SHA3-512")
          - pattern: |
              $HMAC = HMAC.Create("SHA3-256");
              $HMAC.Key = $KEY;
              $RESULT = $HMAC.ComputeHash($DATA);
    pattern-not-inside:
      - pattern: |
          [Test]
          public void $NAME() {
            ...
          }
      - pattern: |
          [Fact]
          public void $NAME() {
            ...
          }
      - pattern: |
          [Theory]
          public void $NAME() {
            ...
          }
      - pattern: |
          // $COMMENT
      - pattern: |
          /* $COMMENT */
      - pattern: |
          /// $DOCSTRING
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: HMAC usage detected in codebase"
  - id: cpp-crypto-sha384
    message: SHA384 hash function usage detected
    severity: INFO
    languages:
      - cpp
    patterns:
      - pattern-either:
          - pattern: SHA384_Init($CTX)
          - pattern: SHA384_Update($CTX, $DATA, $LEN)
          - pattern: SHA384_Final($HASH, $CTX)
          - pattern: |
              SHA512_CTX $CTX;
              SHA384_Init(&$CTX);
              SHA384_Update(&$CTX, $DATA, $LEN);
              SHA384_Final($HASH, &$CTX);
          - pattern: EVP_DigestInit_ex($CTX, EVP_sha384(), $ENGINE)
          - pattern: EVP_Digest($DATA, $LEN, $HASH, $SIZE, EVP_sha384(), $ENGINE)
          - pattern: EVP_DigestUpdate($CTX, $DATA, $LEN)
          - pattern: EVP_DigestFinal_ex($CTX, $HASH, $HASHLEN)
          - pattern: EVP_MD_fetch($ENGINE, "SHA-384", $PROPS)
          - pattern: EVP_MD_fetch($ENGINE, "SHA384", $PROPS)
          - pattern: CryptoPP::SHA384()
          - pattern: Botan::HashFunction::create("SHA-384")
          - pattern: Botan::HashFunction::create("SHA384")
          - pattern: Botan::SHA_384()
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: SHA384 hash function usage detected in codebase"
  - id: cpp-crypto-cipher-blowfish
    message: Blowfish cipher usage detected
    severity: INFO
    languages:
      - cpp
    patterns:
      - pattern-either:
          - pattern: EVP_CipherInit_ex($CTX, EVP_bf_cbc(), $ENGINE, $KEY, $IV, $ENCRYPT)
          - pattern: EVP_CipherInit_ex($CTX, EVP_bf_ecb(), $ENGINE, $KEY, $IV, $ENCRYPT)
          - pattern: EVP_CipherInit_ex($CTX, EVP_bf_cfb(), $ENGINE, $KEY, $IV, $ENCRYPT)
          - pattern: EVP_CipherInit_ex($CTX, EVP_bf_ofb(), $ENGINE, $KEY, $IV, $ENCRYPT)
          - pattern: EVP_CIPHER_fetch($ENGINE, "BF-CBC", $PROPS)
          - pattern: EVP_CIPHER_fetch($ENGINE, "BF-ECB", $PROPS)
          - pattern: EVP_CIPHER_fetch($ENGINE, "BF-CFB", $PROPS)
          - pattern: EVP_CIPHER_fetch($ENGINE, "BF-OFB", $PROPS)
          - pattern: CryptoPP::Blowfish::Encryption($KEY, $KEYLEN)
          - pattern: CryptoPP::Blowfish::Decryption($KEY, $KEYLEN)
          - pattern: Botan::Cipher_Mode::create("Blowfish/CBC", Botan::ENCRYPTION)
          - pattern: Botan::Cipher_Mode::create("Blowfish/ECB", Botan::ENCRYPTION)
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: Blowfish cipher usage detected in codebase"
  - id: cpp-crypto-cipher-chacha20
    message: ChaCha20 cipher usage detected
    severity: INFO
    languages:
      - cpp
    patterns:
      - pattern-either:
          - pattern: EVP_CipherInit_ex($CTX, EVP_chacha20(), $ENGINE, $KEY, $IV, $ENCRYPT)
          - pattern:
              EVP_CipherInit_ex($CTX, EVP_chacha20_poly1305(), $ENGINE, $KEY, $IV,
              $ENCRYPT)
          - pattern: EVP_CIPHER_fetch($ENGINE, "ChaCha20", $PROPS)
          - pattern: EVP_CIPHER_fetch($ENGINE, "ChaCha20-Poly1305", $PROPS)
          - pattern: CryptoPP::ChaCha20::Encryption($KEY, $KEYLEN, $IV, $COUNTER)
          - pattern: CryptoPP::ChaCha20::Decryption($KEY, $KEYLEN, $IV, $COUNTER)
          - pattern: CryptoPP::ChaCha20Poly1305::Encryption($KEY, $KEYLEN)
          - pattern: CryptoPP::ChaCha20Poly1305::Decryption($KEY, $KEYLEN)
          - pattern: Botan::Cipher_Mode::create("ChaCha20", Botan::ENCRYPTION)
          - pattern: Botan::Cipher_Mode::create("ChaCha20Poly1305", Botan::ENCRYPTION)
          - pattern: Botan::StreamCipher::create("ChaCha(20)")
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: ChaCha20 cipher usage detected in codebase"
  - id: cpp-crypto-sha224
    message: SHA224 hash function usage detected
    severity: INFO
    languages:
      - cpp
    patterns:
      - pattern-either:
          - pattern: SHA224_Init($CTX)
          - pattern: SHA224_Update($CTX, $DATA, $LEN)
          - pattern: SHA224_Final($HASH, $CTX)
          - pattern: |
              SHA256_CTX $CTX;
              SHA224_Init(&$CTX);
              SHA224_Update(&$CTX, $DATA, $LEN);
              SHA224_Final($HASH, &$CTX);
          - pattern: EVP_DigestInit_ex($CTX, EVP_sha224(), $ENGINE)
          - pattern: EVP_Digest($DATA, $LEN, $HASH, $SIZE, EVP_sha224(), $ENGINE)
          - pattern: EVP_DigestUpdate($CTX, $DATA, $LEN)
          - pattern: EVP_DigestFinal_ex($CTX, $HASH, $HASHLEN)
          - pattern: EVP_MD_fetch($ENGINE, "SHA-224", $PROPS)
          - pattern: EVP_MD_fetch($ENGINE, "SHA224", $PROPS)
          - pattern: CryptoPP::SHA224()
          - pattern: Botan::HashFunction::create("SHA-224")
          - pattern: Botan::HashFunction::create("SHA224")
          - pattern: Botan::SHA_224()
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: SHA224 hash function usage detected in codebase"
  - id: cpp-crypto-md5
    message: MD5 hash function usage detected
    severity: INFO
    languages:
      - cpp
    patterns:
      - pattern-either:
          - pattern: MD5_Init($CTX)
          - pattern: MD5_Update($CTX, $DATA, $LEN)
          - pattern: MD5_Final($HASH, $CTX)
          - pattern: |
              MD5_CTX $CTX;
              MD5_Init(&$CTX);
              MD5_Update(&$CTX, $DATA, $LEN);
              MD5_Final($HASH, &$CTX);
          - pattern: EVP_DigestInit_ex($CTX, EVP_md5(), $ENGINE)
          - pattern: EVP_Digest($DATA, $LEN, $HASH, $SIZE, EVP_md5(), $ENGINE)
          - pattern: EVP_DigestUpdate($CTX, $DATA, $LEN)
          - pattern: EVP_DigestFinal_ex($CTX, $HASH, $HASHLEN)
          - pattern: EVP_MD_fetch($ENGINE, "MD5", $PROPS)
          - pattern: CryptoPP::Weak::MD5()
          - pattern: CryptoPP::MD5()
          - pattern: Botan::HashFunction::create("MD5")
          - pattern: Botan::MD5()
          - patterns:
              - metavariable-pattern:
                  metavariable: $HASH
                  pattern-either:
                    - pattern: CryptoPP::MD5()
                    - pattern: CryptoPP::Weak::MD5()
              - pattern: $HASH.Update($DATA, $LEN)
          - patterns:
              - metavariable-pattern:
                  metavariable: $HASH
                  pattern-either:
                    - pattern: CryptoPP::MD5()
                    - pattern: CryptoPP::Weak::MD5()
              - pattern: $HASH.Final($OUT)
          - patterns:
              - metavariable-pattern:
                  metavariable: $HASH
                  pattern-either:
                    - pattern: CryptoPP::MD5()
                    - pattern: CryptoPP::Weak::MD5()
              - pattern: $HASH.CalculateDigest($OUT, $DATA, $LEN)
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: MD5 hash function usage detected in codebase"
  - id: cpp-crypto-mbedtls
    message: mbedTLS cryptographic library usage detected
    severity: INFO
    languages:
      - cpp
    patterns:
      - pattern-either:
          - pattern: mbedtls_md5_init($CTX)
          - pattern: mbedtls_md5_update($CTX, $DATA, $LEN)
          - pattern: mbedtls_md5_finish($CTX, $HASH)
          - pattern: mbedtls_sha1_init($CTX)
          - pattern: mbedtls_sha1_update($CTX, $DATA, $LEN)
          - pattern: mbedtls_sha1_finish($CTX, $HASH)
          - pattern: mbedtls_sha256_init($CTX)
          - pattern: mbedtls_sha256_update($CTX, $DATA, $LEN)
          - pattern: mbedtls_sha256_finish($CTX, $HASH)
          - pattern: mbedtls_sha512_init($CTX)
          - pattern: mbedtls_sha512_update($CTX, $DATA, $LEN)
          - pattern: mbedtls_sha512_finish($CTX, $HASH)
          - pattern: mbedtls_aes_setkey_enc($CTX, $KEY, $BITS)
          - pattern: mbedtls_aes_setkey_dec($CTX, $KEY, $BITS)
          - pattern: mbedtls_aes_crypt_ecb($CTX, $MODE, $INPUT, $OUTPUT)
          - pattern: mbedtls_aes_crypt_cbc($CTX, $MODE, $LENGTH, $IV, $INPUT, $OUTPUT)
          - pattern: mbedtls_rsa_gen_key($RSA, $F_RNG, $PRNG, $N_BITS, $EXPONENT)
          - pattern: mbedtls_rsa_public($RSA, $INPUT, $OUTPUT)
          - pattern: mbedtls_rsa_private($RSA, $F_RNG, $PRNG, $INPUT, $OUTPUT)
          - pattern:
              mbedtls_rsa_pkcs1_sign($RSA, $F_RNG, $PRNG, $MODE, $HASH_ALG, $HASH_LEN,
              $HASH, $SIG)
          - pattern:
              mbedtls_rsa_pkcs1_verify($RSA, $F_RNG, $PRNG, $MODE, $HASH_ALG, $HASH_LEN,
              $HASH, $SIG)
          - pattern: mbedtls_ecdsa_sign($GRP, $R, $S, $D, $BUF, $BLEN, $F_RNG, $PRNG)
          - pattern: mbedtls_ecdsa_verify($GRP, $BUF, $BLEN, $Q, $R, $S)
          - pattern: mbedtls_entropy_init($CTX)
          - pattern: mbedtls_ctr_drbg_init($CTX)
          - pattern: mbedtls_ctr_drbg_seed($CTX, $F_ENTROPY, $P_ENTROPY, $CUSTOM, $LEN)
          - pattern: mbedtls_ctr_drbg_random($P_RNG, $OUTPUT, $OUTPUT_LEN)
          - pattern: mbedtls_hmac_drbg_init($CTX)
          - pattern:
              mbedtls_hmac_drbg_seed($CTX, $MD, $F_ENTROPY, $P_ENTROPY, $CUSTOM,
              $LEN)
          - pattern: mbedtls_gcm_init($CTX)
          - pattern: mbedtls_gcm_setkey($CTX, $CIPHER, $KEY, $KEYLEN)
          - pattern:
              mbedtls_gcm_crypt_and_tag($CTX, $MODE, $LENGTH, $IV, $IVLEN, $ADD,
              $ADDLEN, $INPUT, $OUTPUT, $TAGLEN, $TAG)
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: mbedTLS cryptographic library usage detected in codebase"
  - id: cpp-crypto-blake2
    message: BLAKE2 hash function usage detected
    severity: INFO
    languages:
      - cpp
    patterns:
      - pattern-either:
          - pattern: EVP_DigestInit_ex($CTX, EVP_blake2b512(), $ENGINE)
          - pattern: EVP_DigestInit_ex($CTX, EVP_blake2s256(), $ENGINE)
          - pattern: EVP_Digest($DATA, $LEN, $HASH, $SIZE, EVP_blake2b512(), $ENGINE)
          - pattern: EVP_Digest($DATA, $LEN, $HASH, $SIZE, EVP_blake2s256(), $ENGINE)
          - pattern: blake2b_init($STATE, $OUTLEN)
          - pattern: blake2b_update($STATE, $DATA, $DATALEN)
          - pattern: blake2b_final($STATE, $OUT, $OUTLEN)
          - pattern: blake2s_init($STATE, $OUTLEN)
          - pattern: blake2s_update($STATE, $DATA, $DATALEN)
          - pattern: blake2s_final($STATE, $OUT, $OUTLEN)
          - pattern: CryptoPP::BLAKE2b()
          - pattern: CryptoPP::BLAKE2s()
          - pattern: EVP_MD_fetch($ENGINE, "BLAKE2b512", $PROPS)
          - pattern: EVP_MD_fetch($ENGINE, "BLAKE2s256", $PROPS)
          - pattern: Botan::HashFunction::create("BLAKE2b(512)")
          - pattern: Botan::HashFunction::create("BLAKE2s(256)")
          - pattern: Botan::HashFunction::create("BLAKE2b(256)")
          - pattern: Botan::HashFunction::create("BLAKE2b(384)")
          - pattern: Botan::HashFunction::create("BLAKE2s(128)")
          - pattern: Botan::HashFunction::create("BLAKE2s(224)")
          - pattern: Botan::BLAKE2b($OUTLEN)
          - pattern: Botan::BLAKE2s($OUTLEN)
          - patterns:
              - metavariable-pattern:
                  metavariable: $HASH
                  pattern-either:
                    - pattern: CryptoPP::BLAKE2b()
                    - pattern: CryptoPP::BLAKE2s()
              - pattern: $HASH.Update($DATA, $LEN)
          - patterns:
              - metavariable-pattern:
                  metavariable: $HASH
                  pattern-either:
                    - pattern: CryptoPP::BLAKE2b()
                    - pattern: CryptoPP::BLAKE2s()
              - pattern: $HASH.Final($OUT)
          - patterns:
              - metavariable-pattern:
                  metavariable: $HASH
                  pattern-either:
                    - pattern: CryptoPP::BLAKE2b()
                    - pattern: CryptoPP::BLAKE2s()
              - pattern: $HASH.CalculateDigest($OUT, $DATA, $LEN)
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: BLAKE2 hash function usage detected in codebase"
  - id: cpp-crypto-botan
    message: Botan cryptographic library usage detected
    severity: INFO
    languages:
      - cpp
    patterns:
      - pattern-either:
          - patterns:
              - pattern: Botan::HashFunction::create($ALGO)
              - metavariable-regex:
                  metavariable: $ALGO
                  regex: '"[A-Z0-9_-]+"'
              - focus-metavariable: $ALGO
          - patterns:
              - pattern: Botan::Cipher_Mode::create($ALGO, Botan::ENCRYPTION)
              - metavariable-regex:
                  metavariable: $ALGO
                  regex: '"[A-Z0-9_/-]+"'
              - focus-metavariable: $ALGO
          - patterns:
              - pattern: Botan::Cipher_Mode::create($ALGO, Botan::DECRYPTION)
              - metavariable-regex:
                  metavariable: $ALGO
                  regex: '"[A-Z0-9_/-]+"'
              - focus-metavariable: $ALGO
          - pattern: Botan::RandomNumberGenerator::create($SOURCE)
          - pattern: Botan::PKCS11::PKCS11_RNG($SESSION)
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: Botan cryptographic library usage detected in codebase"
  - id: cpp-crypto-cipher-rc4
    message: RC4 cipher usage detected
    severity: INFO
    languages:
      - cpp
    patterns:
      - pattern-either:
          - pattern: RC4_set_key($KEY, $LEN, $DATA)
          - pattern: RC4($KEY, $LEN, $INPUT, $OUTPUT)
          - pattern: EVP_CipherInit_ex($CTX, EVP_rc4(), $ENGINE, $KEY, $IV, $ENCRYPT)
          - pattern: EVP_CipherInit_ex($CTX, EVP_rc4_40(), $ENGINE, $KEY, $IV, $ENCRYPT)
          - pattern: EVP_CIPHER_fetch($ENGINE, "RC4", $PROPS)
          - pattern: EVP_CIPHER_fetch($ENGINE, "RC4-40", $PROPS)
          - pattern: CryptoPP::ARC4 $VAR;
          - pattern: CryptoPP::ARC4 $VAR($KEY, $KEYLEN);
          - pattern: CryptoPP::ARC4::Encryption($KEY, $KEYLEN)
          - pattern: CryptoPP::ARC4::Decryption($KEY, $KEYLEN)
          - pattern: CryptoPP::Weak::ARC4 $VAR;
          - pattern: CryptoPP::Weak::ARC4 $VAR($KEY, $KEYLEN);
          - pattern: CryptoPP::Weak::ARC4::Encryption($KEY, $KEYLEN)
          - pattern: CryptoPP::Weak::ARC4::Decryption($KEY, $KEYLEN)
          - pattern: CryptoPP::ARCFour $VAR;
          - pattern: CryptoPP::ARCFour $VAR($KEY, $KEYLEN);
          - pattern: Botan::StreamCipher::create("RC4")
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: RC4 cipher usage detected in codebase"
  - id: cpp-crypto-cipher-modes
    message: Cipher mode usage detected
    severity: INFO
    languages:
      - cpp
    patterns:
      - pattern-either:
          - pattern: EVP_CipherInit_ex($CTX, EVP_aes_128_ecb(), $ENGINE, $KEY, $IV, $ENCRYPT)
          - pattern: EVP_CipherInit_ex($CTX, EVP_aes_256_ecb(), $ENGINE, $KEY, $IV, $ENCRYPT)
          - pattern: EVP_CipherInit_ex($CTX, EVP_aes_128_cbc(), $ENGINE, $KEY, $IV, $ENCRYPT)
          - pattern: EVP_CipherInit_ex($CTX, EVP_aes_256_cbc(), $ENGINE, $KEY, $IV, $ENCRYPT)
          - pattern: EVP_CipherInit_ex($CTX, EVP_aes_128_cfb(), $ENGINE, $KEY, $IV, $ENCRYPT)
          - pattern: EVP_CipherInit_ex($CTX, EVP_aes_256_cfb(), $ENGINE, $KEY, $IV, $ENCRYPT)
          - pattern: EVP_CipherInit_ex($CTX, EVP_aes_128_ofb(), $ENGINE, $KEY, $IV, $ENCRYPT)
          - pattern: EVP_CipherInit_ex($CTX, EVP_aes_256_ofb(), $ENGINE, $KEY, $IV, $ENCRYPT)
          - pattern: EVP_CipherInit_ex($CTX, EVP_aes_128_ctr(), $ENGINE, $KEY, $IV, $ENCRYPT)
          - pattern: EVP_CipherInit_ex($CTX, EVP_aes_256_ctr(), $ENGINE, $KEY, $IV, $ENCRYPT)
          - pattern: EVP_CipherInit_ex($CTX, EVP_aes_128_gcm(), $ENGINE, $KEY, $IV, $ENCRYPT)
          - pattern: EVP_CipherInit_ex($CTX, EVP_aes_256_gcm(), $ENGINE, $KEY, $IV, $ENCRYPT)
          - pattern: EVP_CipherInit_ex($CTX, EVP_aes_128_ccm(), $ENGINE, $KEY, $IV, $ENCRYPT)
          - pattern: EVP_CipherInit_ex($CTX, EVP_aes_256_ccm(), $ENGINE, $KEY, $IV, $ENCRYPT)
          - pattern: EVP_CipherInit_ex($CTX, EVP_aes_128_xts(), $ENGINE, $KEY, $IV, $ENCRYPT)
          - pattern: EVP_CipherInit_ex($CTX, EVP_aes_256_xts(), $ENGINE, $KEY, $IV, $ENCRYPT)
          - pattern: AES_cbc_encrypt($INPUT, $OUTPUT, $LENGTH, $SCHEDULE, $IV, $ENCRYPT)
          - pattern:
              AES_cfb128_encrypt($INPUT, $OUTPUT, $LENGTH, $SCHEDULE, $IV, $NUM,
              $ENCRYPT)
          - pattern: AES_ofb128_encrypt($INPUT, $OUTPUT, $LENGTH, $SCHEDULE, $IV, $NUM)
          - pattern:
              AES_ctr128_encrypt($INPUT, $OUTPUT, $LENGTH, $SCHEDULE, $IV, $ECBCOUNT,
              $BUFFER, $NUM)
          - pattern: CryptoPP::CBC_Mode<$CIPHER>::Encryption($KEY, $KEYLEN, $IV)
          - pattern: CryptoPP::CBC_Mode<$CIPHER>::Decryption($KEY, $KEYLEN, $IV)
          - pattern: CryptoPP::CTR_Mode<$CIPHER>::Encryption($KEY, $KEYLEN, $IV)
          - pattern: CryptoPP::GCM<$CIPHER>::Encryption($KEY, $KEYLEN)
          - pattern: EVP_CIPHER_fetch($ENGINE, "AES-128-ECB", $PROPS)
          - pattern: EVP_CIPHER_fetch($ENGINE, "AES-256-ECB", $PROPS)
          - pattern: EVP_CIPHER_fetch($ENGINE, "AES-128-CBC", $PROPS)
          - pattern: EVP_CIPHER_fetch($ENGINE, "AES-256-CBC", $PROPS)
          - pattern: EVP_CIPHER_fetch($ENGINE, "AES-128-CFB", $PROPS)
          - pattern: EVP_CIPHER_fetch($ENGINE, "AES-256-CFB", $PROPS)
          - pattern: EVP_CIPHER_fetch($ENGINE, "AES-128-OFB", $PROPS)
          - pattern: EVP_CIPHER_fetch($ENGINE, "AES-256-OFB", $PROPS)
          - pattern: EVP_CIPHER_fetch($ENGINE, "AES-128-CTR", $PROPS)
          - pattern: EVP_CIPHER_fetch($ENGINE, "AES-256-CTR", $PROPS)
          - pattern: EVP_CIPHER_fetch($ENGINE, "AES-128-GCM", $PROPS)
          - pattern: EVP_CIPHER_fetch($ENGINE, "AES-256-GCM", $PROPS)
          - pattern: EVP_CIPHER_fetch($ENGINE, "AES-128-CCM", $PROPS)
          - pattern: EVP_CIPHER_fetch($ENGINE, "AES-256-CCM", $PROPS)
          - pattern: EVP_CIPHER_fetch($ENGINE, "AES-128-XTS", $PROPS)
          - pattern: EVP_CIPHER_fetch($ENGINE, "AES-256-XTS", $PROPS)
          - pattern: AES_ecb_encrypt($INPUT, $OUTPUT, $SCHEDULE, $ENCRYPT)
          - pattern: Botan::Cipher_Mode::create("AES-128/CBC", Botan::ENCRYPTION)
          - pattern: Botan::Cipher_Mode::create("AES-256/GCM", Botan::ENCRYPTION)
          - pattern: Botan::Cipher_Mode::create("AES-128/CTR", Botan::ENCRYPTION)
          - pattern: Botan::Cipher_Mode::create("AES-128/OCB", Botan::ENCRYPTION)
          - pattern: Botan::Cipher_Mode::create("AES-256/OCB", Botan::ENCRYPTION)
          - pattern: Botan::Cipher_Mode::create("AES-128/EAX", Botan::ENCRYPTION)
          - pattern: Botan::Cipher_Mode::create("AES-256/EAX", Botan::ENCRYPTION)
          - pattern: EVP_CipherUpdate($CTX, $OUT, $OUTLEN, $IN, $INLEN)
          - pattern: EVP_CipherFinal_ex($CTX, $OUT, $OUTLEN)
          - pattern: EVP_EncryptUpdate($CTX, $OUT, $OUTLEN, $IN, $INLEN)
          - pattern: EVP_EncryptFinal_ex($CTX, $OUT, $OUTLEN)
          - pattern: EVP_DecryptUpdate($CTX, $OUT, $OUTLEN, $IN, $INLEN)
          - pattern: EVP_DecryptFinal_ex($CTX, $OUT, $OUTLEN)
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: Cipher mode usage detected in codebase"
  - id: cpp-crypto-tls-cipher-suites
    message: TLS cipher suite configuration detected
    severity: INFO
    languages:
      - cpp
    patterns:
      - pattern-either:
          - pattern: SSL_CTX_set_cipher_list($CTX, $LIST)
          - pattern: SSL_set_cipher_list($SSL, $LIST)
          - pattern: SSL_CTX_set_ciphersuites($CTX, $LIST)
          - pattern: SSL_set_ciphersuites($SSL, $LIST)
          - pattern: SSL_CTX_get_ciphers($CTX)
          - pattern: SSL_get_cipher_list($SSL, $PRIORITY)
          - pattern: SSL_get_current_cipher($SSL)
          - pattern: SSL_CIPHER_get_name($CIPHER)
          - pattern: SSL_CIPHER_get_bits($CIPHER, $ALG_BITS)
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: TLS cipher suite configuration detected in codebase"
  - id: cpp-crypto-sha1
    message: SHA1 hash function usage detected
    severity: INFO
    languages:
      - cpp
    patterns:
      - pattern-either:
          - pattern: SHA1_Init($CTX)
          - pattern: SHA1_Update($CTX, $DATA, $LEN)
          - pattern: SHA1_Final($HASH, $CTX)
          - pattern: |
              SHA_CTX $CTX;
              SHA1_Init(&$CTX);
              SHA1_Update(&$CTX, $DATA, $LEN);
              SHA1_Final($HASH, &$CTX);
          - pattern: EVP_DigestInit_ex($CTX, EVP_sha1(), $ENGINE)
          - pattern: EVP_Digest($DATA, $LEN, $HASH, $SIZE, EVP_sha1(), $ENGINE)
          - pattern: EVP_DigestUpdate($CTX, $DATA, $LEN)
          - pattern: EVP_DigestFinal_ex($CTX, $HASH, $HASHLEN)
          - pattern: EVP_MD_fetch($ENGINE, "SHA1", $PROPS)
          - pattern: EVP_MD_fetch($ENGINE, "SHA-1", $PROPS)
          - pattern: CryptoPP::SHA1()
          - pattern: CryptoPP::Weak::SHA1()
          - pattern: Botan::HashFunction::create("SHA-1")
          - pattern: Botan::SHA_160()
          - patterns:
              - metavariable-pattern:
                  metavariable: $HASH
                  pattern-either:
                    - pattern: CryptoPP::SHA1()
                    - pattern: CryptoPP::Weak::SHA1()
              - pattern: $HASH.Update($DATA, $LEN)
          - patterns:
              - metavariable-pattern:
                  metavariable: $HASH
                  pattern-either:
                    - pattern: CryptoPP::SHA1()
                    - pattern: CryptoPP::Weak::SHA1()
              - pattern: $HASH.Final($OUT)
          - patterns:
              - metavariable-pattern:
                  metavariable: $HASH
                  pattern-either:
                    - pattern: CryptoPP::SHA1()
                    - pattern: CryptoPP::Weak::SHA1()
              - pattern: $HASH.CalculateDigest($OUT, $DATA, $LEN)
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: SHA1 hash function usage detected in codebase"
  - id: cpp-crypto-sha256
    message: SHA256 hash function usage detected
    severity: INFO
    languages:
      - cpp
    patterns:
      - pattern-either:
          - pattern: SHA256_Init($CTX)
          - pattern: SHA256_Update($CTX, $DATA, $LEN)
          - pattern: SHA256_Final($HASH, $CTX)
          - pattern: |
              SHA256_CTX $CTX;
              SHA256_Init(&$CTX);
              SHA256_Update(&$CTX, $DATA, $LEN);
              SHA256_Final($HASH, &$CTX);
          - pattern: EVP_DigestInit_ex($CTX, EVP_sha256(), $ENGINE)
          - pattern: EVP_Digest($DATA, $LEN, $HASH, $SIZE, EVP_sha256(), $ENGINE)
          - pattern: EVP_DigestUpdate($CTX, $DATA, $LEN)
          - pattern: EVP_DigestFinal_ex($CTX, $HASH, $HASHLEN)
          - pattern: EVP_MD_fetch($ENGINE, "SHA-256", $PROPS)
          - pattern: EVP_MD_fetch($ENGINE, "SHA256", $PROPS)
          - pattern: CryptoPP::SHA256()
          - pattern: Botan::HashFunction::create("SHA-256")
          - pattern: Botan::HashFunction::create("SHA256")
          - pattern: Botan::HashFunction::create("SHA2-256")
          - pattern: Botan::SHA_256()
          - patterns:
              - metavariable-pattern:
                  metavariable: $HASH
                  pattern: CryptoPP::SHA256()
              - pattern: $HASH.Update($DATA, $LEN)
          - patterns:
              - metavariable-pattern:
                  metavariable: $HASH
                  pattern: CryptoPP::SHA256()
              - pattern: $HASH.Final($OUT)
          - patterns:
              - metavariable-pattern:
                  metavariable: $HASH
                  pattern: CryptoPP::SHA256()
              - pattern: $HASH.CalculateDigest($OUT, $DATA, $LEN)
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: SHA256 hash function usage detected in codebase"
  - id: cpp-crypto-tls-version
    message: TLS/SSL version configuration detected
    severity: INFO
    languages:
      - cpp
    patterns:
      - pattern-either:
          - pattern: SSL_CTX_new(SSLv2_method())
          - pattern: SSL_CTX_new(SSLv3_method())
          - pattern: SSL_CTX_new(TLSv1_method())
          - pattern: SSL_CTX_new(TLSv1_1_method())
          - pattern: SSL_CTX_new(TLSv1_2_method())
          - pattern: SSL_CTX_new(TLSv1_3_method())
          - pattern: SSL_CTX_new(SSLv23_method())
          - pattern: SSL_CTX_new(DTLSv1_method())
          - pattern: SSL_CTX_new(DTLSv1_2_method())
          - patterns:
              - pattern: SSL_CTX_set_min_proto_version($CTX, $VERSION)
              - metavariable-regex:
                  metavariable: $VERSION
                  regex: (TLS1_[0-3]_VERSION|SSL3_VERSION|SSL2_VERSION|DTLS1_VERSION|DTLS1_2_VERSION)
              - focus-metavariable: $VERSION
          - patterns:
              - pattern: SSL_CTX_set_max_proto_version($CTX, $VERSION)
              - metavariable-regex:
                  metavariable: $VERSION
                  regex: (TLS1_[0-3]_VERSION|SSL3_VERSION|SSL2_VERSION|DTLS1_VERSION|DTLS1_2_VERSION)
              - focus-metavariable: $VERSION
          - patterns:
              - pattern: SSL_set_min_proto_version($SSL, $VERSION)
              - metavariable-regex:
                  metavariable: $VERSION
                  regex: (TLS1_[0-3]_VERSION|SSL3_VERSION|SSL2_VERSION|DTLS1_VERSION|DTLS1_2_VERSION)
              - focus-metavariable: $VERSION
          - patterns:
              - pattern: SSL_set_max_proto_version($SSL, $VERSION)
              - metavariable-regex:
                  metavariable: $VERSION
                  regex: (TLS1_[0-3]_VERSION|SSL3_VERSION|SSL2_VERSION|DTLS1_VERSION|DTLS1_2_VERSION)
              - focus-metavariable: $VERSION
          - pattern: SSL_CTX_set_options($CTX, SSL_OP_NO_SSLv2)
          - pattern: SSL_CTX_set_options($CTX, SSL_OP_NO_SSLv3)
          - pattern: SSL_CTX_set_options($CTX, SSL_OP_NO_TLSv1)
          - pattern: SSL_CTX_set_options($CTX, SSL_OP_NO_TLSv1_1)
          - pattern: SSL_CTX_set_options($CTX, SSL_OP_NO_TLSv1_2)
          - pattern: SSL_CTX_set_options($CTX, SSL_OP_NO_TLSv1_3)
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: TLS/SSL version configuration detected in codebase"
  - id: cpp-crypto-eddsa
    message: EdDSA signature operations detected
    severity: INFO
    languages:
      - cpp
    patterns:
      - pattern-either:
          - pattern: EVP_PKEY_new_raw_private_key(EVP_PKEY_ED25519, $ENGINE, $KEY, $KEYLEN)
          - pattern: EVP_PKEY_new_raw_public_key(EVP_PKEY_ED25519, $ENGINE, $KEY, $KEYLEN)
          - pattern: EVP_PKEY_new_raw_private_key(EVP_PKEY_ED448, $ENGINE, $KEY, $KEYLEN)
          - pattern: EVP_PKEY_new_raw_public_key(EVP_PKEY_ED448, $ENGINE, $KEY, $KEYLEN)
          - pattern: EVP_PKEY_CTX_new_id(EVP_PKEY_ED25519, $ENGINE)
          - pattern: EVP_PKEY_CTX_new_id(EVP_PKEY_ED448, $ENGINE)
          - pattern: EVP_DigestSignInit($CTX, $PKCTX, NULL, $ENGINE, $PKEY)
          - pattern: EVP_DigestVerifyInit($CTX, $PKCTX, NULL, $ENGINE, $PKEY)
          - pattern: CryptoPP::ed25519::Signer($PRIVKEY)
          - pattern: CryptoPP::ed25519::Verifier($PUBKEY)
          - pattern: CryptoPP::ed448::Signer($PRIVKEY)
          - pattern: CryptoPP::ed448::Verifier($PUBKEY)
          - pattern: Botan::Ed25519_PrivateKey($RNG)
          - pattern: Botan::Ed25519_PublicKey($PUBKEY)
          - pattern: Botan::Ed448_PrivateKey($RNG)
          - pattern: Botan::Ed448_PublicKey($PUBKEY)
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: EdDSA signature operations detected in codebase"
  - id: cpp-crypto-random-secure
    message: Cryptographically secure random number generation detected
    severity: INFO
    languages:
      - cpp
    patterns:
      - pattern-either:
          - pattern: RAND_bytes($BUF, $NUM)
          - pattern: |
              unsigned char $BUF[$LEN];
              RAND_bytes($BUF, $LEN);
              ...
          - pattern: RAND_pseudo_bytes($BUF, $NUM)
          - pattern: RAND_add($BUF, $NUM, $ENTROPY)
          - pattern: RAND_seed($BUF, $NUM)
          - pattern: CryptoPP::AutoSeededRandomPool()
          - pattern: CryptoPP::RandomNumberGenerator()
          - pattern: Botan::RandomNumberGenerator::create("system")
          - pattern: Botan::RandomNumberGenerator::create("user")
          - pattern: getentropy($BUF, $SIZE)
          - pattern: getrandom($BUF, $SIZE, $FLAGS)
    metadata:
      category: crypto
      cwe: CWE-338
      impact:
        "Inventory: Cryptographically secure random number generation detected
        in codebase"
  - id: cpp-crypto-digital-signatures
    message: Digital signature operations detected
    severity: INFO
    languages:
      - cpp
    patterns:
      - pattern-either:
          - pattern: EVP_SignInit_ex($CTX, $TYPE, $ENGINE)
          - pattern: EVP_SignUpdate($CTX, $DATA, $DATALEN)
          - pattern: EVP_SignFinal($CTX, $SIG, $SIGLEN, $PKEY)
          - pattern: EVP_VerifyInit_ex($CTX, $TYPE, $ENGINE)
          - pattern: EVP_VerifyUpdate($CTX, $DATA, $DATALEN)
          - pattern: EVP_VerifyFinal($CTX, $SIG, $SIGLEN, $PKEY)
          - pattern: EVP_DigestSignInit($CTX, $PKCTX, $TYPE, $ENGINE, $PKEY)
          - pattern: EVP_DigestSignUpdate($CTX, $DATA, $DATALEN)
          - pattern: EVP_DigestSignFinal($CTX, $SIG, $SIGLEN)
          - pattern: EVP_DigestVerifyInit($CTX, $PKCTX, $TYPE, $ENGINE, $PKEY)
          - pattern: EVP_DigestVerifyUpdate($CTX, $DATA, $DATALEN)
          - pattern: EVP_DigestVerifyFinal($CTX, $SIG, $SIGLEN)
          - pattern: RSA_sign($TYPE, $M, $MLEN, $SIGRET, $SIGLEN, $RSA)
          - pattern: RSA_verify($TYPE, $M, $MLEN, $SIGBUF, $SIGLEN, $RSA)
          - pattern: ECDSA_sign($TYPE, $DGST, $DGSTLEN, $SIG, $SIGLEN, $ECKEY)
          - pattern: ECDSA_verify($TYPE, $DGST, $DGSTLEN, $SIG, $SIGLEN, $ECKEY)
          - pattern: CryptoPP::RSASS<CryptoPP::PSS, $HASH>::Signer($PRIVKEY)
          - pattern: CryptoPP::RSASS<CryptoPP::PKCS1v15, $HASH>::Signer($PRIVKEY)
          - pattern: CryptoPP::RSASS<CryptoPP::PSS, $HASH>::Verifier($PUBKEY)
          - pattern: CryptoPP::RSASS<CryptoPP::PKCS1v15, $HASH>::Verifier($PUBKEY)
          - pattern: CryptoPP::ECDSA<CryptoPP::ECP, $HASH>::Signer($PRIVKEY)
          - pattern: CryptoPP::ECDSA<CryptoPP::ECP, $HASH>::Verifier($PUBKEY)
          - patterns:
              - metavariable-pattern:
                  metavariable: $SIGNER
                  pattern-either:
                    - pattern: CryptoPP::RSASS<CryptoPP::PSS, $HASH>::Signer($PRIVKEY)
                    - pattern: CryptoPP::RSASS<CryptoPP::PKCS1v15, $HASH>::Signer($PRIVKEY)
                    - pattern: CryptoPP::ECDSA<CryptoPP::ECP, $HASH>::Signer($PRIVKEY)
              - pattern: $SIGNER.SignMessage($RNG, $MESSAGE, $SIGNATURE)
          - patterns:
              - metavariable-pattern:
                  metavariable: $VERIFIER
                  pattern-either:
                    - pattern: CryptoPP::RSASS<CryptoPP::PSS, $HASH>::Verifier($PUBKEY)
                    - pattern: CryptoPP::RSASS<CryptoPP::PKCS1v15, $HASH>::Verifier($PUBKEY)
                    - pattern: CryptoPP::ECDSA<CryptoPP::ECP, $HASH>::Verifier($PUBKEY)
              - pattern: $VERIFIER.VerifyMessage($MESSAGE, $SIGNATURE)
          - pattern: DSA_new()
          - pattern:
              DSA_generate_parameters_ex($DSA, $BITS, $SEED, $SEEDLEN, $COUNTER,
              $H_RET, $CALLBACK, $CALLBACKARG)
          - pattern: DSA_generate_key($DSA)
          - pattern: DSA_sign($TYPE, $DGST, $DGSTLEN, $SIG, $SIGLEN, $DSA)
          - pattern: DSA_verify($TYPE, $DGST, $DGSTLEN, $SIG, $SIGLEN, $DSA)
          - pattern: EVP_PKEY_CTX_new_id(EVP_PKEY_DSA, $ENGINE)
          - pattern: Botan::PK_Signer($SIGNER, $RNG)
          - pattern: Botan::PK_Verifier($VERIFIER)
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: Digital signature operations detected in codebase"
  - id: cpp-crypto-password-hashing
    message: Password hashing operations detected
    severity: INFO
    languages:
      - cpp
    patterns:
      - pattern-either:
          - patterns:
              - pattern:
                  PKCS5_PBKDF2_HMAC($PASS, $PASSLEN, $SALT, $SALTLEN, $ITER, $DIGEST,
                  $KEYLEN, $OUT)
              - metavariable-regex:
                  metavariable: $ITER
                  regex: \d+
              - focus-metavariable: $ITER
          - patterns:
              - pattern:
                  PKCS5_PBKDF2_HMAC_SHA1($PASS, $PASSLEN, $SALT, $SALTLEN, $ITER, $KEYLEN,
                  $OUT)
              - metavariable-regex:
                  metavariable: $ITER
                  regex: \d+
              - focus-metavariable: $ITER
          - pattern:
              EVP_PBE_scrypt($PASS, $PASSLEN, $SALT, $SALTLEN, $N, $R, $P, $MAXMEM,
              $KEY, $KEYLEN)
          - pattern: EVP_KDF_fetch($ENGINE, "PBKDF2", $PROPS)
          - pattern: EVP_KDF_fetch($ENGINE, "scrypt", $PROPS)
          - pattern: EVP_KDF_fetch($ENGINE, "Argon2", $PROPS)
          - pattern: CryptoPP::PKCS5_PBKDF2_HMAC<$HASH>()
          - pattern:
              CryptoPP::Scrypt().DeriveKey($KEY, $KEYLEN, $PASS, $PASSLEN, $SALT,
              $SALTLEN, $N, $R, $P)
          - pattern: Botan::PBKDF2($PBKDF)
          - pattern: Botan::Scrypt().derive_key($KEYLEN, $PASS, $SALT, $N, $R, $P)
          - pattern: Botan::Argon2($MEMORY, $PARALLELISM, $ITERATIONS)
          - pattern: |
              CryptoPP::PKCS5_PBKDF2_HMAC<$HASH> $PBKDF;
              $PBKDF.DeriveKey($KEY, $KEYLEN, $PASS, $PASSLEN, $SALT, $SALTLEN, $ITER);
          - pattern:
              argon2_hash($TIME_COST, $MEMORY_COST, $PARALLELISM, $PWD, $PWD_LEN,
              $SALT, $SALTLEN, $HASH, $HASH_LEN, $ENCODED, $ENCODED_LEN, $TYPE, $VERSION)
          - pattern:
              argon2i_hash($TIME_COST, $MEMORY_COST, $PARALLELISM, $PWD, $PWD_LEN,
              $SALT, $SALTLEN, $HASH, $HASH_LEN, $ENCODED, $ENCODED_LEN, $VERSION)
          - pattern:
              argon2id_hash($TIME_COST, $MEMORY_COST, $PARALLELISM, $PWD, $PWD_LEN,
              $SALT, $SALTLEN, $HASH, $HASH_LEN, $ENCODED, $ENCODED_LEN, $VERSION)
          - pattern:
              argon2d_hash($TIME_COST, $MEMORY_COST, $PARALLELISM, $PWD, $PWD_LEN,
              $SALT, $SALTLEN, $HASH, $HASH_LEN, $ENCODED, $ENCODED_LEN, $VERSION)
          - patterns:
              - pattern:
                  argon2id_hash($TIME_COST, $MEMORY_COST, $PARALLELISM, $PWD, $PWD_LEN,
                  $SALT, $SALTLEN, $HASH, $HASH_LEN, $ENCODED, $ENCODED_LEN, $VERSION)
              - metavariable-regex:
                  metavariable: $TIME_COST
                  regex: \d+
              - metavariable-regex:
                  metavariable: $MEMORY_COST
                  regex: \d+
          - patterns:
              - pattern:
                  argon2i_hash($TIME_COST, $MEMORY_COST, $PARALLELISM, $PWD, $PWD_LEN,
                  $SALT, $SALTLEN, $HASH, $HASH_LEN, $ENCODED, $ENCODED_LEN, $VERSION)
              - metavariable-regex:
                  metavariable: $TIME_COST
                  regex: \d+
              - metavariable-regex:
                  metavariable: $MEMORY_COST
                  regex: \d+
          - patterns:
              - pattern:
                  CryptoPP::Scrypt().DeriveKey($KEY, $KEYLEN, $PASS, $PASSLEN, $SALT,
                  $SALTLEN, $N, $R, $P)
              - metavariable-regex:
                  metavariable: $N
                  regex: \d+
              - metavariable-regex:
                  metavariable: $R
                  regex: \d+
              - metavariable-regex:
                  metavariable: $P
                  regex: \d+
          - patterns:
              - pattern: Botan::Scrypt().derive_key($KEYLEN, $PASS, $SALT, $N, $R, $P)
              - metavariable-regex:
                  metavariable: $N
                  regex: \d+
              - metavariable-regex:
                  metavariable: $R
                  regex: \d+
              - metavariable-regex:
                  metavariable: $P
                  regex: \d+
          - patterns:
              - pattern: Botan::Argon2($MEMORY, $PARALLELISM, $ITERATIONS)
              - metavariable-regex:
                  metavariable: $MEMORY
                  regex: \d+
              - metavariable-regex:
                  metavariable: $ITERATIONS
                  regex: \d+
          - patterns:
              - pattern: |
                  CryptoPP::PKCS5_PBKDF2_HMAC<$HASH> $PBKDF;
                  $PBKDF.DeriveKey($KEY, $KEYLEN, $PASS, $PASSLEN, $SALT, $SALTLEN, $ITER);
              - metavariable-regex:
                  metavariable: $ITER
                  regex: \d+
              - focus-metavariable: $ITER
    metadata:
      category: crypto
      cwe: CWE-326
      impact: "Inventory: Password hashing operations detected in codebase"
  - id: cpp-crypto-cipher-3des
    message: 3DES cipher usage detected
    severity: INFO
    languages:
      - cpp
    patterns:
      - pattern-either:
          - pattern: DES_set_key_checked($KEY, $SCHEDULE)
          - pattern: DES_set_key_unchecked($KEY, $SCHEDULE)
          - pattern: DES_ede3_set_key($KEY, $SCHEDULE)
          - pattern:
              DES_ede3_cbc_encrypt($INPUT, $OUTPUT, $LENGTH, $KS1, $KS2, $KS3, $IV,
              $ENCRYPT)
          - pattern: EVP_CipherInit_ex($CTX, EVP_des_ede3(), $ENGINE, $KEY, $IV, $ENCRYPT)
          - pattern: EVP_CipherInit_ex($CTX, EVP_des_ede3_cbc(), $ENGINE, $KEY, $IV, $ENCRYPT)
          - pattern: EVP_CipherInit_ex($CTX, EVP_des_ede3_ecb(), $ENGINE, $KEY, $IV, $ENCRYPT)
          - pattern: EVP_CIPHER_fetch($ENGINE, "DES-EDE3", $PROPS)
          - pattern: EVP_CIPHER_fetch($ENGINE, "DES-EDE3-CBC", $PROPS)
          - pattern: EVP_CIPHER_fetch($ENGINE, "DES-EDE3-ECB", $PROPS)
          - pattern:
              DES_ede3_cfb64_encrypt($INPUT, $OUTPUT, $LENGTH, $KS1, $KS2, $KS3,
              $IV, $NUM, $ENCRYPT)
          - pattern:
              DES_ede3_ofb64_encrypt($INPUT, $OUTPUT, $LENGTH, $KS1, $KS2, $KS3,
              $IV, $NUM)
          - pattern: CryptoPP::DES_EDE3::Encryption($KEY, $KEYLEN)
          - pattern: CryptoPP::DES_EDE3::Decryption($KEY, $KEYLEN)
          - pattern: Botan::Cipher_Mode::create("3DES/ECB", Botan::ENCRYPTION)
          - pattern: Botan::Cipher_Mode::create("3DES/CBC", Botan::ENCRYPTION)
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: 3DES cipher usage detected in codebase"
  - id: cpp-crypto-sha3
    message: SHA3 hash function usage detected
    severity: INFO
    languages:
      - cpp
    patterns:
      - pattern-either:
          - pattern: EVP_DigestInit_ex($CTX, EVP_sha3_224(), $ENGINE)
          - pattern: EVP_DigestInit_ex($CTX, EVP_sha3_256(), $ENGINE)
          - pattern: EVP_DigestInit_ex($CTX, EVP_sha3_384(), $ENGINE)
          - pattern: EVP_DigestInit_ex($CTX, EVP_sha3_512(), $ENGINE)
          - pattern: EVP_Digest($DATA, $LEN, $HASH, $SIZE, EVP_sha3_224(), $ENGINE)
          - pattern: EVP_Digest($DATA, $LEN, $HASH, $SIZE, EVP_sha3_256(), $ENGINE)
          - pattern: EVP_Digest($DATA, $LEN, $HASH, $SIZE, EVP_sha3_384(), $ENGINE)
          - pattern: EVP_Digest($DATA, $LEN, $HASH, $SIZE, EVP_sha3_512(), $ENGINE)
          - pattern: CryptoPP::SHA3_224()
          - pattern: CryptoPP::SHA3_256()
          - pattern: CryptoPP::SHA3_384()
          - pattern: CryptoPP::SHA3_512()
          - pattern: EVP_MD_fetch($ENGINE, "SHA3-224", $PROPS)
          - pattern: EVP_MD_fetch($ENGINE, "SHA3-256", $PROPS)
          - pattern: EVP_MD_fetch($ENGINE, "SHA3-384", $PROPS)
          - pattern: EVP_MD_fetch($ENGINE, "SHA3-512", $PROPS)
          - pattern: Botan::HashFunction::create("SHA-3(224)")
          - pattern: Botan::HashFunction::create("SHA-3(256)")
          - pattern: Botan::HashFunction::create("SHA-3(384)")
          - pattern: Botan::HashFunction::create("SHA-3(512)")
          - pattern: Botan::SHA3_224()
          - pattern: Botan::SHA3_256()
          - pattern: Botan::SHA3_384()
          - pattern: Botan::SHA3_512()
          - patterns:
              - metavariable-pattern:
                  metavariable: $HASH
                  pattern-either:
                    - pattern: CryptoPP::SHA3_224()
                    - pattern: CryptoPP::SHA3_256()
                    - pattern: CryptoPP::SHA3_384()
                    - pattern: CryptoPP::SHA3_512()
              - pattern: $HASH.Update($DATA, $LEN)
          - patterns:
              - metavariable-pattern:
                  metavariable: $HASH
                  pattern-either:
                    - pattern: CryptoPP::SHA3_224()
                    - pattern: CryptoPP::SHA3_256()
                    - pattern: CryptoPP::SHA3_384()
                    - pattern: CryptoPP::SHA3_512()
              - pattern: $HASH.Final($OUT)
          - patterns:
              - metavariable-pattern:
                  metavariable: $HASH
                  pattern-either:
                    - pattern: CryptoPP::SHA3_224()
                    - pattern: CryptoPP::SHA3_256()
                    - pattern: CryptoPP::SHA3_384()
                    - pattern: CryptoPP::SHA3_512()
              - pattern: $HASH.CalculateDigest($OUT, $DATA, $LEN)
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: SHA3 hash function usage detected in codebase"
  - id: cpp-crypto-certificate-validation
    message: TLS certificate validation configuration detected
    severity: INFO
    languages:
      - cpp
    patterns:
      - pattern-either:
          - pattern: SSL_CTX_set_verify($CTX, $MODE, $CALLBACK)
          - pattern: SSL_set_verify($SSL, $MODE, $CALLBACK)
          - pattern: SSL_CTX_set_verify_depth($CTX, $DEPTH)
          - pattern: SSL_CTX_set_cert_verify_callback($CTX, $CALLBACK, $ARG)
          - pattern: SSL_get_verify_result($SSL)
          - pattern: SSL_CTX_load_verify_locations($CTX, $CAFILE, $CAPATH)
          - pattern: SSL_CTX_set_default_verify_paths($CTX)
          - pattern: X509_STORE_CTX_get_error($CTX)
          - pattern: X509_verify_cert($CTX)
    metadata:
      category: crypto
      cwe: CWE-295
      impact: "Inventory: TLS certificate validation configuration detected in codebase"
  - id: cpp-crypto-key-derivation
    message: Key derivation function usage detected
    severity: INFO
    languages:
      - cpp
    patterns:
      - pattern-either:
          - patterns:
              - pattern:
                  PKCS5_PBKDF2_HMAC($PASS, $PASSLEN, $SALT, $SALTLEN, $ITER, $DIGEST,
                  $KEYLEN, $OUT)
              - metavariable-regex:
                  metavariable: $ITER
                  regex: \d+
              - focus-metavariable: $ITER
          - patterns:
              - pattern:
                  PKCS5_PBKDF2_HMAC_SHA1($PASS, $PASSLEN, $SALT, $SALTLEN, $ITER, $KEYLEN,
                  $OUT)
              - metavariable-regex:
                  metavariable: $ITER
                  regex: \d+
              - focus-metavariable: $ITER
          - pattern: EVP_BytesToKey($TYPE, $MD, $SALT, $DATA, $DATALEN, $COUNT, $KEY, $IV)
          - pattern: EVP_PKEY_derive_init($CTX)
          - pattern: EVP_PKEY_derive($CTX, $KEY, $KEYLEN)
          - pattern: EVP_KDF_fetch($ENGINE, "HKDF", $PROPS)
          - pattern: EVP_PKEY_CTX_set_hkdf_md($CTX, $MD)
          - pattern: EVP_PKEY_CTX_set1_hkdf_salt($CTX, $SALT, $SALTLEN)
          - pattern: EVP_PKEY_CTX_set1_hkdf_key($CTX, $KEY, $KEYLEN)
          - pattern: EVP_PKEY_CTX_add1_hkdf_info($CTX, $INFO, $INFOLEN)
          - pattern: CryptoPP::HKDF<$HASH> $HKDF;
          - pattern: CryptoPP::HKDF<$HASH>($SALT, $SALTLEN, $INFO, $INFOLEN)
          - pattern:
              CryptoPP::HKDF<$HASH>::DeriveKey($KEY, $KEYLEN, $SECRET, $SECRETLEN,
              $SALT, $SALTLEN, $INFO, $INFOLEN)
          - patterns:
              - pattern:
                  CryptoPP::Scrypt().DeriveKey($KEY, $KEYLEN, $PASS, $PASSLEN, $SALT,
                  $SALTLEN, $N, $R, $P)
              - metavariable-regex:
                  metavariable: $N
                  regex: \d+
              - metavariable-regex:
                  metavariable: $R
                  regex: \d+
              - metavariable-regex:
                  metavariable: $P
                  regex: \d+
          - patterns:
              - pattern: Botan::Scrypt().derive_key($KEYLEN, $PASS, $SALT, $N, $R, $P)
              - metavariable-regex:
                  metavariable: $N
                  regex: \d+
              - metavariable-regex:
                  metavariable: $R
                  regex: \d+
              - metavariable-regex:
                  metavariable: $P
                  regex: \d+
          - patterns:
              - pattern: Botan::Argon2($MEMORY, $PARALLELISM, $ITERATIONS)
              - metavariable-regex:
                  metavariable: $MEMORY
                  regex: \d+
              - metavariable-regex:
                  metavariable: $ITERATIONS
                  regex: \d+
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: Key derivation function usage detected in codebase"
  - id: cpp-crypto-cipher-camellia
    message: Camellia cipher usage detected
    severity: INFO
    languages:
      - cpp
    patterns:
      - pattern-either:
          - pattern:
              EVP_CipherInit_ex($CTX, EVP_camellia_128_cbc(), $ENGINE, $KEY, $IV,
              $ENCRYPT)
          - pattern:
              EVP_CipherInit_ex($CTX, EVP_camellia_192_cbc(), $ENGINE, $KEY, $IV,
              $ENCRYPT)
          - pattern:
              EVP_CipherInit_ex($CTX, EVP_camellia_256_cbc(), $ENGINE, $KEY, $IV,
              $ENCRYPT)
          - pattern:
              EVP_CipherInit_ex($CTX, EVP_camellia_128_gcm(), $ENGINE, $KEY, $IV,
              $ENCRYPT)
          - pattern:
              EVP_CipherInit_ex($CTX, EVP_camellia_256_gcm(), $ENGINE, $KEY, $IV,
              $ENCRYPT)
          - pattern: EVP_CIPHER_fetch($ENGINE, "CAMELLIA-128-CBC", $PROPS)
          - pattern: EVP_CIPHER_fetch($ENGINE, "CAMELLIA-192-CBC", $PROPS)
          - pattern: EVP_CIPHER_fetch($ENGINE, "CAMELLIA-256-CBC", $PROPS)
          - pattern: EVP_CIPHER_fetch($ENGINE, "CAMELLIA-128-GCM", $PROPS)
          - pattern: EVP_CIPHER_fetch($ENGINE, "CAMELLIA-256-GCM", $PROPS)
          - pattern: CryptoPP::Camellia::Encryption($KEY, $KEYLEN)
          - pattern: CryptoPP::Camellia::Decryption($KEY, $KEYLEN)
          - pattern: Botan::Cipher_Mode::create("Camellia-128/CBC", Botan::ENCRYPTION)
          - pattern: Botan::Cipher_Mode::create("Camellia-256/CBC", Botan::ENCRYPTION)
          - pattern: Botan::Cipher_Mode::create("Camellia-128/GCM", Botan::ENCRYPTION)
          - pattern: Botan::Cipher_Mode::create("Camellia-256/GCM", Botan::ENCRYPTION)
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: Camellia cipher usage detected in codebase"
  - id: cpp-crypto-cipher-aes
    message: AES cipher usage detected
    severity: INFO
    languages:
      - cpp
    patterns:
      - pattern-either:
          - patterns:
              - pattern: AES_set_encrypt_key($KEY, $BITS, $SCHEDULE)
              - metavariable-regex:
                  metavariable: $BITS
                  regex: (128|192|256)
              - focus-metavariable: $BITS
          - patterns:
              - pattern: AES_set_decrypt_key($KEY, $BITS, $SCHEDULE)
              - metavariable-regex:
                  metavariable: $BITS
                  regex: (128|192|256)
              - focus-metavariable: $BITS
          - pattern: AES_encrypt($INPUT, $OUTPUT, $SCHEDULE)
          - pattern: AES_decrypt($INPUT, $OUTPUT, $SCHEDULE)
          - pattern: AES_ecb_encrypt($INPUT, $OUTPUT, $SCHEDULE, $ENCRYPT)
          - pattern: EVP_CIPHER_fetch($ENGINE, "AES-128-CBC", $PROPS)
          - pattern: EVP_CIPHER_fetch($ENGINE, "AES-192-CBC", $PROPS)
          - pattern: EVP_CIPHER_fetch($ENGINE, "AES-256-CBC", $PROPS)
          - pattern: EVP_CIPHER_fetch($ENGINE, "AES-128-GCM", $PROPS)
          - pattern: EVP_CIPHER_fetch($ENGINE, "AES-256-GCM", $PROPS)
          - pattern: EVP_CIPHER_fetch($ENGINE, "AES-128-CCM", $PROPS)
          - pattern: EVP_CIPHER_fetch($ENGINE, "AES-256-CCM", $PROPS)
          - patterns:
              - pattern: CryptoPP::AES::Encryption($KEY, $KEYLEN)
              - metavariable-regex:
                  metavariable: $KEYLEN
                  regex: \d+
              - focus-metavariable: $KEYLEN
          - patterns:
              - pattern: CryptoPP::AES::Decryption($KEY, $KEYLEN)
              - metavariable-regex:
                  metavariable: $KEYLEN
                  regex: \d+
              - focus-metavariable: $KEYLEN
          - patterns:
              - pattern: EVP_CIPHER_fetch($ENGINE, $ALGO, $PROPS)
              - metavariable-regex:
                  metavariable: $ALGO
                  regex: '"AES-[0-9]+-[A-Z]+"'
              - focus-metavariable: $ALGO
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: AES cipher usage detected in codebase"
  - id: cpp-crypto-ecdh
    message: ECDH key exchange operations detected
    severity: INFO
    languages:
      - cpp
    patterns:
      - pattern-either:
          - pattern: ECDH_compute_key($KEY, $KEYLEN, $PUBKEY, $ECKEY, $KDF)
          - pattern: EVP_PKEY_new_raw_private_key(EVP_PKEY_X25519, $ENGINE, $KEY, $KEYLEN)
          - pattern: EVP_PKEY_new_raw_public_key(EVP_PKEY_X25519, $ENGINE, $KEY, $KEYLEN)
          - pattern: EVP_PKEY_new_raw_private_key(EVP_PKEY_X448, $ENGINE, $KEY, $KEYLEN)
          - pattern: EVP_PKEY_new_raw_public_key(EVP_PKEY_X448, $ENGINE, $KEY, $KEYLEN)
          - pattern: EVP_PKEY_CTX_new_id(EVP_PKEY_X25519, $ENGINE)
          - pattern: EVP_PKEY_CTX_new_id(EVP_PKEY_X448, $ENGINE)
          - pattern: EVP_PKEY_derive_init($CTX)
          - pattern: EVP_PKEY_derive_set_peer($CTX, $PEER)
          - pattern: EVP_PKEY_derive($CTX, $KEY, $KEYLEN)
          - pattern: CryptoPP::ECDH<CryptoPP::ECP>::Domain($GROUP)
          - pattern: CryptoPP::X25519::Domain()
          - pattern: CryptoPP::X448::Domain()
          - pattern: Botan::ECDH_PrivateKey($RNG, $GROUP)
          - pattern: Botan::ECDH_PublicKey($GROUP, $PUBKEY)
          - pattern: Botan::X25519_PrivateKey($RNG)
          - pattern: Botan::X25519_PublicKey($PUBKEY)
          - pattern: Botan::X448_PrivateKey($RNG)
          - pattern: Botan::X448_PublicKey($PUBKEY)
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: ECDH key exchange operations detected in codebase"
  - id: cpp-crypto-hmac
    message: HMAC usage detected
    severity: INFO
    languages:
      - cpp
    patterns:
      - pattern-either:
          - pattern: HMAC($EVPTYPE, $KEY, $KEYLEN, $DATA, $DATALEN, $HASH, $HASHLEN)
          - pattern: HMAC_Init_ex($CTX, $KEY, $KEYLEN, $EVPTYPE, $ENGINE)
          - pattern: HMAC_Update($CTX, $DATA, $DATALEN)
          - pattern: HMAC_Final($CTX, $HASH, $HASHLEN)
          - pattern: |
              HMAC_CTX *$CTX;
              HMAC_Init_ex($CTX, $KEY, $KEYLEN, $EVPTYPE, $ENGINE);
              HMAC_Update($CTX, $DATA, $DATALEN);
              HMAC_Final($CTX, $HASH, $HASHLEN);
          - pattern: HMAC_CTX_new()
          - pattern: HMAC_CTX_free($CTX)
          - pattern: EVP_DigestSignInit($CTX, $PKCTX, $EVPTYPE, $ENGINE, $KEY)
          - pattern: EVP_DigestVerifyInit($CTX, $PKCTX, $EVPTYPE, $ENGINE, $KEY)
          - pattern: EVP_MAC_fetch($ENGINE, "HMAC", $PROPS)
          - pattern: CryptoPP::HMAC<$HASH> $VAR;
          - pattern: CryptoPP::HMAC<$HASH> $VAR($KEY, $KEYLEN);
          - pattern: CryptoPP::HMAC<$HASH>($KEY, $KEYLEN)
          - pattern: Botan::MessageAuthenticationCode::create("HMAC($ALGO)")
          - patterns:
              - metavariable-pattern:
                  metavariable: $HMAC
                  pattern-either:
                    - pattern: CryptoPP::HMAC<$HASH>($KEY, $KEYLEN)
                    - pattern: CryptoPP::HMAC<$HASH> $HMAC($KEY, $KEYLEN);
              - pattern: $HMAC.Update($DATA, $LEN)
          - patterns:
              - metavariable-pattern:
                  metavariable: $HMAC
                  pattern-either:
                    - pattern: CryptoPP::HMAC<$HASH>($KEY, $KEYLEN)
                    - pattern: CryptoPP::HMAC<$HASH> $HMAC($KEY, $KEYLEN);
              - pattern: $HMAC.Final($OUT)
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: HMAC usage detected in codebase"
  - id: cpp-crypto-diffie-hellman
    message: Diffie-Hellman key exchange detected
    severity: INFO
    languages:
      - cpp
    patterns:
      - pattern-either:
          - pattern: DH_new()
          - patterns:
              - pattern: DH_generate_parameters_ex($DH, $PRIME_LEN, $GENERATOR, $BN)
              - metavariable-regex:
                  metavariable: $PRIME_LEN
                  regex: \d+
              - focus-metavariable: $PRIME_LEN
          - pattern: DH_generate_key($DH)
          - pattern: DH_compute_key($KEY, $PUBKEY, $DH)
          - pattern: EVP_PKEY_new_DH($DH)
          - pattern: EVP_PKEY_assign_DH($PKEY, $DH)
          - pattern: EVP_PKEY_CTX_new_id(EVP_PKEY_DH, $ENGINE)
          - pattern: EVP_PKEY_derive_init($CTX)
          - pattern: EVP_PKEY_derive_set_peer($CTX, $PEER)
          - pattern: EVP_PKEY_derive($CTX, $KEY, $KEYLEN)
          - pattern: EVP_PKEY_get0_DH($PKEY)
          - pattern: DH_set0_pqg($DH, $P, $Q, $G)
          - pattern: DH_get0_pqg($DH, $P, $Q, $G)
          - pattern: CryptoPP::DH($GROUP, $GENERATOR)
          - pattern: CryptoPP::DH_Domain($PRIME, $GENERATOR)
          - pattern: Botan::DH_PrivateKey($RNG, $GROUP, $GENERATOR)
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: Diffie-Hellman key exchange detected in codebase"
  - id: cpp-crypto-ecdsa
    message: ECDSA cryptographic operations detected
    severity: INFO
    languages:
      - cpp
    patterns:
      - pattern-either:
          - pattern: EC_KEY_new()
          - pattern: EC_KEY_new_by_curve_name($NID)
          - pattern: EC_KEY_generate_key($KEY)
          - pattern: ECDSA_sign($TYPE, $DGST, $DGSTLEN, $SIG, $SIGLEN, $ECKEY)
          - pattern: ECDSA_verify($TYPE, $DGST, $DGSTLEN, $SIG, $SIGLEN, $ECKEY)
          - pattern: ECDSA_do_sign($DGST, $DGSTLEN, $ECKEY)
          - pattern: ECDSA_do_verify($DGST, $DGSTLEN, $SIG, $ECKEY)
          - pattern: EVP_PKEY_new_EC_KEY($ECKEY)
          - pattern: EVP_PKEY_assign_EC_KEY($PKEY, $ECKEY)
          - pattern: EVP_PKEY_CTX_new_id(EVP_PKEY_EC, $ENGINE)
          - pattern: EVP_PKEY_CTX_new_id(EVP_PKEY_ECDSA, $ENGINE)
          - pattern: EVP_DigestSignInit($CTX, $PKCTX, $TYPE, $ENGINE, $PKEY)
          - pattern: EVP_DigestVerifyInit($CTX, $PKCTX, $TYPE, $ENGINE, $PKEY)
          - pattern: EC_GROUP_new_by_curve_name($NID)
          - pattern: EC_GROUP_get_curve_name($GROUP)
          - pattern: EC_POINT_point2oct($GROUP, $POINT, $FORM, $BUF, $LEN, $CTX)
          - pattern: EC_POINT_oct2point($GROUP, $POINT, $BUF, $LEN, $CTX)
          - pattern: EVP_PKEY_get0_EC_KEY($PKEY)
          - pattern: CryptoPP::ECDSA<CryptoPP::ECP, $HASH>::Signer($PRIVKEY)
          - pattern: CryptoPP::ECDSA<CryptoPP::ECP, $HASH>::Verifier($PUBKEY)
          - pattern: Botan::ECDSA_PrivateKey($RNG, $GROUP)
          - pattern: Botan::ECDSA_PublicKey($GROUP, $PUBKEY)
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: ECDSA cryptographic operations detected in codebase"
  - id: cpp-crypto-sha512
    message: SHA512 hash function usage detected
    severity: INFO
    languages:
      - cpp
    patterns:
      - pattern-either:
          - pattern: SHA512_Init($CTX)
          - pattern: SHA512_Update($CTX, $DATA, $LEN)
          - pattern: SHA512_Final($HASH, $CTX)
          - pattern: |
              SHA512_CTX $CTX;
              SHA512_Init(&$CTX);
              SHA512_Update(&$CTX, $DATA, $LEN);
              SHA512_Final($HASH, &$CTX);
          - pattern: EVP_DigestInit_ex($CTX, EVP_sha512(), $ENGINE)
          - pattern: EVP_Digest($DATA, $LEN, $HASH, $SIZE, EVP_sha512(), $ENGINE)
          - pattern: EVP_DigestUpdate($CTX, $DATA, $LEN)
          - pattern: EVP_DigestFinal_ex($CTX, $HASH, $HASHLEN)
          - pattern: EVP_MD_fetch($ENGINE, "SHA-512", $PROPS)
          - pattern: EVP_MD_fetch($ENGINE, "SHA512", $PROPS)
          - pattern: CryptoPP::SHA512()
          - pattern: Botan::HashFunction::create("SHA-512")
          - pattern: Botan::SHA_512()
          - patterns:
              - metavariable-pattern:
                  metavariable: $HASH
                  pattern: CryptoPP::SHA512()
              - pattern: $HASH.Update($DATA, $LEN)
          - patterns:
              - metavariable-pattern:
                  metavariable: $HASH
                  pattern: CryptoPP::SHA512()
              - pattern: $HASH.Final($OUT)
          - patterns:
              - metavariable-pattern:
                  metavariable: $HASH
                  pattern: CryptoPP::SHA512()
              - pattern: $HASH.CalculateDigest($OUT, $DATA, $LEN)
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: SHA512 hash function usage detected in codebase"
  - id: cpp-crypto-cryptopp
    message: Crypto++ library usage detected
    severity: INFO
    languages:
      - cpp
    patterns:
      - pattern-either:
          - pattern: CryptoPP::AES::Encryption($KEY, $KEYLEN)
          - pattern: CryptoPP::AES::Decryption($KEY, $KEYLEN)
          - pattern: CryptoPP::SHA256()
          - pattern: CryptoPP::SHA512()
          - pattern: CryptoPP::RSA::PrivateKey()
          - pattern: CryptoPP::RSA::PublicKey()
          - pattern: CryptoPP::AutoSeededRandomPool()
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: Crypto++ library usage detected in codebase"
  - id: cpp-crypto-iv-nonce
    message: Initialization vector or nonce usage detected
    severity: INFO
    languages:
      - cpp
    patterns:
      - pattern-either:
          - pattern: EVP_CIPHER_CTX_ctrl($CTX, EVP_CTRL_GCM_SET_IVLEN, $IVLEN, $NULL)
          - pattern: EVP_CIPHER_CTX_ctrl($CTX, EVP_CTRL_CCM_SET_IVLEN, $IVLEN, $NULL)
          - pattern: EVP_CIPHER_CTX_ctrl($CTX, EVP_CTRL_GCM_GET_TAG, $TAGLEN, $TAG)
          - pattern: EVP_CIPHER_CTX_ctrl($CTX, EVP_CTRL_CCM_SET_TAG, $TAGLEN, $TAG)
          - pattern: EVP_EncryptInit_ex($CTX, $CIPHER, $ENGINE, $KEY, $IV)
          - pattern: EVP_DecryptInit_ex($CTX, $CIPHER, $ENGINE, $KEY, $IV)
          - pattern: EVP_CipherInit_ex($CTX, $CIPHER, $ENGINE, $KEY, $IV, $ENCRYPT)
          - pattern: AES_cbc_encrypt($INPUT, $OUTPUT, $LENGTH, $SCHEDULE, $IV, $ENCRYPT)
          - pattern: DES_cbc_encrypt($INPUT, $OUTPUT, $LENGTH, $SCHEDULE, $IV, $ENCRYPT)
          - pattern: RAND_bytes($IV, $IVLEN)
          - pattern: RAND_pseudo_bytes($IV, $IVLEN)
          - pattern: CryptoPP::CBC_Mode<$CIPHER>::Encryption($KEY, $KEYLEN, $IV)
          - pattern: CryptoPP::GCM<$CIPHER>::Encryption($KEY, $KEYLEN)
          - pattern: Botan::Cipher_Mode::create("AES-256/GCM", Botan::ENCRYPTION)
    metadata:
      category: crypto
      cwe: CWE-330
      impact: "Inventory: Initialization vector or nonce usage detected in codebase"
  - id: cpp-crypto-cipher-des
    message: DES cipher usage detected
    severity: INFO
    languages:
      - cpp
    patterns:
      - pattern-either:
          - pattern: DES_set_key($KEY, $SCHEDULE)
          - pattern: DES_encrypt($DATA, $SCHEDULE, $ENCRYPT)
          - pattern: DES_decrypt($DATA, $SCHEDULE, $DECRYPT)
          - pattern: DES_ecb_encrypt($INPUT, $OUTPUT, $SCHEDULE, $ENCRYPT)
          - pattern: DES_cbc_encrypt($INPUT, $OUTPUT, $LENGTH, $SCHEDULE, $IV, $ENCRYPT)
          - pattern: EVP_CipherInit_ex($CTX, EVP_des_ecb(), $ENGINE, $KEY, $IV, $ENCRYPT)
          - pattern: EVP_CipherInit_ex($CTX, EVP_des_cbc(), $ENGINE, $KEY, $IV, $ENCRYPT)
          - pattern: EVP_CIPHER_fetch($ENGINE, "DES-ECB", $PROPS)
          - pattern: EVP_CIPHER_fetch($ENGINE, "DES-CBC", $PROPS)
          - pattern: DES_cfb64_encrypt($INPUT, $OUTPUT, $LENGTH, $SCHEDULE, $IV, $NUM, $ENCRYPT)
          - pattern: DES_ofb64_encrypt($INPUT, $OUTPUT, $LENGTH, $SCHEDULE, $IV, $NUM)
          - pattern: DES_set_odd_parity($KEY)
          - pattern: CryptoPP::DES::Encryption($KEY, $KEYLEN)
          - pattern: CryptoPP::DES::Decryption($KEY, $KEYLEN)
          - pattern: Botan::Cipher_Mode::create("DES/ECB", Botan::ENCRYPTION)
          - pattern: Botan::Cipher_Mode::create("DES/CBC", Botan::ENCRYPTION)
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: DES cipher usage detected in codebase"
  - id: cpp-crypto-random-insecure
    message: Non-cryptographic random number generator detected in cryptographic context
    severity: INFO
    languages:
      - cpp
    patterns:
      - pattern-either:
          - pattern: rand()
          - pattern: random()
          - pattern: srand($SEED)
          - pattern: srandom($SEED)
          - pattern: std::mt19937()
          - pattern: std::mt19937_64()
          - pattern: std::linear_congruential_engine<$A, $C, $M>()
          - pattern: std::mersenne_twister_engine<$A, $B, $C, $D>()
          - pattern: |
              std::random_device $RD;
              std::mt19937 $GEN($RD());
          - pattern: |
              std::random_device $RD;
              std::mt19937_64 $GEN($RD());
    metadata:
      category: crypto
      cwe: CWE-338
      impact:
        "Inventory: Non-cryptographic random number generator detected (may be
        used in cryptographic context)"
  - id: cpp-crypto-libsodium
    message: libsodium cryptographic library usage detected
    severity: INFO
    languages:
      - cpp
    patterns:
      - pattern-either:
          - pattern: sodium_init()
          - pattern: crypto_box_easy($C, $M, $MLEN, $N, $PK, $SK)
          - pattern: crypto_box_open_easy($M, $C, $CLEN, $N, $PK, $SK)
          - pattern: crypto_secretbox_easy($C, $M, $MLEN, $N, $K)
          - pattern: crypto_secretbox_open_easy($M, $C, $CLEN, $N, $K)
          - pattern: crypto_sign_detached($SIG, $SIGLEN, $M, $MLEN, $SK)
          - pattern: crypto_sign_verify_detached($SIG, $M, $MLEN, $PK)
          - pattern: crypto_hash_sha256($OUT, $IN, $INLEN)
          - pattern: crypto_hash_sha512($OUT, $IN, $INLEN)
          - pattern: crypto_generichash($OUT, $OUTLEN, $IN, $INLEN, $KEY, $KEYLEN)
          - pattern:
              crypto_pwhash($OUT, $OUTLEN, $PASSWD, $PASSLEN, $SALT, $OPSLIMIT, $MEMLIMIT,
              $ALG)
          - pattern: crypto_pwhash_str($OUT, $PASSWD, $PASSLEN, $OPSLIMIT, $MEMLIMIT)
          - pattern: crypto_pwhash_str_verify($STR, $PASSWD, $PASSLEN)
          - pattern:
              crypto_pwhash_argon2i($OUT, $OUTLEN, $PASSWD, $PASSLEN, $SALT, $OPSLIMIT,
              $MEMLIMIT, $ALG)
          - pattern:
              crypto_pwhash_argon2id($OUT, $OUTLEN, $PASSWD, $PASSLEN, $SALT, $OPSLIMIT,
              $MEMLIMIT, $ALG)
          - pattern: randombytes($BUF, $SIZE)
          - pattern: randombytes_buf($BUF, $SIZE)
          - pattern: randombytes_random()
          - pattern:
              crypto_aead_chacha20poly1305_encrypt($C, $CLEN, $M, $MLEN, $AD, $ADLEN,
              $NPUB, $K)
          - pattern:
              crypto_aead_chacha20poly1305_decrypt($M, $MLEN, $NPUB, $C, $CLEN, $AD,
              $ADLEN, $K)
          - pattern:
              crypto_aead_aes256gcm_encrypt($C, $CLEN, $M, $MLEN, $AD, $ADLEN, $NPUB,
              $K)
          - pattern:
              crypto_aead_aes256gcm_decrypt($M, $MLEN, $NPUB, $C, $CLEN, $AD, $ADLEN,
              $K)
          - pattern: crypto_box_keypair($PK, $SK)
          - pattern: crypto_sign_keypair($PK, $SK)
          - pattern: crypto_secretbox_keygen($K)
          - pattern:
              crypto_generichash_blake2b_salt_personal($OUT, $OUTLEN, $IN, $INLEN,
              $KEY, $KEYLEN, $SALT, $PERSONAL)
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: libsodium cryptographic library usage detected in codebase"
  - id: cpp-crypto-random-generation
    message: Random number generation for cryptographic use detected
    severity: INFO
    languages:
      - cpp
    patterns:
      - pattern-either:
          - pattern: RAND_bytes($BUF, $NUM)
          - pattern: |
              unsigned char $BUF[$LEN];
              RAND_bytes($BUF, $LEN);
              ...
          - pattern: CryptoPP::AutoSeededRandomPool()
          - pattern: CryptoPP::RandomNumberGenerator()
          - pattern: Botan::RandomNumberGenerator::create("system")
          - pattern: std::random_device()
          - pattern: std::mt19937()
    metadata:
      category: crypto
      cwe: CWE-338
      impact:
        "Inventory: Random number generation for cryptographic use detected in
        codebase"
  - id: cpp-crypto-cipher-twofish
    message: Twofish cipher usage detected
    severity: INFO
    languages:
      - cpp
    patterns:
      - pattern-either:
          - pattern: CryptoPP::Twofish::Encryption($KEY, $KEYLEN)
          - pattern: CryptoPP::Twofish::Decryption($KEY, $KEYLEN)
          - pattern: Botan::Cipher_Mode::create("Twofish/CBC", Botan::ENCRYPTION)
          - pattern: Botan::Cipher_Mode::create("Twofish/GCM", Botan::ENCRYPTION)
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: Twofish cipher usage detected in codebase"
  - id: cpp-crypto-hardcoded-key
    message: Hardcoded cryptographic key detected
    severity: INFO
    languages:
      - cpp
    patterns:
      - pattern-either:
          - pattern: |
              unsigned char $KEY[] = "$STRING";
          - pattern: |
              char $KEY[] = "$STRING";
          - pattern: |
              const unsigned char $KEY[] = "$STRING";
          - pattern: |
              const char $KEY[] = "$STRING";
          - pattern: |
              static unsigned char $KEY[] = "$STRING";
          - pattern: |
              static char $KEY[] = "$STRING";
          - pattern: |
              constexpr unsigned char $KEY[] = "$STRING";
          - pattern: |
              constexpr char $KEY[] = "$STRING";
          - pattern: |
              #define $KEY "$STRING"
          - pattern: |
              unsigned char $KEY[$LEN] = {$BYTES};
          - pattern: |
              const unsigned char $KEY[$LEN] = {$BYTES};
          - pattern: |
              static unsigned char $KEY[$LEN] = {$BYTES};
          - pattern: |
              constexpr unsigned char $KEY[$LEN] = {$BYTES};
          - pattern: |
              std::string $KEY = "$STRING";
          - pattern: |
              const std::string $KEY = "$STRING";
          - pattern: |
              static std::string $KEY = "$STRING";
          - pattern: |
              constexpr std::string $KEY = "$STRING";
          - pattern: |
              std::vector<unsigned char> $KEY = {$BYTES};
          - pattern: |
              const std::vector<unsigned char> $KEY = {$BYTES};
          - pattern: |
              std::array<unsigned char, $SIZE> $KEY = {$BYTES};
          - pattern: |
              const std::array<unsigned char, $SIZE> $KEY = {$BYTES};
          - pattern: |
              constexpr std::array<unsigned char, $SIZE> $KEY = {$BYTES};
    metadata:
      category: crypto
      cwe: CWE-798
      impact: "Inventory: Hardcoded cryptographic key detected in codebase"
  - id: cpp-crypto-rsa
    message: RSA cryptographic operations detected
    severity: INFO
    languages:
      - cpp
    patterns:
      - pattern-either:
          - pattern: RSA_new()
          - patterns:
              - pattern: RSA_generate_key_ex($RSA, $BITS, $E, $BN)
              - metavariable-regex:
                  metavariable: $BITS
                  regex: \d+
              - focus-metavariable: $BITS
          - patterns:
              - pattern: RSA_generate_key($BITS, $E, $CALLBACK, $CALLBACKARG)
              - metavariable-regex:
                  metavariable: $BITS
                  regex: \d+
              - focus-metavariable: $BITS
          - patterns:
              - pattern: EVP_PKEY_Q_keygen($LIBCTX, $PROPS, "RSA", $BITS)
              - metavariable-regex:
                  metavariable: $BITS
                  regex: \d+
              - focus-metavariable: $BITS
          - patterns:
              - pattern: Botan::RSA_PrivateKey($RNG, $BITS)
              - metavariable-regex:
                  metavariable: $BITS
                  regex: \d+
              - focus-metavariable: $BITS
          - pattern: RSA_public_encrypt($FLEN, $FROM, $TO, $RSA, $PADDING)
          - pattern: RSA_private_decrypt($FLEN, $FROM, $TO, $RSA, $PADDING)
          - pattern: RSA_private_encrypt($FLEN, $FROM, $TO, $RSA, $PADDING)
          - pattern: RSA_public_decrypt($FLEN, $FROM, $TO, $RSA, $PADDING)
          - pattern: RSA_sign($TYPE, $M, $MLEN, $SIGRET, $SIGLEN, $RSA)
          - pattern: RSA_verify($TYPE, $M, $MLEN, $SIGBUF, $SIGLEN, $RSA)
          - pattern: EVP_PKEY_new_RSA($RSA)
          - pattern: EVP_PKEY_assign_RSA($PKEY, $RSA)
          - pattern: EVP_PKEY_CTX_new_id(EVP_PKEY_RSA, $ENGINE)
          - pattern: EVP_PKEY_keygen_init($CTX)
          - pattern: EVP_PKEY_keygen($CTX, $PKEY)
          - pattern: EVP_PKEY_fromdata($CTX, $SELECTION, $PARAMS)
          - pattern: EVP_PKEY_Q_keygen($LIBCTX, $PROPS, "RSA-PSS", $BITS)
          - pattern: EVP_PKEY_get0_RSA($PKEY)
          - pattern: CryptoPP::RSA::PrivateKey()
          - pattern: CryptoPP::RSA::PublicKey()
          - pattern: CryptoPP::RSAES_OAEP_SHA_Encryptor($PUBKEY)
          - pattern: CryptoPP::RSAES_OAEP_SHA_Decryptor($PRIVKEY)
          - pattern: CryptoPP::RSASS<CryptoPP::PSS, $HASH>::Signer($PRIVKEY)
          - pattern: CryptoPP::RSASS<CryptoPP::PKCS1v15, $HASH>::Verifier($PUBKEY)
          - pattern: Botan::RSA_PrivateKey($RNG, $BITS)
          - pattern: Botan::RSA_PublicKey($N, $E)
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: RSA cryptographic operations detected in codebase"
  - id: java-crypto-sha1
    message: SHA1 hash function usage detected
    severity: INFO
    languages:
      - java
    patterns:
      - pattern-either:
          - pattern: MessageDigest.getInstance("SHA1")
          - pattern: MessageDigest.getInstance("SHA-1")
          - pattern: MessageDigest.getInstance("SHA1", $PROVIDER)
          - pattern: MessageDigest.getInstance("SHA-1", $PROVIDER)
          - patterns:
              - pattern: MessageDigest.getInstance($ALGO)
              - metavariable-regex:
                  metavariable: $ALGO
                  regex: (?i)^(SHA1|SHA-1)$
              - focus-metavariable: $ALGO
          - pattern: |
              $DIGEST = MessageDigest.getInstance("SHA1");
              $DIGEST.update($DATA);
              $HASH = $DIGEST.digest();
          - pattern: |
              $DIGEST = MessageDigest.getInstance("SHA1", $PROVIDER);
              $DIGEST.update($DATA);
              $HASH = $DIGEST.digest();
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: SHA1 hash function usage detected in codebase"
  - id: java-crypto-cipher-modes
    message: Cipher mode usage detected
    severity: INFO
    languages:
      - java
    patterns:
      - pattern-either:
          - pattern: Cipher.getInstance(".../ECB/...")
          - pattern: Cipher.getInstance(".../CBC/...")
          - pattern: Cipher.getInstance(".../CFB/...")
          - pattern: Cipher.getInstance(".../OFB/...")
          - pattern: Cipher.getInstance(".../CTR/...")
          - pattern: Cipher.getInstance(".../GCM/...")
          - pattern: Cipher.getInstance(".../CCM/...")
          - pattern: Cipher.getInstance(".../XTS/...")
          - pattern: |
              $CIPHER = Cipher.getInstance("AES/CBC/PKCS5Padding");
              $CIPHER.init(Cipher.ENCRYPT_MODE, $KEY, $IV_PARAMS);
          - pattern: |
              $CIPHER = Cipher.getInstance("AES/GCM/NoPadding");
              $CIPHER.init(Cipher.ENCRYPT_MODE, $KEY, $GCM_PARAMS);
          - pattern: |
              $CIPHER = Cipher.getInstance("AES/CFB/NoPadding");
              $CIPHER.init(Cipher.ENCRYPT_MODE, $KEY, $IV_PARAMS);
          - pattern: |
              $CIPHER = Cipher.getInstance("AES/OFB/NoPadding");
              $CIPHER.init(Cipher.ENCRYPT_MODE, $KEY, $IV_PARAMS);
          - pattern: |
              $CIPHER = Cipher.getInstance("AES/CTR/NoPadding");
              $CIPHER.init(Cipher.ENCRYPT_MODE, $KEY, $IV_PARAMS);
          - pattern: |
              $CIPHER = Cipher.getInstance("AES/CCM/NoPadding");
              $CIPHER.init(Cipher.ENCRYPT_MODE, $KEY, $CCM_PARAMS);
          - pattern: |
              $CIPHER = Cipher.getInstance("AES/XTS/NoPadding");
              $CIPHER.init(Cipher.ENCRYPT_MODE, $KEY);
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: Cipher mode usage detected in codebase"
  - id: java-crypto-tls-cipher-suites
    message: TLS cipher suite configuration detected
    severity: INFO
    languages:
      - java
    patterns:
      - pattern-either:
          - pattern: SSLContext.getInstance("TLS").getDefaultSSLParameters().setCipherSuites($SUITES)
          - pattern: $SSL_PARAMS.setCipherSuites($SUITES)
          - pattern: |
              $CONTEXT = SSLContext.getInstance("TLS");
              $PARAMS = $CONTEXT.getDefaultSSLParameters();
              $PARAMS.setCipherSuites($SUITES);
          - pattern: |
              $CONTEXT = SSLContext.getInstance("TLS");
              $ENGINE = $CONTEXT.createSSLEngine();
              $ENGINE.setEnabledCipherSuites($SUITES);
          - pattern: |
              $CONTEXT = SSLContext.getInstance("TLS");
              $SOCKET_FACTORY = $CONTEXT.getSocketFactory();
              $SOCKET = $SOCKET_FACTORY.createSocket($HOST, $PORT);
              $SSL_SOCKET = ($SOCKET instanceof SSLSocket) ? (SSLSocket) $SOCKET : null;
              if ($SSL_SOCKET != null) {
                  $SSL_SOCKET.setEnabledCipherSuites($SUITES);
              }
          - pattern: |
              $SERVER_SOCKET_FACTORY = $CONTEXT.getServerSocketFactory();
              $SERVER_SOCKET = $SERVER_SOCKET_FACTORY.createServerSocket($PORT);
              if ($SERVER_SOCKET instanceof SSLServerSocket) {
                  ((SSLServerSocket) $SERVER_SOCKET).setEnabledCipherSuites($SUITES);
              }
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: TLS cipher suite configuration detected in codebase"
  - id: java-crypto-cipher-aes
    message: AES cipher usage detected
    severity: INFO
    languages:
      - java
    patterns:
      - pattern-either:
          - pattern: Cipher.getInstance("AES")
          - pattern: Cipher.getInstance("AES/CBC/PKCS5Padding")
          - pattern: Cipher.getInstance("AES/GCM/NoPadding")
          - pattern: Cipher.getInstance("AES/ECB/PKCS5Padding")
          - pattern: Cipher.getInstance("AES/CFB/NoPadding")
          - pattern: Cipher.getInstance("AES/OFB/NoPadding")
          - pattern: Cipher.getInstance("AES/CTR/NoPadding")
          - pattern: Cipher.getInstance("AES/CCM/NoPadding")
          - pattern: Cipher.getInstance("AES/XTS/NoPadding")
          - pattern: KeyGenerator.getInstance("AES")
          - pattern: |
              $CIPHER = Cipher.getInstance("AES/GCM/NoPadding");
              $CIPHER.init(Cipher.ENCRYPT_MODE, $KEY, $PARAMS);
              $CIPHERTEXT = $CIPHER.doFinal($PLAINTEXT);
          - pattern: |
              $GEN = KeyGenerator.getInstance("AES");
              $GEN.init($BITS);
              $KEY = $GEN.generateKey();
          - patterns:
              - pattern: $GEN.init($BITS)
              - metavariable-regex:
                  metavariable: $BITS
                  regex: \d+
              - focus-metavariable: $BITS
          - patterns:
              - pattern: Cipher.getInstance($ALGO)
              - metavariable-regex:
                  metavariable: $ALGO
                  regex: '"AES[^"]*"'
              - focus-metavariable: $ALGO
          - pattern: |
              $CIPHER = Cipher.getInstance("AES");
              $CIPHER.init(Cipher.WRAP_MODE, $KEY);
              $WRAPPED = $CIPHER.wrap($KEY_TO_WRAP);
          - pattern: |
              $CIPHER = Cipher.getInstance("AES");
              $CIPHER.init(Cipher.UNWRAP_MODE, $KEY);
              $UNWRAPPED = $CIPHER.unwrap($WRAPPED_KEY, "AES", Cipher.SECRET_KEY);
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: AES cipher usage detected in codebase"
  - id: java-crypto-md5
    message: MD5 hash function usage detected
    severity: INFO
    languages:
      - java
    patterns:
      - pattern-either:
          - pattern: MessageDigest.getInstance("MD5")
          - pattern: MessageDigest.getInstance("md5")
          - pattern: MessageDigest.getInstance("MD5", $PROVIDER)
          - pattern: MessageDigest.getInstance("md5", $PROVIDER)
          - patterns:
              - pattern: MessageDigest.getInstance($ALGO)
              - metavariable-regex:
                  metavariable: $ALGO
                  regex: (?i)^(MD5|md5)$
              - focus-metavariable: $ALGO
          - pattern: |
              $DIGEST = MessageDigest.getInstance("MD5");
              $DIGEST.update($DATA);
              $HASH = $DIGEST.digest();
          - pattern: |
              $DIGEST = MessageDigest.getInstance("MD5");
              ...
              $HASH = $DIGEST.digest();
          - pattern: |
              $DIGEST = MessageDigest.getInstance("MD5", $PROVIDER);
              $DIGEST.update($DATA);
              $HASH = $DIGEST.digest();
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: MD5 hash function usage detected in codebase"
  - id: java-crypto-password-hashing
    message: Password hashing operations detected
    severity: INFO
    languages:
      - java
    patterns:
      - pattern-either:
          - pattern: BCrypt.hashpw($PASSWORD, $SALT)
          - pattern: BCrypt.checkpw($PASSWORD, $HASH)
          - pattern: BCrypt.gensalt($ROUNDS)
          - pattern: BCrypt.gensalt()
          - pattern: SecretKeyFactory.getInstance("PBKDF2WithHmacSHA256")
          - pattern: |
              $HASH = BCrypt.hashpw($PASSWORD, BCrypt.gensalt());
              ...
              BCrypt.checkpw($INPUT, $HASH);
          - patterns:
              - pattern: BCrypt.gensalt($ROUNDS)
              - metavariable-regex:
                  metavariable: $ROUNDS
                  regex: \d+
              - focus-metavariable: $ROUNDS
          - pattern: |
              $FACTORY = SecretKeyFactory.getInstance("PBKDF2WithHmacSHA256");
              $SPEC = new PBEKeySpec($PASSWORD, $SALT, $ITER, $KEYLEN);
              $KEY = $FACTORY.generateSecret($SPEC);
          - patterns:
              - pattern: new PBEKeySpec($PASSWORD, $SALT, $ITER, $KEYLEN)
              - metavariable-regex:
                  metavariable: $ITER
                  regex: \d+
              - metavariable-regex:
                  metavariable: $KEYLEN
                  regex: \d+
    metadata:
      category: crypto
      cwe: CWE-326
      impact: "Inventory: Password hashing operations detected in codebase"
  - id: java-crypto-sha3
    message: SHA3 hash function usage detected
    severity: INFO
    languages:
      - java
    patterns:
      - pattern-either:
          - pattern: MessageDigest.getInstance("SHA3-224")
          - pattern: MessageDigest.getInstance("SHA3-256")
          - pattern: MessageDigest.getInstance("SHA3-384")
          - pattern: MessageDigest.getInstance("SHA3-512")
          - pattern: MessageDigest.getInstance("SHA3-224", $PROVIDER)
          - pattern: MessageDigest.getInstance("SHA3-256", $PROVIDER)
          - pattern: MessageDigest.getInstance("SHA3-384", $PROVIDER)
          - pattern: MessageDigest.getInstance("SHA3-512", $PROVIDER)
          - patterns:
              - pattern: MessageDigest.getInstance($ALGO)
              - metavariable-regex:
                  metavariable: $ALGO
                  regex: (?i)^(SHA3-224|SHA3-256|SHA3-384|SHA3-512)$
              - focus-metavariable: $ALGO
          - pattern: |
              $DIGEST = MessageDigest.getInstance("SHA3-256");
              $DIGEST.update($DATA);
              $HASH = $DIGEST.digest();
          - pattern: |
              $DIGEST = MessageDigest.getInstance("SHA3-512");
              ...
              $HASH = $DIGEST.digest();
          - pattern: |
              $DIGEST = MessageDigest.getInstance("SHA3-384");
              $DIGEST.update($DATA);
              $BYTES = $DIGEST.digest();
              $HEX = DatatypeConverter.printHexBinary($BYTES);
          - pattern: |
              $DIGEST = MessageDigest.getInstance("SHA3-256", $PROVIDER);
              $DIGEST.update($DATA);
              $HASH = $DIGEST.digest();
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: SHA3 hash function usage detected in codebase"
  - id: java-crypto-digital-signatures
    message: Digital signature operations detected
    severity: INFO
    languages:
      - java
    patterns:
      - pattern-either:
          - pattern: Signature.getInstance("SHA256withRSA")
          - pattern: Signature.getInstance("SHA512withRSA")
          - pattern: Signature.getInstance("SHA256withRSA/PSS")
          - pattern: Signature.getInstance("SHA512withRSA/PSS")
          - pattern: Signature.getInstance("SHA256withECDSA")
          - pattern: Signature.getInstance("SHA512withECDSA")
          - pattern: Signature.getInstance("SHA256withDSA")
          - pattern: Signature.getInstance("SHA512withDSA")
          - pattern: Signature.getInstance("Ed25519")
          - pattern: Signature.getInstance("Ed448")
          - patterns:
              - pattern: Signature.getInstance($ALGO)
              - metavariable-regex:
                  metavariable: $ALGO
                  regex: '"(SHA[0-9]+with(RSA|ECDSA|DSA)|Ed25519|Ed448)"'
              - focus-metavariable: $ALGO
          - pattern: |
              $SIG = Signature.getInstance("SHA256withRSA");
              $SIG.initSign($PRIV_KEY);
              $SIG.update($DATA);
              $SIGNATURE = $SIG.sign();
          - pattern: |
              $SIG = Signature.getInstance("SHA256withRSA");
              $SIG.initVerify($PUB_KEY);
              $SIG.update($DATA);
              $VERIFIED = $SIG.verify($SIGNATURE);
          - pattern: |
              $SIG = Signature.getInstance("SHA256withECDSA");
              $SIG.initSign($PRIV_KEY);
              $SIG.update($DATA);
              $SIGNATURE = $SIG.sign();
          - pattern: |
              $SIG = Signature.getInstance("SHA256withRSA/PSS");
              $SIG.initSign($PRIV_KEY);
              $SIG.update($DATA);
              $SIGNATURE = $SIG.sign();
          - pattern: |
              $SIG = Signature.getInstance("Ed25519");
              $SIG.initSign($PRIV_KEY);
              $SIG.update($DATA);
              $SIGNATURE = $SIG.sign();
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: Digital signature operations detected in codebase"
  - id: java-crypto-key-length
    message: Cryptographic key length usage detected
    severity: INFO
    languages:
      - java
    patterns:
      - pattern-either:
          - pattern: |
              $GEN = KeyGenerator.getInstance("AES");
              $GEN.init($BITS);
              $KEY = $GEN.generateKey();
          - pattern: |
              $GEN = KeyGenerator.getInstance("DES");
              $GEN.init($BITS);
              $KEY = $GEN.generateKey();
          - pattern: |
              $GEN = KeyPairGenerator.getInstance("RSA");
              $GEN.initialize($BITS);
              $PAIR = $GEN.generateKeyPair();
          - pattern: |
              $GEN = KeyPairGenerator.getInstance("EC");
              $GEN.initialize($BITS);
              $PAIR = $GEN.generateKeyPair();
          - patterns:
              - pattern: $GEN.init($BITS)
              - metavariable-regex:
                  metavariable: $BITS
                  regex: \d+
              - focus-metavariable: $BITS
          - patterns:
              - pattern: $GEN.initialize($BITS)
              - metavariable-regex:
                  metavariable: $BITS
                  regex: \d+
              - focus-metavariable: $BITS
          - pattern: |
              $KEY = new SecretKeySpec($BYTES, "AES");
              ...
              $LEN = $BYTES.length;
          - patterns:
              - pattern: new SecretKeySpec(new byte[$SIZE], "AES")
              - metavariable-regex:
                  metavariable: $SIZE
                  regex: \d+
              - focus-metavariable: $SIZE
    metadata:
      category: crypto
      cwe: CWE-326
      impact: "Inventory: Cryptographic key length usage detected in codebase"
  - id: java-crypto-cipher-3des
    message: 3DES cipher usage detected
    severity: INFO
    languages:
      - java
    patterns:
      - pattern-either:
          - pattern: Cipher.getInstance("DESede")
          - pattern: Cipher.getInstance("TripleDES")
          - pattern: Cipher.getInstance("DESede/CBC/PKCS5Padding")
          - pattern: Cipher.getInstance("DESede/ECB/PKCS5Padding")
          - pattern: Cipher.getInstance("DESede/CFB/PKCS5Padding")
          - pattern: Cipher.getInstance("DESede/OFB/PKCS5Padding")
          - pattern: |
              $CIPHER = Cipher.getInstance("DESede");
              $CIPHER.init(Cipher.ENCRYPT_MODE, $KEY);
              $CIPHERTEXT = $CIPHER.doFinal($PLAINTEXT);
          - pattern: |
              $CIPHER = Cipher.getInstance("DESede/CBC/PKCS5Padding");
              $CIPHER.init(Cipher.ENCRYPT_MODE, $KEY, $IV_PARAMS);
              $CIPHERTEXT = $CIPHER.doFinal($PLAINTEXT);
          - pattern: |
              $CIPHER = Cipher.getInstance("TripleDES");
              $CIPHER.init(Cipher.DECRYPT_MODE, $KEY);
              $PLAINTEXT = $CIPHER.doFinal($CIPHERTEXT);
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: 3DES cipher usage detected in codebase"
  - id: java-crypto-sha512
    message: SHA512 hash function usage detected
    severity: INFO
    languages:
      - java
    patterns:
      - pattern-either:
          - pattern: MessageDigest.getInstance("SHA-512")
          - pattern: MessageDigest.getInstance("SHA512")
          - pattern: MessageDigest.getInstance("SHA512/224")
          - pattern: MessageDigest.getInstance("SHA512/256")
          - pattern: MessageDigest.getInstance("SHA-512", $PROVIDER)
          - pattern: MessageDigest.getInstance("SHA512", $PROVIDER)
          - patterns:
              - pattern: MessageDigest.getInstance($ALGO)
              - metavariable-regex:
                  metavariable: $ALGO
                  regex: (?i)^(SHA-512|SHA512|SHA512/224|SHA512/256)$
              - focus-metavariable: $ALGO
          - pattern: |
              $DIGEST = MessageDigest.getInstance("SHA-512");
              $DIGEST.update($DATA);
              $HASH = $DIGEST.digest();
          - pattern: |
              $DIGEST = MessageDigest.getInstance("SHA512");
              ...
              $HASH = $DIGEST.digest();
          - pattern: |
              $DIGEST = MessageDigest.getInstance("SHA-512");
              $DIGEST.update($DATA);
              $BYTES = $DIGEST.digest();
              $HEX = DatatypeConverter.printHexBinary($BYTES);
          - pattern: |
              $DIGEST = MessageDigest.getInstance("SHA-512");
              $DIGEST.update($DATA);
              $BYTES = $DIGEST.digest();
              $BASE64 = Base64.getEncoder().encodeToString($BYTES);
          - pattern: |
              $DIGEST = MessageDigest.getInstance("SHA-512", $PROVIDER);
              $DIGEST.update($DATA);
              $HASH = $DIGEST.digest();
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: SHA512 hash function usage detected in codebase"
  - id: java-crypto-hardcoded-key
    message: Hardcoded cryptographic key detected
    severity: INFO
    languages:
      - java
    taint-mode:
      source:
        - pattern-either:
            - pattern: $KEY = "$VALUE"
            - pattern: $KEY = '$VALUE'
            - pattern: private static final String $KEY = "$VALUE"
            - pattern: private static final String $KEY = '$VALUE'
            - pattern: final String $KEY = "$VALUE"
            - pattern: final String $KEY = '$VALUE'
            - pattern: private static final byte[] $KEY = {$BYTES}
            - pattern: final byte[] $KEY = {$BYTES}
      sink:
        - pattern: new SecretKeySpec($KEY.getBytes(), $ALGO)
        - pattern: new SecretKeySpec($KEY, $ALGO)
        - pattern: new SecretKeySpec("$KEY".getBytes(), $ALGO)
        - pattern: new SecretKeySpec(new byte[] {$KEY}, $ALGO)
    patterns:
      - pattern-either:
          - pattern: new SecretKeySpec("$KEY".getBytes(), "AES")
          - pattern: new SecretKeySpec($KEY.getBytes(), "AES")
          - pattern: new SecretKeySpec("$KEY".getBytes(), $ALGO)
          - pattern: new SecretKeySpec($KEY.getBytes(), $ALGO)
          - pattern: new SecretKeySpec(new byte[] {$BYTES}, "AES")
          - pattern: new SecretKeySpec(new byte[] {$BYTES}, $ALGO)
          - pattern: |
              private static final String $KEY = "$VALUE";
              ...
              new SecretKeySpec($KEY.getBytes(), "AES");
          - pattern: |
              private static final byte[] $KEY = {$BYTES};
              ...
              new SecretKeySpec($KEY, "AES");
          - pattern: |
              final String $KEY = "$VALUE";
              ...
              new SecretKeySpec($KEY.getBytes(), "AES");
    metadata:
      category: crypto
      cwe: CWE-798
      impact: "Inventory: Hardcoded cryptographic key detected in codebase"
  - id: java-crypto-tls-version
    message: TLS version configuration detected
    severity: INFO
    languages:
      - java
    patterns:
      - pattern-either:
          - pattern: SSLContext.getInstance("TLSv1")
          - pattern: SSLContext.getInstance("TLSv1.1")
          - pattern: SSLContext.getInstance("TLSv1.2")
          - pattern: SSLContext.getInstance("TLSv1.3")
          - pattern: SSLContext.getInstance("SSL")
          - pattern: SSLContext.getInstance("SSLv3")
          - pattern: |
              $CONTEXT = SSLContext.getInstance("TLSv1.2");
              $CONTEXT.init($KEY_MANAGERS, $TRUST_MANAGERS, $RAND);
          - patterns:
              - pattern: SSLContext.getInstance($PROTOCOL)
              - metavariable-regex:
                  metavariable: $PROTOCOL
                  regex: '"(TLSv1(\.[0-3])?|SSLv3|SSL)"'
              - focus-metavariable: $PROTOCOL
          - pattern: System.setProperty("https.protocols", "TLSv1.2")
          - patterns:
              - pattern: System.setProperty("https.protocols", $PROTOCOLS)
              - metavariable-regex:
                  metavariable: $PROTOCOLS
                  regex: '"[^"]*"'
              - focus-metavariable: $PROTOCOLS
          - pattern: |
              System.setProperty("https.protocols", "TLSv1.2");
              ...
              $CONNECTION = new java.net.URL("https://example.com").openConnection();
          - pattern: |
              $FACTORY = SSLSocketFactory.getDefault();
              $SOCKET = $FACTORY.createSocket($HOST, $PORT);
              $SSL_SOCKET = (SSLSocket) $SOCKET;
              $SSL_SOCKET.setEnabledProtocols($PROTOCOLS);
          - pattern: |
              $SOCKET = $FACTORY.createSocket($HOST, $PORT);
              if ($SOCKET instanceof SSLSocket) {
                  ((SSLSocket) $SOCKET).setEnabledProtocols($PROTOCOLS);
              }
          - patterns:
              - pattern: $SSL_SOCKET.setEnabledProtocols($PROTOCOLS)
              - metavariable-regex:
                  metavariable: $PROTOCOLS
                  regex: new String\[\] \{.*\}
              - focus-metavariable: $PROTOCOLS
          - pattern: SSLSocket.setEnabledProtocols($PROTOCOLS)
          - pattern: SSLServerSocket.setEnabledProtocols($PROTOCOLS)
          - pattern: |
              $SERVER_SOCKET = $FACTORY.createServerSocket($PORT);
              if ($SERVER_SOCKET instanceof SSLServerSocket) {
                  ((SSLServerSocket) $SERVER_SOCKET).setEnabledProtocols($PROTOCOLS);
              }
          - pattern: |
              $CONNECTION = (HttpsURLConnection) $URL.openConnection();
              $CONNECTION.setSSLSocketFactory($FACTORY);
          - pattern: |
              $PARAMS = $CONTEXT.getDefaultSSLParameters();
              $PARAMS.setProtocols($PROTOCOLS);
          - patterns:
              - pattern: SSLParameters.setProtocols($PROTOCOLS)
              - metavariable-regex:
                  metavariable: $PROTOCOLS
                  regex: new String\[\] \{.*\}
              - focus-metavariable: $PROTOCOLS
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: TLS version configuration detected in codebase"
  - id: java-crypto-diffie-hellman
    message: Diffie-Hellman key exchange usage detected
    severity: INFO
    languages:
      - java
    patterns:
      - pattern-either:
          - pattern: KeyPairGenerator.getInstance("DH")
          - pattern: KeyAgreement.getInstance("DH")
          - pattern: KeyAgreement.getInstance("DiffieHellman")
          - pattern: |
              $GEN = KeyPairGenerator.getInstance("DH");
              $GEN.initialize($PARAMS);
              $PAIR = $GEN.generateKeyPair();
          - pattern: |
              $AGREEMENT = KeyAgreement.getInstance("DH");
              $AGREEMENT.init($PRIV_KEY);
              $AGREEMENT.doPhase($PUB_KEY, true);
              $SECRET = $AGREEMENT.generateSecret();
          - pattern: |
              $AGREEMENT = KeyAgreement.getInstance("DiffieHellman");
              $AGREEMENT.init($PRIV_KEY);
              $AGREEMENT.doPhase($PUB_KEY, true);
              $SECRET = $AGREEMENT.generateSecret($ALGO);
          - pattern: |
              $AGREEMENT = KeyAgreement.getInstance("DH");
              $AGREEMENT.init($PRIV_KEY);
              $AGREEMENT.doPhase($PUB_KEY, true);
              $SECRET_KEY = $AGREEMENT.generateSecret($ALGO);
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: Diffie-Hellman key exchange usage detected in codebase"
  - id: java-crypto-key-derivation
    message: Key derivation function usage detected
    severity: INFO
    languages:
      - java
    patterns:
      - pattern-either:
          - pattern: SecretKeyFactory.getInstance("PBKDF2WithHmacSHA1")
          - pattern: SecretKeyFactory.getInstance("PBKDF2WithHmacSHA256")
          - pattern: SecretKeyFactory.getInstance("PBKDF2WithHmacSHA384")
          - pattern: SecretKeyFactory.getInstance("PBKDF2WithHmacSHA512")
          - pattern: |
              $FACTORY = SecretKeyFactory.getInstance("PBKDF2WithHmacSHA256");
              $SPEC = new PBEKeySpec($PASSWORD, $SALT, $ITER, $KEYLEN);
              $KEY = $FACTORY.generateSecret($SPEC);
          - pattern: |
              $FACTORY = SecretKeyFactory.getInstance("PBKDF2WithHmacSHA512");
              $SPEC = new PBEKeySpec($PASSWORD, $SALT, $ITER, $KEYLEN);
              $KEY = $FACTORY.generateSecret($SPEC);
          - patterns:
              - pattern: new PBEKeySpec($PASSWORD, $SALT, $ITER, $KEYLEN)
              - metavariable-regex:
                  metavariable: $ITER
                  regex: \d+
              - metavariable-regex:
                  metavariable: $KEYLEN
                  regex: \d+
              - focus-metavariable: $ITER
    metadata:
      category: crypto
      cwe: CWE-326
      impact: "Inventory: Key derivation function usage detected in codebase"
  - id: java-crypto-certificate-validation
    message: Certificate validation configuration detected
    severity: INFO
    languages:
      - java
    patterns:
      - pattern-either:
          - pattern: $TRUST_MANAGER.checkClientTrusted($CHAIN, $AUTH_TYPE)
          - pattern: $TRUST_MANAGER.checkServerTrusted($CHAIN, $AUTH_TYPE)
          - pattern: |
              class $CLASS implements X509TrustManager {
                  public void checkClientTrusted(X509Certificate[] $CHAIN, String $AUTH_TYPE) {
                      ...
                  }
                  public void checkServerTrusted(X509Certificate[] $CHAIN, String $AUTH_TYPE) {
                      ...
                  }
              }
          - pattern: |
              $TRUST_MANAGER = new X509TrustManager() {
                  public void checkClientTrusted(X509Certificate[] $CHAIN, String $AUTH_TYPE) {
                      ...
                  }
                  public void checkServerTrusted(X509Certificate[] $CHAIN, String $AUTH_TYPE) {
                      ...
                  }
              };
          - pattern: |
              $TRUST_MANAGER = new X509TrustManager() {
                  public void checkClientTrusted(X509Certificate[] $CHAIN, String $AUTH_TYPE) throws CertificateException {
                      ...
                  }
                  public void checkServerTrusted(X509Certificate[] $CHAIN, String $AUTH_TYPE) throws CertificateException {
                      ...
                  }
              };
          - pattern: |
              $HOSTNAME_VERIFIER = new HostnameVerifier() {
                  public boolean verify(String $HOSTNAME, SSLSession $SESSION) {
                      return true;
                  }
              };
          - pattern: HttpsURLConnection.setDefaultHostnameVerifier($VERIFIER)
          - pattern: $CONNECTION.setHostnameVerifier($VERIFIER)
    metadata:
      category: crypto
      cwe: CWE-295
      impact: "Inventory: Certificate validation configuration detected in codebase"
  - id: java-crypto-cipher-des
    message: DES cipher usage detected
    severity: INFO
    languages:
      - java
    patterns:
      - pattern-either:
          - pattern: Cipher.getInstance("DES")
          - pattern: Cipher.getInstance("DES/ECB/PKCS5Padding")
          - pattern: Cipher.getInstance("DES/CBC/PKCS5Padding")
          - pattern: Cipher.getInstance("DESede")
          - pattern: Cipher.getInstance("TripleDES")
          - pattern: |
              $CIPHER = Cipher.getInstance("DES");
              $CIPHER.init(Cipher.ENCRYPT_MODE, $KEY);
              $CIPHERTEXT = $CIPHER.doFinal($PLAINTEXT);
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: DES cipher usage detected in codebase"
  - id: java-crypto-cipher-rc4
    message: RC4 cipher usage detected
    severity: INFO
    languages:
      - java
    patterns:
      - pattern-either:
          - pattern: Cipher.getInstance("RC4")
          - pattern: Cipher.getInstance("ARCFOUR")
          - pattern: Cipher.getInstance("ARC4")
          - pattern: |
              $CIPHER = Cipher.getInstance("RC4");
              $CIPHER.init(Cipher.ENCRYPT_MODE, $KEY);
              $CIPHERTEXT = $CIPHER.doFinal($PLAINTEXT);
          - pattern: |
              $CIPHER = Cipher.getInstance("ARCFOUR");
              $CIPHER.init(Cipher.ENCRYPT_MODE, $KEY);
              $CIPHERTEXT = $CIPHER.doFinal($PLAINTEXT);
          - pattern: |
              $CIPHER = Cipher.getInstance("ARC4");
              $CIPHER.init(Cipher.DECRYPT_MODE, $KEY);
              $PLAINTEXT = $CIPHER.doFinal($CIPHERTEXT);
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: RC4 cipher usage detected in codebase"
  - id: java-crypto-random-generation
    message: Random number generation for cryptographic use detected
    severity: INFO
    languages:
      - java
    patterns:
      - pattern-either:
          - pattern: SecureRandom.getInstance($ALGO)
          - pattern: SecureRandom.getInstanceStrong()
          - pattern: new SecureRandom()
          - pattern: |
              $RAND = SecureRandom.getInstance("SHA1PRNG");
              $BYTES = new byte[$LENGTH];
              $RAND.nextBytes($BYTES);
          - pattern: |
              $RAND = new SecureRandom();
              $RAND.nextBytes($BYTES);
          - pattern: |
              $RAND = SecureRandom.getInstance($ALGO);
              $RAND.setSeed($SEED);
          - pattern: |
              $RAND = new SecureRandom();
              $RAND.setSeed($SEED);
          - pattern: SecureRandom.generateSeed($LENGTH)
          - pattern: |
              $RAND = SecureRandom.getInstance($ALGO);
              $SEED = $RAND.generateSeed($LENGTH);
          - patterns:
              - pattern: SecureRandom.getInstance($ALGO)
              - metavariable-regex:
                  metavariable: $ALGO
                  regex: (?i)(SHA1PRNG|NativePRNG|Windows-PRNG|DRBG|PKCS11)
          - pattern: new Random()
          - pattern: Math.random()
    metadata:
      category: crypto
      cwe: CWE-338
      impact:
        "Inventory: Random number generation for cryptographic use detected in
        codebase"
  - id: java-crypto-blake2
    message: BLAKE2 hash function usage detected
    severity: INFO
    languages:
      - java
    patterns:
      - pattern-either:
          - pattern: MessageDigest.getInstance("BLAKE2B-512")
          - pattern: MessageDigest.getInstance("BLAKE2B-256")
          - pattern: MessageDigest.getInstance("BLAKE2S-256")
          - pattern: MessageDigest.getInstance("BLAKE2B-512", $PROVIDER)
          - pattern: MessageDigest.getInstance("BLAKE2B-256", $PROVIDER)
          - pattern: MessageDigest.getInstance("BLAKE2S-256", $PROVIDER)
          - patterns:
              - pattern: MessageDigest.getInstance($ALGO)
              - metavariable-regex:
                  metavariable: $ALGO
                  regex: (?i)^(BLAKE2B-512|BLAKE2B-256|BLAKE2S-256)$
              - focus-metavariable: $ALGO
          - pattern: |
              $DIGEST = MessageDigest.getInstance("BLAKE2B-512");
              $DIGEST.update($DATA);
              $HASH = $DIGEST.digest();
          - pattern: |
              $DIGEST = MessageDigest.getInstance("BLAKE2B-256");
              ...
              $HASH = $DIGEST.digest();
          - pattern: |
              $DIGEST = MessageDigest.getInstance("BLAKE2S-256");
              $DIGEST.update($DATA);
              $BYTES = $DIGEST.digest();
          - pattern: |
              $DIGEST = MessageDigest.getInstance("BLAKE2B-512", $PROVIDER);
              $DIGEST.update($DATA);
              $HASH = $DIGEST.digest();
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: BLAKE2 hash function usage detected in codebase"
  - id: java-crypto-cipher-blowfish
    message: Blowfish cipher usage detected
    severity: INFO
    languages:
      - java
    patterns:
      - pattern-either:
          - pattern: Cipher.getInstance("Blowfish")
          - pattern: Cipher.getInstance("Blowfish/CBC/PKCS5Padding")
          - pattern: Cipher.getInstance("Blowfish/ECB/PKCS5Padding")
          - pattern: Cipher.getInstance("Blowfish/CFB/PKCS5Padding")
          - pattern: Cipher.getInstance("Blowfish/OFB/PKCS5Padding")
          - pattern: |
              $CIPHER = Cipher.getInstance("Blowfish");
              $CIPHER.init(Cipher.ENCRYPT_MODE, $KEY);
              $CIPHERTEXT = $CIPHER.doFinal($PLAINTEXT);
          - pattern: |
              $CIPHER = Cipher.getInstance("Blowfish/CBC/PKCS5Padding");
              $CIPHER.init(Cipher.ENCRYPT_MODE, $KEY, $IV_PARAMS);
              $CIPHERTEXT = $CIPHER.doFinal($PLAINTEXT);
          - pattern: |
              $CIPHER = Cipher.getInstance("Blowfish/ECB/PKCS5Padding");
              $CIPHER.init(Cipher.DECRYPT_MODE, $KEY);
              $PLAINTEXT = $CIPHER.doFinal($CIPHERTEXT);
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: Blowfish cipher usage detected in codebase"
  - id: java-crypto-ecdsa
    message: ECDSA cryptographic operations detected
    severity: INFO
    languages:
      - java
    patterns:
      - pattern-either:
          - pattern: KeyPairGenerator.getInstance("EC")
          - pattern: KeyPairGenerator.getInstance("ECDSA")
          - pattern: Signature.getInstance("SHA256withECDSA")
          - pattern: Signature.getInstance("SHA512withECDSA")
          - patterns:
              - pattern: |
                  $GEN = KeyPairGenerator.getInstance("EC");
                  $GEN.initialize($CURVE_PARAMS);
                  $PAIR = $GEN.generateKeyPair();
              - focus-metavariable: $CURVE_PARAMS
          - pattern: |
              $SIG = Signature.getInstance("SHA256withECDSA");
              $SIG.initSign($PRIV_KEY);
              $SIG.update($DATA);
              $SIGNATURE = $SIG.sign();
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: ECDSA cryptographic operations detected in codebase"
  - id: java-crypto-bouncycastle
    message: BouncyCastle cryptographic library usage detected
    severity: INFO
    languages:
      - java
    patterns:
      - pattern-either:
          - pattern: Security.addProvider(new BouncyCastleProvider())
          - pattern: Security.insertProviderAt(new BouncyCastleProvider(), $POSITION)
          - pattern: Security.addProvider($PROVIDER)
          - pattern: |
              $PROVIDER = new BouncyCastleProvider();
              Security.addProvider($PROVIDER);
          - pattern: |
              $PROVIDER = new BouncyCastleProvider();
              Security.insertProviderAt($PROVIDER, $POSITION);
          - pattern: MessageDigest.getInstance("MD4")
          - pattern: MessageDigest.getInstance("MD4", $PROVIDER)
          - pattern: MessageDigest.getInstance("MD2")
          - pattern: MessageDigest.getInstance("MD2", $PROVIDER)
          - pattern: Cipher.getInstance("Twofish")
          - pattern: Cipher.getInstance("Twofish/CBC/PKCS5Padding")
          - pattern: Cipher.getInstance("Camellia")
          - pattern: Cipher.getInstance("Camellia/CBC/PKCS5Padding")
          - pattern: Cipher.getInstance("ChaCha20")
          - pattern: Cipher.getInstance("ChaCha20-Poly1305")
          - pattern: Cipher.getInstance("Salsa20")
          - pattern: KeyPairGenerator.getInstance("ElGamal")
          - pattern: |
              $PROVIDER = new BouncyCastleProvider();
              Security.addProvider($PROVIDER);
              $CIPHER = Cipher.getInstance("Twofish", $PROVIDER);
          - pattern: |
              $PROVIDER = new BouncyCastleProvider();
              Security.addProvider($PROVIDER);
              $DIGEST = MessageDigest.getInstance("MD4", $PROVIDER);
          - patterns:
              - pattern: MessageDigest.getInstance($ALGO)
              - metavariable-regex:
                  metavariable: $ALGO
                  regex: (?i)^(MD4|MD2)$
          - patterns:
              - pattern: Cipher.getInstance($ALGO)
              - metavariable-regex:
                  metavariable: $ALGO
                  regex: (?i)^(Twofish|Camellia|ChaCha20|Salsa20|ChaCha20-Poly1305)
          - patterns:
              - pattern: KeyPairGenerator.getInstance($ALGO)
              - metavariable-regex:
                  metavariable: $ALGO
                  regex: (?i)^(ElGamal)$
          - pattern: org.bouncycastle.jce.provider.BouncyCastleProvider
          - pattern: new org.bouncycastle.jce.provider.BouncyCastleProvider()
          - pattern: org.bouncycastle.crypto.digests.MD4Digest
          - pattern: org.bouncycastle.crypto.digests.MD2Digest
          - pattern: org.bouncycastle.crypto.digests.SHA3Digest
          - pattern: org.bouncycastle.crypto.engines.TwofishEngine
          - pattern: org.bouncycastle.crypto.engines.CamelliaEngine
          - pattern: org.bouncycastle.crypto.engines.ChaCha7539Engine
          - pattern: org.bouncycastle.crypto.engines.Salsa20Engine
          - pattern: org.bouncycastle.crypto.engines.ElGamalEngine
          - pattern: org.bouncycastle.crypto.generators.Argon2BytesGenerator
          - pattern: org.bouncycastle.crypto.generators.SCrypt
          - pattern: org.bouncycastle.crypto.macs.HMac
          - pattern: org.bouncycastle.crypto.prng.DigestRandomGenerator
          - pattern: |
              $DIGEST = new org.bouncycastle.crypto.digests.MD4Digest();
              $DIGEST.update($DATA, 0, $DATA.length);
              $HASH = new byte[$DIGEST.getDigestSize()];
              $DIGEST.doFinal($HASH, 0);
          - pattern: |
              $ENGINE = new org.bouncycastle.crypto.engines.TwofishEngine();
              $CIPHER = new org.bouncycastle.crypto.modes.CBCBlockCipher($ENGINE);
              $CIPHER.init(true, $PARAMS);
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: BouncyCastle cryptographic library usage detected in codebase"
  - id: java-crypto-rsa
    message: RSA cryptographic operations detected
    severity: INFO
    languages:
      - java
    patterns:
      - pattern-either:
          - pattern: KeyPairGenerator.getInstance("RSA")
          - pattern: Cipher.getInstance("RSA")
          - pattern: Cipher.getInstance("RSA/ECB/PKCS1Padding")
          - pattern: Cipher.getInstance("RSA/ECB/OAEPWithSHA-256AndMGF1Padding")
          - pattern: |
              $GEN = KeyPairGenerator.getInstance("RSA");
              $GEN.initialize($BITS);
              $PAIR = $GEN.generateKeyPair();
          - patterns:
              - pattern: $GEN.initialize($BITS)
              - metavariable-regex:
                  metavariable: $BITS
                  regex: \d+
              - focus-metavariable: $BITS
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: RSA cryptographic operations detected in codebase"
  - id: java-crypto-hmac
    message: HMAC usage detected
    severity: INFO
    languages:
      - java
    patterns:
      - pattern-either:
          - pattern: Mac.getInstance("HmacMD5")
          - pattern: Mac.getInstance("HmacSHA1")
          - pattern: Mac.getInstance("HmacSHA256")
          - pattern: Mac.getInstance("HmacSHA384")
          - pattern: Mac.getInstance("HmacSHA512")
          - pattern: Mac.getInstance("HmacSHA3-224")
          - pattern: Mac.getInstance("HmacSHA3-256")
          - pattern: Mac.getInstance("HmacSHA3-384")
          - pattern: Mac.getInstance("HmacSHA3-512")
          - pattern: |
              $MAC = Mac.getInstance("HmacSHA256");
              $KEYSPEC = new SecretKeySpec($KEY, "HmacSHA256");
              $MAC.init($KEYSPEC);
              $MAC.update($DATA);
              $RESULT = $MAC.doFinal();
          - pattern: |
              $MAC = Mac.getInstance("HmacSHA512");
              $KEYSPEC = new SecretKeySpec($KEY, "HmacSHA512");
              $MAC.init($KEYSPEC);
              $RESULT = $MAC.doFinal($DATA);
          - pattern: |
              $MAC = Mac.getInstance("HmacSHA256");
              $KEYSPEC = new SecretKeySpec($KEY.getBytes(), "HmacSHA256");
              $MAC.init($KEYSPEC);
              $MAC.update($DATA);
              $RESULT = $MAC.doFinal();
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: HMAC usage detected in codebase"
  - id: java-crypto-iv-nonce
    message: Initialization vector (IV) or nonce usage detected
    severity: INFO
    languages:
      - java
    patterns:
      - pattern-either:
          - pattern: new IvParameterSpec($IV)
          - pattern: new GCMParameterSpec($TAG_LEN, $NONCE)
          - pattern: new AlgorithmParameterSpec()
          - pattern: |
              $IV = new byte[$SIZE];
              ...
              $IV_PARAMS = new IvParameterSpec($IV);
              $CIPHER.init(Cipher.ENCRYPT_MODE, $KEY, $IV_PARAMS);
          - pattern: |
              $IV = "static_iv_value".getBytes();
              ...
              $IV_PARAMS = new IvParameterSpec($IV);
              $CIPHER.init(Cipher.ENCRYPT_MODE, $KEY, $IV_PARAMS);
          - pattern: |
              $NONCE = new byte[12];
              ...
              $GCM_PARAMS = new GCMParameterSpec(128, $NONCE);
              $CIPHER.init(Cipher.ENCRYPT_MODE, $KEY, $GCM_PARAMS);
          - pattern: |
              $IV = new byte[16];
              $RAND.nextBytes($IV);
              $IV_PARAMS = new IvParameterSpec($IV);
              $CIPHER.init(Cipher.ENCRYPT_MODE, $KEY, $IV_PARAMS);
          - pattern: |
              $NONCE = new byte[12];
              $RAND.nextBytes($NONCE);
              $GCM_PARAMS = new GCMParameterSpec(128, $NONCE);
              $CIPHER.init(Cipher.ENCRYPT_MODE, $KEY, $GCM_PARAMS);
          - pattern: |
              $IV_PARAMS = new IvParameterSpec("static".getBytes());
              $CIPHER.init(Cipher.ENCRYPT_MODE, $KEY, $IV_PARAMS);
    metadata:
      category: crypto
      cwe: CWE-329
      impact: "Inventory: Initialization vector (IV) or nonce usage detected in codebase"
  - id: java-crypto-sha256
    message: SHA256 hash function usage detected
    severity: INFO
    languages:
      - java
    patterns:
      - pattern-either:
          - pattern: MessageDigest.getInstance("SHA-256")
          - pattern: MessageDigest.getInstance("SHA256")
          - pattern: MessageDigest.getInstance("SHA-256", $PROVIDER)
          - pattern: MessageDigest.getInstance("SHA256", $PROVIDER)
          - patterns:
              - pattern: MessageDigest.getInstance($ALGO)
              - metavariable-regex:
                  metavariable: $ALGO
                  regex: (?i)^(SHA-256|SHA256)$
              - focus-metavariable: $ALGO
          - pattern: |
              $DIGEST = MessageDigest.getInstance("SHA-256");
              $DIGEST.update($DATA);
              $HASH = $DIGEST.digest();
          - pattern: |
              $DIGEST = MessageDigest.getInstance("SHA-256", $PROVIDER);
              $DIGEST.update($DATA);
              $HASH = $DIGEST.digest();
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: SHA256 hash function usage detected in codebase"
  - id: rust-crypto-sodiumoxide
    message: sodiumoxide cryptographic library usage detected
    severity: INFO
    languages:
      - rust
    patterns:
      - pattern-either:
          - pattern: sodiumoxide::crypto::box_::gen_keypair()
          - pattern: sodiumoxide::crypto::sign::gen_keypair()
          - pattern: sodiumoxide::crypto::secretbox::gen_key()
          - pattern: sodiumoxide::crypto::box_::seal($MESSAGE, $NONCE, $PUBLIC_KEY, $SECRET_KEY)
          - pattern: sodiumoxide::crypto::box_::open($CIPHERTEXT, $NONCE, $PUBLIC_KEY, $SECRET_KEY)
          - pattern: sodiumoxide::crypto::secretbox::seal($MESSAGE, $NONCE, $KEY)
          - pattern: sodiumoxide::crypto::secretbox::open($CIPHERTEXT, $NONCE, $KEY)
          - pattern: sodiumoxide::crypto::sign::sign($MESSAGE, $SECRET_KEY)
          - pattern: sodiumoxide::crypto::sign::verify($SIGNATURE, $PUBLIC_KEY)
          - pattern: sodiumoxide::crypto::hash::hash($DATA)
          - pattern: sodiumoxide::crypto::hash::sha256::hash($DATA)
          - pattern: sodiumoxide::crypto::hash::sha512::hash($DATA)
          - pattern:
              sodiumoxide::crypto::pwhash::derive_key($PASSWORD, $SALT, $OPS_LIMIT,
              $MEM_LIMIT, $KEY_LEN)
          - pattern: sodiumoxide::crypto::pwhash::pwhash($PASSWORD, $OPS_LIMIT, $MEM_LIMIT)
          - pattern: sodiumoxide::crypto::pwhash::pwhash_verify($HASH, $PASSWORD)
          - pattern: sodiumoxide::randombytes::randombytes($LEN)
          - pattern: sodiumoxide::randombytes::randombytes_into($BUF)
          - pattern: |
              use sodiumoxide::crypto::box_;
              let ($PUBLIC_KEY, $SECRET_KEY) = box_::gen_keypair();
              box_::seal($MESSAGE, $NONCE, &$PUBLIC_KEY, &$SECRET_KEY)
          - pattern: |
              use sodiumoxide::crypto::sign;
              let ($PUBLIC_KEY, $SECRET_KEY) = sign::gen_keypair();
              sign::sign($MESSAGE, &$SECRET_KEY)
          - pattern: |
              use sodiumoxide::randombytes;
              randombytes::randombytes($LEN)
          - pattern: |
              async fn $FUNC() {
                  sodiumoxide::crypto::box_::seal($MESSAGE, $NONCE, $PUBLIC_KEY, $SECRET_KEY)
              }
      - pattern-not-inside: |
          #[test]
          fn $TEST() {
              ...
          }
      - pattern-not-inside: |
          #[cfg(test)]
          mod $MODULE {
              ...
          }
      - pattern-not-inside: |
          mod tests {
              ...
          }
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: sodiumoxide cryptographic library usage detected in codebase"
  - id: rust-crypto-ring
    message: ring cryptographic library usage detected
    severity: INFO
    languages:
      - rust
    patterns:
      - pattern-either:
          - pattern: ring::digest::digest($ALGO, $DATA)
          - pattern:
              ring::aead::seal_in_place($SEALING_KEY, $NONCE, ring::aead::Aad::from($AAD),
              $IN_OUT)
          - pattern:
              ring::aead::open_in_place($OPENING_KEY, $NONCE, ring::aead::Aad::from($AAD),
              $IN_OUT)
          - pattern:
              ring::aead::seal_in_place($SEALING_KEY, $NONCE, ring::aead::Aad::empty(),
              $IN_OUT)
          - pattern:
              ring::aead::open_in_place($OPENING_KEY, $NONCE, ring::aead::Aad::empty(),
              $IN_OUT)
          - pattern: ring::hmac::sign($KEY, $MESSAGE)
          - pattern: ring::hmac::verify($KEY, $MESSAGE, $SIGNATURE)
          - pattern: ring::signature::sign($ALGO, $PRIVATE_KEY, $MESSAGE)
          - pattern: ring::signature::verify($ALGO, $PUBLIC_KEY, $MESSAGE, $SIGNATURE)
          - pattern: ring::rand::SystemRandom::new()
          - pattern: ring::rand::generate($RNG, $OUTPUT)
          - pattern: |
              use ring::digest;
              digest::digest(&digest::SHA256, $DATA)
          - pattern: |
              use ring::aead;
              aead::seal_in_place($KEY, $NONCE, $AAD, $PLAINTEXT, $OUT)
      - pattern-not-inside: |
          #[test]
          fn $TEST() {
              ...
          }
      - pattern-not-inside: |
          #[cfg(test)]
          mod $MODULE {
              ...
          }
      - pattern-not-inside: |
          mod tests {
              ...
          }
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: ring cryptographic library usage detected in codebase"
  - id: rust-crypto-sha3
    message: SHA3 hash function usage detected
    severity: INFO
    languages:
      - rust
    patterns:
      - pattern-either:
          - pattern: sha3::Sha3_224::new()
          - pattern: sha3::Sha3_256::new()
          - pattern: sha3::Sha3_384::new()
          - pattern: sha3::Sha3_512::new()
          - pattern: sha3::Sha3_224::default()
          - pattern: sha3::Sha3_256::default()
          - pattern: sha3::Sha3_384::default()
          - pattern: sha3::Sha3_512::default()
          - pattern: |
              let mut $HASHER = sha3::Sha3_256::new();
              $HASHER.update($DATA);
              let $HASH = $HASHER.finalize();
          - pattern: |
              use sha3::{Sha3_256, Digest};
              let mut $HASHER = Sha3_256::new();
              $HASHER.update($DATA);
              $HASHER.finalize()
          - pattern: |
              let mut $HASHER = sha3::Sha3_512::new();
              $HASHER.update($DATA);
              $HASHER.finalize()
          - pattern: crypto::sha3::Sha3_256::new()
          - pattern: crypto::sha3::Sha3_512::new()
          - pattern: |
              use crypto::digest::Digest;
              let mut $HASHER = crypto::sha3::Sha3_256::new();
              $HASHER.input($DATA);
              $HASHER.result_str()
          - pattern: |
              use digest::Digest;
              let mut $HASHER: Box<dyn Digest> = Box::new(sha3::Sha3_256::new());
              $HASHER.update($DATA);
              $HASHER.finalize()
          - pattern: |
              async fn $FUNC() {
                  let mut $HASHER = sha3::Sha3_256::new();
                  $HASHER.update($DATA);
                  $HASHER.finalize()
              }
      - pattern-not-inside: |
          #[test]
          fn $TEST() {
              ...
          }
      - pattern-not-inside: |
          #[cfg(test)]
          mod $MODULE {
              ...
          }
      - pattern-not-inside: |
          mod tests {
              ...
          }
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: SHA3 hash function usage detected in codebase"
  - id: rust-crypto-key-derivation
    message: Key derivation function usage detected
    severity: INFO
    languages:
      - rust
    patterns:
      - pattern-either:
          - pattern: argon2::hash_encoded($PASSWORD, $SALT, &$CONFIG, $ALGO)
          - pattern: argon2::verify_encoded($HASH, $PASSWORD)
          - pattern: argon2::Argon2::new($ALGO, $VERSION, $PARAMS)
          - pattern: argon2::Argon2::default()
          - pattern: argon2::Argon2::new_with_secret($SECRET, $ALGO, $VERSION, $PARAMS)
          - pattern: |
              use argon2::{Argon2, PasswordHasher, PasswordVerifier};
              let $ARGON2 = Argon2::default();
              $ARGON2.hash_password($PASSWORD, $SALT)
          - patterns:
              - pattern: argon2::Argon2::new($ALGO, $VERSION, $PARAMS)
              - metavariable-regex:
                  metavariable: $VERSION
                  regex: \d+
          - pattern: scrypt::scrypt($PASSWORD, $SALT, &$PARAMS, $OUTPUT)
          - patterns:
              - pattern: scrypt::ScryptParams::new($LOG_N, $R, $P)
              - metavariable-regex:
                  metavariable: $LOG_N
                  regex: \d+
              - metavariable-regex:
                  metavariable: $R
                  regex: \d+
              - metavariable-regex:
                  metavariable: $P
                  regex: \d+
          - pattern: scrypt::ScryptParams::recommended()
          - pattern: |
              let $PARAMS = scrypt::ScryptParams::new($LOG_N, $R, $P);
              scrypt::scrypt($PASSWORD, $SALT, &$PARAMS, $OUTPUT)
          - pattern: pbkdf2::pbkdf2($PASSWORD, $SALT, $ITERATIONS, $OUTPUT)
          - patterns:
              - pattern: pbkdf2::pbkdf2_hmac($ALGO, $PASSWORD, $SALT, $ITERATIONS, $OUTPUT)
              - metavariable-regex:
                  metavariable: $ITERATIONS
                  regex: \d+
          - patterns:
              - pattern: |
                  use pbkdf2::{pbkdf2_hmac, Algorithm};
                  pbkdf2_hmac(Algorithm::Sha256, $PASSWORD, $SALT, $ITERATIONS, $OUTPUT)
              - metavariable-regex:
                  metavariable: $ITERATIONS
                  regex: \d+
          - pattern: |
              async fn $FUNC() {
                  argon2::hash_encoded($PASSWORD, $SALT, &$CONFIG, $ALGO)
              }
      - pattern-not-inside: |
          #[test]
          fn $TEST() {
              ...
          }
      - pattern-not-inside: |
          #[cfg(test)]
          mod $MODULE {
              ...
          }
      - pattern-not-inside: |
          mod tests {
              ...
          }
    focus-metavariable: $VERSION
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: Key derivation function usage detected in codebase"
  - id: rust-crypto-diffie-hellman
    message: Diffie-Hellman key exchange usage detected
    severity: INFO
    languages:
      - rust
    patterns:
      - pattern-either:
          - pattern: openssl::dh::Dh::from_params($P, $G)
          - pattern: openssl::dh::Dh::from_pqg($P, $Q, $G)
          - pattern: openssl::dh::Dh::get_2048_256()
          - pattern: openssl::dh::Dh::get_3072_256()
          - pattern: openssl::dh::DhParams::get_2048_256()
          - pattern: openssl::dh::DhParams::get_3072_256()
          - pattern: |
              let $DH = openssl::dh::Dh::get_2048_256();
              let $PUBLIC_KEY = $DH.generate_key();
          - pattern: |
              let $DH = openssl::dh::Dh::get_3072_256();
              let $PUBLIC_KEY = $DH.generate_key();
          - pattern: |
              let $DH = openssl::dh::Dh::get_2048_256();
              let $PUBLIC_KEY = $DH.generate_key();
              let $SHARED_SECRET = $DH.compute_key($PEER_PUBLIC_KEY);
          - pattern: x25519_dalek::PublicKey::from($BYTES)
          - pattern: x25519_dalek::StaticSecret::new($RNG)
          - pattern: x25519_dalek::StaticSecret::from($BYTES)
          - pattern: x25519_dalek::StaticSecret::diffie_hellman($SECRET, $PUBLIC_KEY)
          - pattern: |
              use x25519_dalek::{StaticSecret, PublicKey};
              let $SECRET = StaticSecret::new($RNG);
              let $PUBLIC_KEY = PublicKey::from(&$SECRET);
              $SECRET.diffie_hellman(&$PEER_PUBLIC_KEY)
          - pattern:
              ring::agreement::agree_ephemeral($ALGO, $PRIVATE_KEY, $PUBLIC_KEY,
              $OUTPUT)
          - pattern: ring::agreement::EphemeralPrivateKey::generate($ALGO, $RNG)
          - pattern: ring::agreement::UnparsedPublicKey::new($ALGO, $PUBLIC_KEY_BYTES)
          - pattern: ring::agreement::X25519
          - pattern: ring::agreement::P256
          - pattern: ring::agreement::P384
          - pattern: |
              use ring::agreement;
              let $PRIVATE_KEY = agreement::EphemeralPrivateKey::generate(&agreement::X25519, $RNG);
              agreement::agree_ephemeral($PRIVATE_KEY, $PUBLIC_KEY, $OUTPUT)
          - pattern: |
              async fn $FUNC() {
                  let ($PUBLIC_KEY, $SECRET_KEY) = x25519_dalek::StaticSecret::new($RNG);
                  $SECRET_KEY.diffie_hellman(&$PEER_PUBLIC_KEY)
              }
      - pattern-not-inside: |
          #[test]
          fn $TEST() {
              ...
          }
      - pattern-not-inside: |
          #[cfg(test)]
          mod $MODULE {
              ...
          }
      - pattern-not-inside: |
          mod tests {
              ...
          }
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: Diffie-Hellman key exchange usage detected in codebase"
  - id: rust-crypto-sha1
    message: SHA1 hash function usage detected
    severity: INFO
    languages:
      - rust
    patterns:
      - pattern-either:
          - pattern: sha1::Sha1::new()
          - pattern: sha1::Sha1::default()
          - pattern: sha1::Sha1::from($DATA)
          - pattern: |
              let mut $HASHER = sha1::Sha1::new();
              $HASHER.update($DATA);
              let $HASH = $HASHER.finalize();
          - pattern: |
              use sha1::{Sha1, Digest};
              let mut $HASHER = Sha1::new();
              $HASHER.update($DATA);
              $HASHER.finalize()
          - pattern: sha1::Sha1::digest($DATA)
          - pattern: sha1::digest($DATA)
          - pattern: crypto::sha1::Sha1::new()
          - pattern: |
              use crypto::digest::Digest;
              let mut $HASHER = crypto::sha1::Sha1::new();
              $HASHER.input($DATA);
              $HASHER.result_str()
          - pattern: openssl::hash::hash(openssl::hash::MessageDigest::sha1(), $DATA)
          - pattern: openssl::hash::Hasher::new(openssl::hash::MessageDigest::sha1())
          - pattern: |
              use digest::Digest;
              let mut $HASHER: Box<dyn Digest> = Box::new(sha1::Sha1::new());
              $HASHER.update($DATA);
              $HASHER.finalize()
          - pattern: |
              async fn $FUNC() {
                  let mut $HASHER = sha1::Sha1::new();
                  $HASHER.update($DATA);
                  $HASHER.finalize()
              }
      - pattern-not-inside: |
          #[test]
          fn $TEST() {
              ...
          }
      - pattern-not-inside: |
          #[cfg(test)]
          mod $MODULE {
              ...
          }
      - pattern-not-inside: |
          mod tests {
              ...
          }
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: SHA1 hash function usage detected in codebase"
  - id: rust-crypto-sha512
    message: SHA512 hash function usage detected
    severity: INFO
    languages:
      - rust
    patterns:
      - pattern-either:
          - pattern: ring::digest::digest(&ring::digest::SHA512, $DATA)
          - pattern: ring::digest::SHA512
          - pattern: sha2::Sha512::new()
          - pattern: sha2::Sha512::default()
          - pattern: sha2::Sha512::from($DATA)
          - pattern: |
              let mut $HASHER = sha2::Sha512::new();
              $HASHER.update($DATA);
              let $HASH = $HASHER.finalize();
          - pattern: |
              let mut $HASHER = sha2::Sha512::new();
              $HASHER.update($DATA);
              $HASHER.finalize_into($OUTPUT);
          - pattern: |
              use sha2::{Sha512, Digest};
              let mut $HASHER = Sha512::new();
              $HASHER.update($DATA);
              $HASHER.finalize()
          - pattern: crypto::sha2::Sha512::new()
          - pattern: openssl::hash::hash(openssl::hash::MessageDigest::sha512(), $DATA)
          - pattern: |
              let $MD = openssl::hash::MessageDigest::sha512();
              openssl::hash::hash($MD, $DATA)
          - pattern: openssl::hash::Hasher::new(openssl::hash::MessageDigest::sha512())
          - pattern: |
              let mut $HASHER = openssl::hash::Hasher::new(openssl::hash::MessageDigest::sha512());
              $HASHER.update($DATA);
              $HASHER.finish()
          - pattern: |
              use digest::Digest;
              let mut $HASHER: Box<dyn Digest> = Box::new(sha2::Sha512::new());
              $HASHER.update($DATA);
              $HASHER.finalize()
          - pattern: |
              async fn $FUNC() {
                  let mut $HASHER = sha2::Sha512::new();
                  $HASHER.update($DATA);
                  $HASHER.finalize()
              }
      - pattern-not-inside: |
          #[test]
          fn $TEST() {
              ...
          }
      - pattern-not-inside: |
          #[cfg(test)]
          mod $MODULE {
              ...
          }
      - pattern-not-inside: |
          mod tests {
              ...
          }
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: SHA512 hash function usage detected in codebase"
  - id: rust-crypto-chacha20
    message: ChaCha20 cipher usage detected
    severity: INFO
    languages:
      - rust
    patterns:
      - pattern-either:
          - pattern: ring::aead::CHACHA20_POLY1305
          - pattern: ring::aead::SealingKey::new(&ring::aead::CHACHA20_POLY1305, $KEY)
          - pattern: ring::aead::OpeningKey::new(&ring::aead::CHACHA20_POLY1305, $KEY)
          - pattern:
              ring::aead::LessSafeKey::new(ring::aead::UnboundKey::new(&ring::aead::CHACHA20_POLY1305,
              $KEY))
          - pattern:
              ring::aead::LessSafeKey::seal_in_place($KEY, $NONCE, $AAD, $PLAINTEXT,
              $OUT)
          - pattern:
              ring::aead::LessSafeKey::open_in_place($KEY, $NONCE, $AAD, $CIPHERTEXT,
              $OUT)
          - pattern: ring::aead::UnboundKey::new(&ring::aead::CHACHA20_POLY1305, $KEY)
          - pattern:
              ring::aead::UnboundKey::new_less_safe_key(&ring::aead::CHACHA20_POLY1305,
              $KEY)
          - pattern: ring::aead::SealingKey::new_from_unbound_key($UNBOUND_KEY)
          - pattern: ring::aead::OpeningKey::new_from_unbound_key($UNBOUND_KEY)
          - pattern: |
              let $SEALING_KEY = ring::aead::SealingKey::new(&ring::aead::CHACHA20_POLY1305, $KEY);
              let $CIPHERTEXT = ring::aead::seal_in_place($SEALING_KEY, $NONCE, $AAD, $PLAINTEXT, $OUT);
          - pattern: |
              let $OPENING_KEY = ring::aead::OpeningKey::new(&ring::aead::CHACHA20_POLY1305, $KEY);
              let $PLAINTEXT = ring::aead::open_in_place($OPENING_KEY, $NONCE, $AAD, $CIPHERTEXT, $OUT);
          - pattern: chacha20::ChaCha20::new($KEY, $NONCE)
          - pattern: chacha20::ChaCha20Rng::from_seed($SEED)
          - pattern: chacha20poly1305::ChaCha20Poly1305::new_from_slice($KEY)
          - pattern: |
              use chacha20poly1305::{ChaCha20Poly1305, KeyInit, Aead};
              let $CIPHER = ChaCha20Poly1305::new_from_slice($KEY);
              $CIPHER.encrypt($NONCE, $PLAINTEXT)
          - pattern: |
              use chacha20poly1305::{ChaCha20Poly1305, KeyInit, Aead};
              let $CIPHER = ChaCha20Poly1305::new_from_slice($KEY);
              $CIPHER.decrypt($NONCE, $CIPHERTEXT)
          - pattern: |
              use chacha20poly1305::{ChaCha20Poly1305, KeyInit, Aead};
              let $CIPHER = ChaCha20Poly1305::new(KeyInit::init($KEY));
              $CIPHER.encrypt($NONCE, $PLAINTEXT)
          - pattern: |
              async fn $FUNC() {
                  let $CIPHER = chacha20poly1305::ChaCha20Poly1305::new_from_slice($KEY);
                  $CIPHER.encrypt($NONCE, $PLAINTEXT)
              }
      - pattern-not-inside: |
          #[test]
          fn $TEST() {
              ...
          }
      - pattern-not-inside: |
          #[cfg(test)]
          mod $MODULE {
              ...
          }
      - pattern-not-inside: |
          mod tests {
              ...
          }
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: ChaCha20 cipher usage detected in codebase"
  - id: rust-crypto-digital-signatures
    message: Digital signature operations detected
    severity: INFO
    languages:
      - rust
    patterns:
      - pattern-either:
          - pattern: ring::signature::sign($ALGO, $PRIVATE_KEY, $MESSAGE)
          - patterns:
              - pattern: ring::signature::sign(&ring::signature::$ALGO, $PRIVATE_KEY, $MESSAGE)
              - metavariable-regex:
                  metavariable: $ALGO
                  regex: (ECDSA_P256_SHA256|ECDSA_P384_SHA384|ED25519|RSA_PKCS1_2048_8192_SHA256|RSA_PKCS1_2048_8192_SHA512|RSA_PKCS1_3072_8192_SHA384|RSA_PSS_2048_8192_SHA256|RSA_PSS_2048_8192_SHA384|RSA_PSS_2048_8192_SHA512)
          - pattern: ring::signature::verify($ALGO, $PUBLIC_KEY, $MESSAGE, $SIGNATURE)
          - patterns:
              - pattern:
                  ring::signature::verify(&ring::signature::$ALGO, $PUBLIC_KEY, $MESSAGE,
                  $SIGNATURE)
              - metavariable-regex:
                  metavariable: $ALGO
                  regex: (ECDSA_P256_SHA256|ECDSA_P384_SHA384|ED25519|RSA_PKCS1_2048_8192_SHA256|RSA_PKCS1_2048_8192_SHA512|RSA_PKCS1_3072_8192_SHA384|RSA_PSS_2048_8192_SHA256|RSA_PSS_2048_8192_SHA384|RSA_PSS_2048_8192_SHA512)
          - pattern: openssl::sign::Signer::new($MD, $KEY)
          - pattern: openssl::sign::Verifier::new($MD, $KEY)
          - pattern: |
              let mut $SIGNER = openssl::sign::Signer::new($MD, $KEY);
              $SIGNER.update($MESSAGE);
              $SIGNER.sign_to_vec()
          - pattern: |
              let mut $VERIFIER = openssl::sign::Verifier::new($MD, $KEY);
              $VERIFIER.update($MESSAGE);
              $VERIFIER.verify($SIGNATURE)
          - pattern: ed25519_dalek::SigningKey::sign($MESSAGE)
          - pattern: ed25519_dalek::VerifyingKey::verify($MESSAGE, $SIGNATURE)
          - pattern: rsa::RsaPrivateKey::sign($SCHEME, $HASH)
          - pattern: rsa::RsaPublicKey::verify($SCHEME, $HASH, $SIGNATURE)
          - pattern: |
              async fn $FUNC() {
                  ring::signature::sign($ALGO, $PRIVATE_KEY, $MESSAGE)
              }
      - pattern-not-inside: |
          #[test]
          fn $TEST() {
              ...
          }
      - pattern-not-inside: |
          #[cfg(test)]
          mod $MODULE {
              ...
          }
      - pattern-not-inside: |
          mod tests {
              ...
          }
    focus-metavariable: $ALGO
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: Digital signature operations detected in codebase"
  - id: rust-crypto-md5
    message: MD5 hash function usage detected
    severity: INFO
    languages:
      - rust
    patterns:
      - pattern-either:
          - pattern: md5::Md5::new()
          - pattern: md5::Md5::default()
          - pattern: md5::Md5::from($DATA)
          - pattern: |
              let mut $HASHER = md5::Md5::new();
              $HASHER.update($DATA);
              let $HASH = $HASHER.finalize();
          - pattern: |
              use md5::{Md5, Digest};
              let mut $HASHER = Md5::new();
              $HASHER.update($DATA);
              $HASHER.finalize()
          - pattern: md5::compute($DATA)
          - pattern: md5::Md5::digest($DATA)
          - pattern: crypto::digest::Digest::update($HASHER, $DATA)
          - pattern: crypto::md5::Md5::new()
          - pattern: |
              use crypto::digest::Digest;
              let mut $HASHER = crypto::md5::Md5::new();
              $HASHER.input($DATA);
              $HASHER.result_str()
          - pattern: |
              use digest::Digest;
              let mut $HASHER: Box<dyn Digest> = Box::new(md5::Md5::new());
              $HASHER.update($DATA);
              $HASHER.finalize()
          - pattern: openssl::hash::hash(openssl::hash::MessageDigest::md5(), $DATA)
          - pattern: openssl::hash::Hasher::new(openssl::hash::MessageDigest::md5())
          - pattern: |
              async fn $FUNC() {
                  let mut $HASHER = md5::Md5::new();
                  $HASHER.update($DATA);
                  $HASHER.finalize()
              }
      - pattern-not-inside: |
          #[test]
          fn $TEST() {
              ...
          }
      - pattern-not-inside: |
          #[cfg(test)]
          mod $MODULE {
              ...
          }
      - pattern-not-inside: |
          mod tests {
              ...
          }
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: MD5 hash function usage detected in codebase"
  - id: rust-crypto-random-generation
    message: Cryptographic random number generation detected
    severity: INFO
    languages:
      - rust
    mode: taint
    pattern-sources:
      - pattern: ring::rand::SystemRandom::new()
      - pattern: ring::rand::generate($RNG, $OUTPUT)
      - pattern: ring::rand::SecureRandom::fill($RNG, $BUF)
      - pattern: |
          let $RNG = ring::rand::SystemRandom::new();
          let $BYTES = ring::rand::generate(&$RNG);
      - pattern: |
          use ring::rand;
          let $RNG = rand::SystemRandom::new();
          rand::generate(&$RNG, $OUTPUT)
      - pattern: openssl::rand::rand_bytes($BUF)
      - pattern: openssl::rand::rand_priv_bytes($BUF)
      - pattern: |
          use openssl::rand;
          rand::rand_bytes($BUF)
      - pattern: getrandom::getrandom($BUF)
      - pattern: getrandom::fill($BUF)
      - pattern: rand::thread_rng()
      - pattern: rand::random()
      - pattern: rand::rngs::ThreadRng::default()
      - pattern: |
          use rand::RngCore;
          let mut $RNG = rand::thread_rng();
          $RNG.fill_bytes($BUF)
    pattern-sinks:
      - pattern: ring::aead::SealingKey::new($ALGO, $KEY)
      - pattern: ring::aead::OpeningKey::new($ALGO, $KEY)
      - pattern: openssl::rsa::Rsa::generate($BITS)
      - pattern: rsa::RsaPrivateKey::new($RNG, $BITS)
      - pattern: ed25519_dalek::SigningKey::generate($RNG)
      - pattern: x25519_dalek::StaticSecret::new($RNG)
      - pattern: ring::agreement::EphemeralPrivateKey::generate($ALGO, $RNG)
      - pattern: |
          let $KEY = ring::aead::SealingKey::new($ALGO, $KEY_BYTES);
          ring::aead::seal_in_place($KEY, $NONCE, $AAD, $PLAINTEXT, $OUT)
      - pattern: |
          async fn $FUNC() {
              let $RNG = ring::rand::SystemRandom::new();
              ring::rand::generate(&$RNG, $OUTPUT)
          }
    pattern-not-inside:
      - pattern: |
          #[test]
          fn $TEST() {
              ...
          }
      - pattern: |
          #[cfg(test)]
          mod $MODULE {
              ...
          }
      - pattern: |
          mod tests {
              ...
          }
    metadata:
      category: crypto
      cwe: CWE-330
      impact: "Inventory: Cryptographic random number generation detected in codebase"
  - id: rust-crypto-password-hashing
    message: Password hashing operations detected
    severity: INFO
    languages:
      - rust
    patterns:
      - pattern-either:
          - pattern: bcrypt::hash($PASSWORD, $COST)
          - pattern: bcrypt::verify($PASSWORD, $HASH)
          - pattern: bcrypt::DEFAULT_COST
          - patterns:
              - pattern: bcrypt::hash($PASSWORD, $COST)
              - metavariable-regex:
                  metavariable: $COST
                  regex: \d+
          - pattern: |
              let $HASH = bcrypt::hash($PASSWORD, bcrypt::DEFAULT_COST);
              bcrypt::verify($INPUT, &$HASH)
          - pattern: |
              use bcrypt::{hash, verify, DEFAULT_COST};
              hash($PASSWORD, DEFAULT_COST)
          - pattern: argon2::hash_encoded($PASSWORD, $SALT, &$CONFIG, $ALGO)
          - pattern: argon2::verify_encoded($HASH, $PASSWORD)
          - pattern: scrypt::scrypt($PASSWORD, $SALT, &$PARAMS, $OUTPUT)
          - pattern: scrypt::verify($HASH, $PASSWORD)
          - pattern: |
              use scrypt::{scrypt, ScryptParams};
              let $PARAMS = ScryptParams::recommended();
              scrypt($PASSWORD, $SALT, &$PARAMS, $OUTPUT)
          - pattern: pbkdf2::pbkdf2($PASSWORD, $SALT, $ITER, $OUTPUT)
          - patterns:
              - pattern: pbkdf2::pbkdf2_hmac::<sha2::Sha256>($PASSWORD, $SALT, $ITER, $OUTPUT)
              - metavariable-regex:
                  metavariable: $ITER
                  regex: \d+
          - patterns:
              - pattern: pbkdf2::pbkdf2_hmac::<sha2::Sha512>($PASSWORD, $SALT, $ITER, $OUTPUT)
              - metavariable-regex:
                  metavariable: $ITER
                  regex: \d+
          - patterns:
              - pattern: |
                  use pbkdf2::{pbkdf2_hmac, pbkdf2};
                  use sha2::Sha256;
                  pbkdf2_hmac::<Sha256>($PASSWORD, $SALT, $ITER, $OUTPUT)
              - metavariable-regex:
                  metavariable: $ITER
                  regex: \d+
          - pattern: |
              async fn $FUNC() {
                  bcrypt::hash($PASSWORD, bcrypt::DEFAULT_COST)
              }
      - pattern-not-inside: |
          #[test]
          fn $TEST() {
              ...
          }
      - pattern-not-inside: |
          #[cfg(test)]
          mod $MODULE {
              ...
          }
      - pattern-not-inside: |
          mod tests {
              ...
          }
    focus-metavariable: $COST
    metadata:
      category: crypto
      cwe: CWE-916
      impact: "Inventory: Password hashing operations detected in codebase"
  - id: rust-crypto-hkdf
    message: HKDF key derivation function usage detected
    severity: INFO
    languages:
      - rust
    patterns:
      - pattern-either:
          - pattern: hkdf::Hkdf::<sha2::Sha256>::extract($SALT, $IKM)
          - pattern: hkdf::Hkdf::<sha2::Sha512>::extract($SALT, $IKM)
          - pattern: hkdf::Hkdf::<sha2::Sha256>::expand($PRK, $INFO, $OKM)
          - pattern: hkdf::Hkdf::<sha2::Sha512>::expand($PRK, $INFO, $OKM)
          - pattern: |
              let $HKDF = hkdf::Hkdf::<sha2::Sha256>::extract($SALT, $IKM);
              $HKDF.expand($INFO, $OKM)
          - pattern: |
              let $HKDF = hkdf::Hkdf::<sha2::Sha512>::extract($SALT, $IKM);
              $HKDF.expand($INFO, $OKM)
          - pattern: |
              use hkdf::Hkdf;
              let $HKDF = Hkdf::<sha2::Sha256>::extract($SALT, $IKM);
              $HKDF.expand($INFO, $OKM)
          - pattern: ring::hkdf::extract($ALGO, $SALT, $IKM)
          - pattern: ring::hkdf::expand($ALGO, $PRK, $INFO, $OKM)
          - pattern: ring::hkdf::HKDF_SHA256
          - pattern: ring::hkdf::HKDF_SHA384
          - pattern: ring::hkdf::HKDF_SHA512
      - pattern-not-inside: |
          #[test]
          fn $TEST() {
              ...
          }
      - pattern-not-inside: |
          #[cfg(test)]
          mod $MODULE {
              ...
          }
      - pattern-not-inside: |
          mod tests {
              ...
          }
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: HKDF key derivation function usage detected in codebase"
  - id: rust-crypto-hardcoded-key
    message: Hardcoded cryptographic key detected
    severity: INFO
    languages:
      - rust
    mode: taint
    pattern-sources:
      - pattern: |
          let $KEY = "$VALUE";
      - pattern: |
          const $KEY: &str = "$VALUE";
      - pattern: |
          const $KEY: &[u8] = b"$VALUE";
      - pattern: |
          static $KEY: &str = "$VALUE";
      - pattern: |
          static $KEY: &[u8] = b"$VALUE";
      - pattern: ring::aead::SealingKey::new(&ring::aead::AES_256_GCM, b"$KEY")
      - pattern: ring::aead::OpeningKey::new(&ring::aead::AES_256_GCM, b"$KEY")
      - pattern: ring::hmac::Key::new(&ring::hmac::HMAC_SHA256, b"$KEY")
      - pattern: aes::Aes256::new(b"$KEY")
      - pattern: aes_gcm::Aes256Gcm::new(b"$KEY")
    pattern-sinks:
      - pattern: ring::aead::SealingKey::new($ALGO, $KEY)
      - pattern: ring::aead::OpeningKey::new($ALGO, $KEY)
      - pattern: ring::hmac::Key::new($ALGO, $KEY)
      - pattern: openssl::symm::encrypt($CIPHER, $KEY, $IV, $DATA)
      - pattern: openssl::symm::decrypt($CIPHER, $KEY, $IV, $DATA)
      - pattern: openssl::symm::encrypt($CIPHER, $KEY.as_bytes(), $IV, $DATA)
      - pattern: openssl::symm::decrypt($CIPHER, $KEY.as_bytes(), $IV, $DATA)
      - pattern: aes::Aes256::new($KEY)
      - pattern: aes_gcm::Aes256Gcm::new($KEY)
    metavariable-propagator:
      metavariable: $KEY
      from: $KEY = $VALUE
      to: $KEY
    pattern-not-inside:
      - pattern: |
          #[test]
          fn $TEST() {
              ...
          }
      - pattern: |
          #[cfg(test)]
          mod $MODULE {
              ...
          }
      - pattern: |
          mod tests {
              ...
          }
    metadata:
      category: crypto
      cwe: CWE-798
      impact: "Inventory: Hardcoded cryptographic key detected in codebase"
  - id: rust-crypto-sha224
    message: SHA224 hash function usage detected
    severity: INFO
    languages:
      - rust
    patterns:
      - pattern-either:
          - pattern: sha2::Sha224::new()
          - pattern: sha2::Sha224::default()
          - pattern: sha2::Sha224::from($DATA)
          - pattern: |
              let mut $HASHER = sha2::Sha224::new();
              $HASHER.update($DATA);
              let $HASH = $HASHER.finalize();
          - pattern: |
              use sha2::{Sha224, Digest};
              let mut $HASHER = Sha224::new();
              $HASHER.update($DATA);
              $HASHER.finalize()
          - pattern: openssl::hash::hash(openssl::hash::MessageDigest::sha224(), $DATA)
          - pattern: |
              let $MD = openssl::hash::MessageDigest::sha224();
              openssl::hash::hash($MD, $DATA)
          - pattern: openssl::hash::Hasher::new(openssl::hash::MessageDigest::sha224())
          - pattern: |
              use digest::Digest;
              let mut $HASHER: Box<dyn Digest> = Box::new(sha2::Sha224::new());
              $HASHER.update($DATA);
              $HASHER.finalize()
          - pattern: |
              async fn $FUNC() {
                  let mut $HASHER = sha2::Sha224::new();
                  $HASHER.update($DATA);
                  $HASHER.finalize()
              }
      - pattern-not-inside: |
          #[test]
          fn $TEST() {
              ...
          }
      - pattern-not-inside: |
          #[cfg(test)]
          mod $MODULE {
              ...
          }
      - pattern-not-inside: |
          mod tests {
              ...
          }
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: SHA224 hash function usage detected in codebase"
  - id: rust-crypto-ed25519
    message: Ed25519 signature operations detected
    severity: INFO
    languages:
      - rust
    patterns:
      - pattern-either:
          - pattern: ring::signature::ED25519
          - pattern: ring::signature::sign(&ring::signature::ED25519, $PRIVATE_KEY, $MESSAGE)
          - pattern:
              ring::signature::verify(&ring::signature::ED25519, $PUBLIC_KEY, $MESSAGE,
              $SIGNATURE)
          - pattern: |
              let $SIGNATURE = ring::signature::sign(&ring::signature::ED25519, $PRIVATE_KEY, $MESSAGE);
              ring::signature::verify(&ring::signature::ED25519, $PUBLIC_KEY, $MESSAGE, &$SIGNATURE)
          - pattern: ed25519_dalek::SigningKey::from_bytes($BYTES)
          - pattern: ed25519_dalek::VerifyingKey::from_bytes($BYTES)
          - pattern: ed25519_dalek::SigningKey::from_bytes($BYTES)?
          - pattern: ed25519_dalek::VerifyingKey::from_bytes($BYTES)?
          - pattern: ed25519_dalek::SigningKey::from_bytes($BYTES).unwrap()
          - pattern: ed25519_dalek::VerifyingKey::from_bytes($BYTES).unwrap()
          - pattern: ed25519_dalek::SigningKey::generate($RNG)
          - pattern: ed25519_dalek::VerifyingKey::from_bytes($BYTES).unwrap()
          - pattern: ed25519_dalek::SigningKey::sign($MESSAGE)
          - pattern: ed25519_dalek::VerifyingKey::verify($MESSAGE, $SIGNATURE)
          - pattern: |
              use ed25519_dalek::{SigningKey, Signer};
              let $SIGNING_KEY = SigningKey::from_bytes($BYTES);
              $SIGNING_KEY.sign($MESSAGE)
          - pattern: |
              use ed25519_dalek::{VerifyingKey, Verifier};
              let $VERIFYING_KEY = VerifyingKey::from_bytes($BYTES)?;
              $VERIFYING_KEY.verify($MESSAGE, $SIGNATURE)
          - pattern: |
              async fn $FUNC() {
                  let $SIGNING_KEY = ed25519_dalek::SigningKey::from_bytes($BYTES);
                  $SIGNING_KEY.sign($MESSAGE)
              }
      - pattern-not-inside: |
          #[test]
          fn $TEST() {
              ...
          }
      - pattern-not-inside: |
          #[cfg(test)]
          mod $MODULE {
              ...
          }
      - pattern-not-inside: |
          mod tests {
              ...
          }
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: Ed25519 signature operations detected in codebase"
  - id: rust-crypto-openssl
    message: OpenSSL cryptographic library usage detected
    severity: INFO
    languages:
      - rust
    patterns:
      - pattern-either:
          - pattern: openssl::hash::hash($MD, $DATA)
          - pattern: openssl::hash::Hasher::new($MD)
          - pattern: openssl::symm::encrypt($CIPHER, $KEY, $IV, $DATA)
          - pattern: openssl::symm::decrypt($CIPHER, $KEY, $IV, $DATA)
          - pattern: openssl::rsa::Rsa::generate($BITS)
          - pattern: openssl::rsa::Rsa::public_encrypt($DATA, $OUTPUT, $PADDING)
          - pattern: openssl::rsa::Rsa::private_decrypt($DATA, $OUTPUT, $PADDING)
          - pattern: openssl::ec::EcKey::generate($GROUP)
          - pattern: openssl::sign::Signer::new($MD, $KEY)
          - pattern: openssl::sign::Verifier::new($MD, $KEY)
          - pattern: openssl::ssl::SslConnector::builder($METHOD)
          - pattern: openssl::ssl::SslAcceptor::builder($METHOD)
          - pattern: |
              use openssl::hash;
              hash::hash(hash::MessageDigest::sha256(), $DATA)
          - pattern: |
              use openssl::symm;
              symm::encrypt($CIPHER, $KEY, $IV, $DATA)
      - pattern-not-inside: |
          #[test]
          fn $TEST() {
              ...
          }
      - pattern-not-inside: |
          #[cfg(test)]
          mod $MODULE {
              ...
          }
      - pattern-not-inside: |
          mod tests {
              ...
          }
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: OpenSSL cryptographic library usage detected in codebase"
  - id: rust-crypto-cipher-aes
    message: AES cipher usage detected
    severity: INFO
    languages:
      - rust
    patterns:
      - pattern-either:
          - patterns:
              - pattern: ring::aead::$ALGO
              - metavariable-regex:
                  metavariable: $ALGO
                  regex: (AES_128_GCM|AES_256_GCM|AES_128_GCM_SIV|AES_256_GCM_SIV)
          - pattern: ring::aead::AES_256_GCM
          - pattern: ring::aead::AES_128_GCM
          - pattern: ring::aead::AES_128_GCM_SIV
          - pattern: ring::aead::AES_256_GCM_SIV
          - pattern: ring::aead::SealingKey::new(&ring::aead::AES_256_GCM, $KEY)
          - pattern: ring::aead::SealingKey::new(&ring::aead::AES_128_GCM, $KEY)
          - pattern: ring::aead::SealingKey::new(&ring::aead::AES_128_GCM_SIV, $KEY)
          - pattern: ring::aead::SealingKey::new(&ring::aead::AES_256_GCM_SIV, $KEY)
          - pattern: ring::aead::OpeningKey::new(&ring::aead::AES_256_GCM, $KEY)
          - pattern: ring::aead::OpeningKey::new(&ring::aead::AES_128_GCM, $KEY)
          - pattern: ring::aead::OpeningKey::new(&ring::aead::AES_128_GCM_SIV, $KEY)
          - pattern: ring::aead::OpeningKey::new(&ring::aead::AES_256_GCM_SIV, $KEY)
          - pattern: ring::aead::LessSafeKey::new($ALGO, $KEY)
          - pattern:
              ring::aead::LessSafeKey::seal_in_place($KEY, $NONCE, $AAD, $PLAINTEXT,
              $OUT)
          - pattern: $KEY.seal_in_place($NONCE, $AAD, $PLAINTEXT, $OUT)
          - pattern:
              ring::aead::LessSafeKey::open_in_place($KEY, $NONCE, $AAD, $CIPHERTEXT,
              $OUT)
          - pattern: $KEY.open_in_place($NONCE, $AAD, $CIPHERTEXT, $OUT)
          - pattern: ring::aead::UnboundKey::new($ALGO, $KEY)
          - pattern: ring::aead::UnboundKey::new_less_safe_key($ALGO, $KEY)
          - pattern: ring::aead::SealingKey::new_from_unbound_key($UNBOUND_KEY)
          - pattern: ring::aead::OpeningKey::new_from_unbound_key($UNBOUND_KEY)
          - pattern: |
              let $SEALING_KEY = ring::aead::SealingKey::new(&ring::aead::AES_256_GCM, $KEY);
              let $CIPHERTEXT = ring::aead::seal_in_place($SEALING_KEY, $NONCE, $AAD, $PLAINTEXT, $OUT);
          - pattern: |
              let $OPENING_KEY = ring::aead::OpeningKey::new(&ring::aead::AES_256_GCM, $KEY);
              let $PLAINTEXT = ring::aead::open_in_place($OPENING_KEY, $NONCE, $AAD, $CIPHERTEXT, $OUT);
          - pattern: |
              let $SEALING_KEY = ring::aead::SealingKey::new(&ring::aead::AES_128_GCM, $KEY);
              let $CIPHERTEXT = ring::aead::seal_in_place($SEALING_KEY, $NONCE, $AAD, $PLAINTEXT, $OUT);
          - pattern: |
              let $OPENING_KEY = ring::aead::OpeningKey::new(&ring::aead::AES_128_GCM, $KEY);
              let $PLAINTEXT = ring::aead::open_in_place($OPENING_KEY, $NONCE, $AAD, $CIPHERTEXT, $OUT);
          - pattern: openssl::symm::Cipher::aes_128_ecb()
          - pattern: openssl::symm::Cipher::aes_256_ecb()
          - pattern: openssl::symm::Cipher::aes_128_cbc()
          - pattern: openssl::symm::Cipher::aes_256_cbc()
          - pattern: openssl::symm::Cipher::aes_128_gcm()
          - pattern: openssl::symm::Cipher::aes_192_cbc()
          - pattern: openssl::symm::Cipher::aes_256_gcm()
          - pattern: openssl::symm::Cipher::aes_256_ctr()
          - pattern: openssl::symm::Cipher::aes_256_cfb128()
          - pattern: openssl::symm::Cipher::aes_256_ofb()
          - pattern: openssl::symm::Cipher::aes_128_ctr()
          - pattern: openssl::symm::Cipher::aes_256_ctr()
          - pattern: openssl::symm::Crypter::new($MODE, $CIPHER, $KEY, $IV)
          - pattern: openssl::symm::Crypter::encrypt($CRYPTER, $DATA)
          - pattern: openssl::symm::Crypter::decrypt($CRYPTER, $DATA)
          - pattern:
              openssl::symm::encrypt(openssl::symm::Cipher::aes_256_gcm(), $KEY,
              $IV, $DATA)
          - pattern:
              openssl::symm::decrypt(openssl::symm::Cipher::aes_256_gcm(), $KEY,
              $IV, $DATA)
          - pattern:
              openssl::symm::encrypt(openssl::symm::Cipher::aes_128_gcm(), $KEY,
              $IV, $DATA)
          - pattern:
              openssl::symm::decrypt(openssl::symm::Cipher::aes_128_gcm(), $KEY,
              $IV, $DATA)
          - pattern: aes::Aes128::new($KEY)
          - pattern: aes::Aes192::new($KEY)
          - pattern: aes::Aes256::new($KEY)
          - pattern: aes_gcm::Aes128Gcm::new_from_slice($KEY)
          - pattern: aes_gcm::Aes256Gcm::new_from_slice($KEY)
          - pattern: |
              use aes_gcm::{Aes256Gcm, KeyInit, Aead};
              let $CIPHER = Aes256Gcm::new_from_slice($KEY);
              $CIPHER.encrypt($NONCE, $PLAINTEXT)
          - pattern: |
              use aes_gcm::{Aes256Gcm, KeyInit, Aead};
              let $CIPHER = Aes256Gcm::new_from_slice($KEY);
              $CIPHER.decrypt($NONCE, $CIPHERTEXT)
          - pattern: |
              use aes_gcm::{Aes128Gcm, KeyInit, Aead};
              let $CIPHER = Aes128Gcm::new_from_slice($KEY);
              $CIPHER.encrypt($NONCE, $PLAINTEXT)
          - pattern: |
              use aes_gcm::{Aes128Gcm, KeyInit, Aead};
              let $CIPHER = Aes128Gcm::new_from_slice($KEY);
              $CIPHER.decrypt($NONCE, $CIPHERTEXT)
          - pattern: |
              use ring::aead;
              let $SEALING_KEY = aead::SealingKey::new(&aead::AES_256_GCM, $KEY);
              aead::seal_in_place($SEALING_KEY, $NONCE, $AAD, $PLAINTEXT, $OUT)
          - pattern: |
              use ring::aead;
              let $OPENING_KEY = aead::OpeningKey::new(&aead::AES_256_GCM, $KEY);
              aead::open_in_place($OPENING_KEY, $NONCE, $AAD, $CIPHERTEXT, $OUT)
          - pattern: aead::seal_in_place($SEALING_KEY, $NONCE, $AAD, $PLAINTEXT, $OUT)
          - pattern: aead::open_in_place($OPENING_KEY, $NONCE, $AAD, $CIPHERTEXT, $OUT)
          - pattern:
              aead::seal_in_place(&$SEALING_KEY, $NONCE, aead::Aad::empty(), &mut
              $OUT)
          - pattern:
              aead::open_in_place(&$OPENING_KEY, $NONCE, aead::Aad::empty(), &mut
              $OUT)
          - pattern: openssl::symm::encrypt($CIPHER, $KEY, Some($IV), $DATA)
          - pattern: openssl::symm::decrypt($CIPHER, $KEY, Some($IV), $DATA)
          - pattern: |
              let $CIPHER = openssl::symm::Cipher::aes_256_gcm();
              openssl::symm::encrypt($CIPHER, $KEY, Some($IV), $DATA)
          - pattern: |
              async fn $FUNC() {
                  let $SEALING_KEY = ring::aead::SealingKey::new(&ring::aead::AES_256_GCM, $KEY);
                  ring::aead::seal_in_place($SEALING_KEY, $NONCE, $AAD, $PLAINTEXT, $OUT)
              }
      - pattern-not-inside: |
          #[test]
          fn $TEST() {
              ...
          }
      - pattern-not-inside: |
          #[cfg(test)]
          mod $MODULE {
              ...
          }
      - pattern-not-inside: |
          mod tests {
              ...
          }
    focus-metavariable: $ALGO
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: AES cipher usage detected in codebase"
  - id: rust-crypto-key-length
    message: Cryptographic key length usage detected
    severity: INFO
    languages:
      - rust
    patterns:
      - pattern-either:
          - patterns:
              - pattern: openssl::rsa::Rsa::generate($BITS)
              - metavariable-regex:
                  metavariable: $BITS
                  regex: \d+
          - patterns:
              - pattern: rsa::RsaPrivateKey::new($RNG, $BITS)
              - metavariable-regex:
                  metavariable: $BITS
                  regex: \d+
      - pattern-not-inside: |
          #[test]
          fn $TEST() {
              ...
          }
      - pattern-not-inside: |
          #[cfg(test)]
          mod $MODULE {
              ...
          }
      - pattern-not-inside: |
          mod tests {
              ...
          }
    focus-metavariable: $BITS
    metadata:
      category: crypto
      cwe: CWE-326
      impact: "Inventory: Cryptographic key length usage detected in codebase"
  - id: rust-crypto-rsa
    message: RSA cryptographic operations detected
    severity: INFO
    languages:
      - rust
    patterns:
      - pattern-either:
          - patterns:
              - pattern: openssl::rsa::Rsa::generate($BITS)
              - metavariable-regex:
                  metavariable: $BITS
                  regex: \d+
          - pattern: openssl::rsa::Rsa::generate_with_e($BITS, $E)
          - pattern: openssl::rsa::Rsa::public_key_from_der($DATA)
          - pattern: openssl::rsa::Rsa::public_key_from_pem($DATA)
          - pattern: openssl::rsa::Rsa::private_key_from_der($DATA)
          - pattern: openssl::rsa::Rsa::private_key_from_pem($DATA)
          - pattern: openssl::rsa::Rsa::private_key_from_pem_passphrase($DATA, $PASS)
          - pattern: openssl::rsa::Rsa::public_encrypt($DATA, $OUTPUT, $PADDING)
          - pattern: openssl::rsa::Rsa::private_decrypt($DATA, $OUTPUT, $PADDING)
          - pattern: openssl::rsa::Rsa::private_encrypt($DATA, $OUTPUT, $PADDING)
          - pattern: openssl::rsa::Rsa::public_decrypt($DATA, $OUTPUT, $PADDING)
          - pattern: openssl::rsa::Padding::PKCS1
          - pattern: openssl::rsa::Padding::PKCS1_OAEP
          - pattern: openssl::rsa::Padding::PKCS1_PSS
          - pattern: |
              let $RSA = openssl::rsa::Rsa::generate($BITS);
              $RSA.public_key_to_der()
          - pattern: |
              let $RSA = openssl::rsa::Rsa::generate($BITS);
              $RSA.public_key_to_pem()
          - patterns:
              - pattern: rsa::RsaPrivateKey::new($RNG, $BITS)
              - metavariable-regex:
                  metavariable: $BITS
                  regex: \d+
          - pattern: rsa::RsaPublicKey::from($PRIVATE_KEY)
      - pattern-not-inside: |
          #[test]
          fn $TEST() {
              ...
          }
      - pattern-not-inside: |
          #[cfg(test)]
          mod $MODULE {
              ...
          }
      - pattern-not-inside: |
          mod tests {
              ...
          }
    focus-metavariable: $BITS
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: RSA cryptographic operations detected in codebase"
  - id: rust-crypto-blake2
    message: BLAKE2 hash function usage detected
    severity: INFO
    languages:
      - rust
    patterns:
      - pattern-either:
          - pattern: blake2::Blake2b::new($KEY)
          - pattern: blake2::Blake2s::new($KEY)
          - pattern: blake2::Blake2b::new_with_params($KEY, $SALT, $PERSONAL)
          - pattern: blake2::Blake2s::new_with_params($KEY, $SALT, $PERSONAL)
          - pattern: |
              let mut $HASHER = blake2::Blake2b::new($KEY);
              $HASHER.update($DATA);
              let $HASH = $HASHER.finalize();
          - pattern: |
              use blake2::{Blake2b, Digest};
              let mut $HASHER = Blake2b::new($KEY);
              $HASHER.update($DATA);
              $HASHER.finalize()
          - pattern: blake2::Blake2b512::new()
          - pattern: blake2::Blake2b256::new()
          - pattern: blake2::Blake2s256::new()
          - pattern: blake2::Blake2s128::new()
          - pattern: |
              let mut $HASHER = blake2::Blake2b512::new();
              $HASHER.update($DATA);
              $HASHER.finalize()
          - pattern: |
              let mut $HASHER = blake2::Blake2s256::new();
              $HASHER.update($DATA);
              $HASHER.finalize_into($OUTPUT)
          - pattern: |
              use digest::Digest;
              let mut $HASHER: Box<dyn Digest> = Box::new(blake2::Blake2b::new($KEY));
              $HASHER.update($DATA);
              $HASHER.finalize()
          - pattern: |
              async fn $FUNC() {
                  let mut $HASHER = blake2::Blake2b::new($KEY);
                  $HASHER.update($DATA);
                  $HASHER.finalize()
              }
      - pattern-not-inside: |
          #[test]
          fn $TEST() {
              ...
          }
      - pattern-not-inside: |
          #[cfg(test)]
          mod $MODULE {
              ...
          }
      - pattern-not-inside: |
          mod tests {
              ...
          }
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: BLAKE2 hash function usage detected in codebase"
  - id: rust-crypto-hmac
    message: HMAC usage detected
    severity: INFO
    languages:
      - rust
    patterns:
      - pattern-either:
          - pattern: ring::hmac::sign($KEY, $MESSAGE)
          - pattern: ring::hmac::verify($KEY, $MESSAGE, $SIGNATURE)
          - patterns:
              - pattern: ring::hmac::Key::new($ALGO, $KEY)
              - metavariable-regex:
                  metavariable: $ALGO
                  regex: (HMAC_SHA256|HMAC_SHA384|HMAC_SHA512|HMAC_SHA1_FOR_LEGACY_USE_ONLY)
          - pattern: ring::hmac::HMAC_SHA256
          - pattern: ring::hmac::HMAC_SHA384
          - pattern: ring::hmac::HMAC_SHA512
          - pattern: ring::hmac::HMAC_SHA1_FOR_LEGACY_USE_ONLY
          - pattern: |
              let $HMAC_KEY = ring::hmac::Key::new(&ring::hmac::HMAC_SHA256, $KEY);
              let $SIGNATURE = ring::hmac::sign(&$HMAC_KEY, $MESSAGE);
          - pattern: |
              let $HMAC_KEY = ring::hmac::Key::new(&ring::hmac::HMAC_SHA256, $KEY);
              ring::hmac::verify(&$HMAC_KEY, $MESSAGE, $SIGNATURE)
          - pattern: |
              use ring::hmac;
              let $KEY = hmac::Key::new(hmac::HMAC_SHA256, $KEY_BYTES);
          - pattern: hmac::Hmac::<sha2::Sha256>::new_from_slice($KEY)
          - pattern: hmac::Hmac::<sha2::Sha512>::new_from_slice($KEY)
          - pattern: |
              use hmac::{Hmac, Mac, KeyInit};
              let mut $MAC = Hmac::<sha2::Sha256>::new_from_slice($KEY);
              $MAC.update($MESSAGE);
              $MAC.finalize()
          - pattern: |
              use hmac::{Hmac, Mac, KeyInit};
              let mut $MAC = Hmac::<sha2::Sha256>::new(KeyInit::init($KEY));
              $MAC.update($MESSAGE);
              $MAC.finalize()
          - pattern: crypto::hmac::Hmac::new($KEY)
          - pattern:
              openssl::sign::Signer::new(openssl::hash::MessageDigest::sha256(),
              $KEY)
          - pattern: |
              let mut $SIGNER = openssl::sign::Signer::new(openssl::hash::MessageDigest::sha256(), $KEY);
              $SIGNER.update($MESSAGE);
              $SIGNER.sign_to_vec()
          - pattern: |
              async fn $FUNC() {
                  let $HMAC_KEY = ring::hmac::Key::new(&ring::hmac::HMAC_SHA256, $KEY);
                  ring::hmac::sign(&$HMAC_KEY, $MESSAGE)
              }
      - pattern-not-inside: |
          #[test]
          fn $TEST() {
              ...
          }
      - pattern-not-inside: |
          #[cfg(test)]
          mod $MODULE {
              ...
          }
      - pattern-not-inside: |
          mod tests {
              ...
          }
    focus-metavariable: $ALGO
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: HMAC usage detected in codebase"
  - id: rust-crypto-secp256k1
    message: secp256k1 cryptographic operations detected
    severity: INFO
    languages:
      - rust
    patterns:
      - pattern-either:
          - pattern: secp256k1::Secp256k1::new()
          - pattern: secp256k1::Secp256k1::signing_only()
          - pattern: secp256k1::Secp256k1::verification_only()
          - pattern: secp256k1::SecretKey::from_slice($BYTES)
          - pattern: secp256k1::SecretKey::from_keypair($KEYPAIR)
          - pattern: secp256k1::PublicKey::from_secret_key($SECP256K1, $SECRET_KEY)
          - pattern: secp256k1::PublicKey::from_slice($BYTES)
          - pattern: secp256k1::Message::from_slice($BYTES)
          - pattern: secp256k1::ecdsa::Signature::from_compact($BYTES)
          - pattern: secp256k1::ecdsa::Signature::from_der($BYTES)
          - pattern: secp256k1::ecdsa::sign($MESSAGE, $SECRET_KEY)
          - pattern: secp256k1::ecdsa::sign($SECP256K1, $MESSAGE, $SECRET_KEY)
          - pattern: secp256k1::ecdsa::verify($MESSAGE, $SIGNATURE, $PUBLIC_KEY)
          - pattern: secp256k1::ecdsa::verify($SECP256K1, $MESSAGE, $SIGNATURE, $PUBLIC_KEY)
          - pattern: secp256k1::KeyPair::from_secret_key($SECP256K1, $SECRET_KEY)
          - pattern: secp256k1::KeyPair::secret_key($KEYPAIR)
          - pattern: secp256k1::KeyPair::public_key($KEYPAIR)
          - pattern: |
              use secp256k1::{Secp256k1, Message, ecdsa};
              let $SECP256K1 = Secp256k1::new();
              let $MESSAGE = Message::from_slice($MESSAGE_BYTES)?;
              ecdsa::sign(&$MESSAGE, $SECRET_KEY)
          - pattern: |
              use secp256k1::{Secp256k1, Message, ecdsa};
              let $SECP256K1 = Secp256k1::new();
              let $MESSAGE = Message::from_slice($MESSAGE_BYTES)?;
              ecdsa::sign($SECP256K1, &$MESSAGE, $SECRET_KEY)
          - pattern: |
              use secp256k1::{Secp256k1, Message, ecdsa};
              let $SECP256K1 = Secp256k1::new();
              let $MESSAGE = Message::from_slice($MESSAGE_BYTES)?;
              ecdsa::verify(&$MESSAGE, $SIGNATURE, $PUBLIC_KEY)
          - pattern: |
              use secp256k1::{Secp256k1, Message, ecdsa};
              let $SECP256K1 = Secp256k1::new();
              let $MESSAGE = Message::from_slice($MESSAGE_BYTES)?;
              ecdsa::verify($SECP256K1, &$MESSAGE, $SIGNATURE, $PUBLIC_KEY)
          - pattern: |
              async fn $FUNC() {
                  secp256k1::ecdsa::sign($MESSAGE, $SECRET_KEY)
              }
          - pattern: |
              async fn $FUNC() {
                  secp256k1::ecdsa::sign($SECP256K1, $MESSAGE, $SECRET_KEY)
              }
      - pattern-not-inside: |
          #[test]
          fn $TEST() {
              ...
          }
      - pattern-not-inside: |
          #[cfg(test)]
          mod $MODULE {
              ...
          }
      - pattern-not-inside: |
          mod tests {
              ...
          }
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: secp256k1 cryptographic operations detected in codebase"
  - id: rust-crypto-cipher-des
    message: DES cipher usage detected
    severity: INFO
    languages:
      - rust
    patterns:
      - pattern-either:
          - pattern: openssl::symm::Cipher::des_cbc()
          - pattern: openssl::symm::Cipher::des_ecb()
          - pattern: openssl::symm::Cipher::des_cfb64()
          - pattern: openssl::symm::Cipher::des_ofb()
          - pattern: openssl::symm::Cipher::des3_cbc()
          - pattern: openssl::symm::Cipher::des3_ecb()
          - pattern: openssl::symm::Cipher::des3_cfb64()
          - pattern: openssl::symm::Cipher::des3_ofb()
          - pattern:
              openssl::symm::encrypt(openssl::symm::Cipher::des_cbc(), $KEY, $IV,
              $DATA)
          - pattern:
              openssl::symm::decrypt(openssl::symm::Cipher::des_cbc(), $KEY, $IV,
              $DATA)
          - pattern:
              openssl::symm::encrypt(openssl::symm::Cipher::des_ecb(), $KEY, $IV,
              $DATA)
          - pattern:
              openssl::symm::decrypt(openssl::symm::Cipher::des_ecb(), $KEY, $IV,
              $DATA)
          - pattern:
              openssl::symm::encrypt(openssl::symm::Cipher::des3_cbc(), $KEY, $IV,
              $DATA)
          - pattern:
              openssl::symm::decrypt(openssl::symm::Cipher::des3_cbc(), $KEY, $IV,
              $DATA)
          - pattern:
              openssl::symm::encrypt(openssl::symm::Cipher::des3_ecb(), $KEY, $IV,
              $DATA)
          - pattern:
              openssl::symm::decrypt(openssl::symm::Cipher::des3_ecb(), $KEY, $IV,
              $DATA)
          - pattern: |
              let $CIPHER = openssl::symm::Cipher::des_cbc();
              let $CIPHERTEXT = openssl::symm::encrypt($CIPHER, $KEY, $IV, $DATA);
          - pattern: |
              let $CIPHER = openssl::symm::Cipher::des_cbc();
              let $PLAINTEXT = openssl::symm::decrypt($CIPHER, $KEY, $IV, $DATA);
          - pattern: |
              let $CIPHER = openssl::symm::Cipher::des3_cbc();
              let $CIPHERTEXT = openssl::symm::encrypt($CIPHER, $KEY, $IV, $DATA);
          - pattern: |
              let $CIPHER = openssl::symm::Cipher::des3_cbc();
              let $PLAINTEXT = openssl::symm::decrypt($CIPHER, $KEY, $IV, $DATA);
          - pattern: |
              use openssl::symm;
              let $CIPHER = symm::Cipher::des_cbc();
              symm::encrypt($CIPHER, $KEY, $IV, $DATA)
          - pattern: |
              use openssl::symm;
              let $CIPHER = symm::Cipher::des3_cbc();
              symm::encrypt($CIPHER, $KEY, $IV, $DATA)
          - pattern:
              openssl::symm::Crypter::new($MODE, openssl::symm::Cipher::des_cbc(),
              $KEY, $IV)
          - pattern:
              openssl::symm::Crypter::new($MODE, openssl::symm::Cipher::des3_cbc(),
              $KEY, $IV)
          - pattern: |
              async fn $FUNC() {
                  openssl::symm::encrypt(openssl::symm::Cipher::des_cbc(), $KEY, $IV, $DATA)
              }
      - pattern-not-inside: |
          #[test]
          fn $TEST() {
              ...
          }
      - pattern-not-inside: |
          #[cfg(test)]
          mod $MODULE {
              ...
          }
      - pattern-not-inside: |
          mod tests {
              ...
          }
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: DES cipher usage detected in codebase"
  - id: rust-crypto-certificate-validation
    message: TLS certificate validation configuration detected
    severity: INFO
    languages:
      - rust
    patterns:
      - pattern-either:
          - pattern: native_tls::TlsConnector::builder().danger_accept_invalid_certs(true)
          - pattern: native_tls::TlsAcceptor::builder().danger_accept_invalid_certs(true)
          - pattern: |
              let $CONNECTOR = native_tls::TlsConnector::builder()
                .danger_accept_invalid_certs(true)
                .build();
          - pattern: |
              let $ACCEPTOR = native_tls::TlsAcceptor::builder()
                .danger_accept_invalid_certs(true)
                .build();
          - pattern: rustls::ClientConfig::builder().with_safe_defaults().dangerous()
          - pattern: rustls::ServerConfig::builder().with_safe_defaults().dangerous()
          - pattern: |
              let $CONFIG = rustls::ClientConfig::builder()
                .with_safe_defaults()
                .dangerous()
                .set_certificate_verifier($VERIFIER);
          - pattern: rustls::client::DangerousClientConfig::set_certificate_verifier($VERIFIER)
          - pattern: openssl::ssl::SslConnector::builder($METHOD).unwrap().set_verify(openssl::ssl::SslVerifyMode::NONE)
          - pattern: openssl::ssl::SslAcceptor::builder($METHOD).unwrap().set_verify(openssl::ssl::SslVerifyMode::NONE)
      - pattern-not-inside: |
          #[test]
          fn $TEST() {
              ...
          }
      - pattern-not-inside: |
          #[cfg(test)]
          mod $MODULE {
              ...
          }
      - pattern-not-inside: |
          mod tests {
              ...
          }
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: TLS certificate validation configuration detected in codebase"
  - id: rust-crypto-iv-nonce
    message: Initialization vector or nonce usage detected
    severity: INFO
    languages:
      - rust
    patterns:
      - pattern-either:
          - pattern: ring::aead::Nonce::assume_unique_for_key($BYTES)
          - pattern: ring::aead::Nonce::try_assume_unique_for_key($BYTES)
          - pattern: |
              let $NONCE = ring::aead::Nonce::assume_unique_for_key([0u8; 12]);
              ring::aead::seal_in_place($KEY, $NONCE, $AAD, $PLAINTEXT, $OUT)
          - pattern: |
              let $IV = [0u8; 16];
              openssl::symm::encrypt($CIPHER, $KEY, &$IV, $DATA)
          - pattern: |
              let $IV = [0u8; 12];
              ring::aead::seal_in_place($KEY, ring::aead::Nonce::assume_unique_for_key($IV), $AAD, $PLAINTEXT, $OUT)
          - pattern: |
              let mut $IV = [0u8; 16];
              openssl::symm::encrypt($CIPHER, $KEY, &$IV, $DATA)
          - pattern: |
              let mut $NONCE = [0u8; 12];
              ring::aead::seal_in_place($KEY, ring::aead::Nonce::assume_unique_for_key($NONCE), $AAD, $PLAINTEXT, $OUT)
          - pattern: |
              let $IV = [0u8; 16];
              openssl::symm::encrypt($CIPHER, $KEY, Some(&$IV), $DATA)
          - pattern: |
              const $IV: [u8; 16] = [0u8; 16];
              openssl::symm::encrypt($CIPHER, $KEY, Some(&$IV), $DATA)
          - pattern: |
              let mut $IV = [0u8; 16];
              $IV[0] = 1;
              openssl::symm::encrypt($CIPHER, $KEY, Some(&$IV), $DATA)
          - pattern: |
              let mut $COUNTER = 0u64;
              let $NONCE = $COUNTER.to_le_bytes();
              ring::aead::seal_in_place($KEY, ring::aead::Nonce::assume_unique_for_key($NONCE), $AAD, $PLAINTEXT, $OUT)
          - pattern: |
              let mut $COUNTER = 0u32;
              let $IV = $COUNTER.to_le_bytes();
              openssl::symm::encrypt($CIPHER, $KEY, Some(&$IV), $DATA)
      - pattern-not-inside: |
          #[test]
          fn $TEST() {
              ...
          }
      - pattern-not-inside: |
          #[cfg(test)]
          mod $MODULE {
              ...
          }
      - pattern-not-inside: |
          mod tests {
              ...
          }
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: Initialization vector or nonce usage detected in codebase"
  - id: rust-crypto-cipher-modes
    message: Cipher mode usage detected
    severity: INFO
    languages:
      - rust
    patterns:
      - pattern-either:
          - pattern: openssl::symm::Cipher::aes_128_ecb()
          - pattern: openssl::symm::Cipher::aes_256_ecb()
          - pattern: openssl::symm::Cipher::aes_128_cbc()
          - pattern: openssl::symm::Cipher::aes_256_cbc()
          - pattern: openssl::symm::Cipher::aes_128_cfb128()
          - pattern: openssl::symm::Cipher::aes_256_cfb128()
          - pattern: openssl::symm::Cipher::aes_128_cfb1()
          - pattern: openssl::symm::Cipher::aes_256_cfb1()
          - pattern: openssl::symm::Cipher::aes_128_cfb8()
          - pattern: openssl::symm::Cipher::aes_256_cfb8()
          - pattern: openssl::symm::Cipher::aes_128_ofb()
          - pattern: openssl::symm::Cipher::aes_256_ofb()
          - pattern: openssl::symm::Cipher::aes_128_ctr()
          - pattern: openssl::symm::Cipher::aes_256_ctr()
          - pattern: openssl::symm::Cipher::aes_128_gcm()
          - pattern: openssl::symm::Cipher::aes_256_gcm()
          - pattern:
              openssl::symm::encrypt(openssl::symm::Cipher::aes_128_ecb(), $KEY,
              $IV, $DATA)
          - pattern:
              openssl::symm::decrypt(openssl::symm::Cipher::aes_128_ecb(), $KEY,
              $IV, $DATA)
          - pattern:
              openssl::symm::encrypt(openssl::symm::Cipher::aes_256_ecb(), $KEY,
              $IV, $DATA)
          - pattern:
              openssl::symm::decrypt(openssl::symm::Cipher::aes_256_ecb(), $KEY,
              $IV, $DATA)
          - pattern:
              openssl::symm::encrypt(openssl::symm::Cipher::aes_128_cbc(), $KEY,
              $IV, $DATA)
          - pattern:
              openssl::symm::decrypt(openssl::symm::Cipher::aes_128_cbc(), $KEY,
              $IV, $DATA)
          - pattern:
              openssl::symm::encrypt(openssl::symm::Cipher::aes_256_cbc(), $KEY,
              $IV, $DATA)
          - pattern:
              openssl::symm::decrypt(openssl::symm::Cipher::aes_256_cbc(), $KEY,
              $IV, $DATA)
          - pattern: cbc::Encryptor::<aes::Aes128>::new($KEY, $IV)
          - pattern: cbc::Decryptor::<aes::Aes128>::new($KEY, $IV)
          - pattern: cbc::Encryptor::<aes::Aes192>::new($KEY, $IV)
          - pattern: cbc::Decryptor::<aes::Aes192>::new($KEY, $IV)
          - pattern: cbc::Encryptor::<aes::Aes256>::new($KEY, $IV)
          - pattern: cbc::Decryptor::<aes::Aes256>::new($KEY, $IV)
          - pattern: ctr::Ctr128BE::<aes::Aes128>::new($KEY, $IV)
          - pattern: ctr::Ctr128LE::<aes::Aes128>::new($KEY, $IV)
          - pattern: ctr::Ctr128BE::<aes::Aes192>::new($KEY, $IV)
          - pattern: ctr::Ctr128LE::<aes::Aes192>::new($KEY, $IV)
          - pattern: ctr::Ctr128BE::<aes::Aes256>::new($KEY, $IV)
          - pattern: ctr::Ctr128LE::<aes::Aes256>::new($KEY, $IV)
          - pattern: cfb8::Encryptor::<aes::Aes128>::new($KEY, $IV)
          - pattern: cfb8::Decryptor::<aes::Aes128>::new($KEY, $IV)
          - pattern: cfb8::Encryptor::<aes::Aes192>::new($KEY, $IV)
          - pattern: cfb8::Decryptor::<aes::Aes192>::new($KEY, $IV)
          - pattern: cfb8::Encryptor::<aes::Aes256>::new($KEY, $IV)
          - pattern: cfb8::Decryptor::<aes::Aes256>::new($KEY, $IV)
          - pattern: cfb64::Encryptor::<aes::Aes128>::new($KEY, $IV)
          - pattern: cfb64::Decryptor::<aes::Aes128>::new($KEY, $IV)
          - pattern: cfb64::Encryptor::<aes::Aes256>::new($KEY, $IV)
          - pattern: cfb64::Decryptor::<aes::Aes256>::new($KEY, $IV)
          - pattern: ofb::Ofb::<aes::Aes128>::new($KEY, $IV)
          - pattern: ofb::Ofb::<aes::Aes192>::new($KEY, $IV)
          - pattern: ofb::Ofb::<aes::Aes256>::new($KEY, $IV)
          - pattern: |
              use cbc::{Encryptor, Decryptor};
              Encryptor::<aes::Aes256>::new($KEY, $IV)
          - pattern: |
              use cbc::{Encryptor, Decryptor};
              Decryptor::<aes::Aes256>::new($KEY, $IV)
          - pattern: |
              use ctr::Ctr128BE;
              Ctr128BE::<aes::Aes256>::new($KEY, $IV)
          - pattern: |
              use cfb8::{Encryptor, Decryptor};
              Encryptor::<aes::Aes256>::new($KEY, $IV)
      - pattern-not-inside: |
          #[test]
          fn $TEST() {
              ...
          }
      - pattern-not-inside: |
          #[cfg(test)]
          mod $MODULE {
              ...
          }
      - pattern-not-inside: |
          mod tests {
              ...
          }
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: Cipher mode usage detected in codebase"
  - id: rust-crypto-tls-cipher-suites
    message: TLS cipher suite configuration detected
    severity: INFO
    languages:
      - rust
    patterns:
      - pattern-either:
          - pattern: rustls::cipher_suite::TLS13_AES_256_GCM_SHA384
          - pattern: rustls::cipher_suite::TLS13_AES_128_GCM_SHA256
          - pattern: rustls::cipher_suite::TLS13_CHACHA20_POLY1305_SHA256
          - pattern: rustls::cipher_suite::TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384
          - pattern: rustls::cipher_suite::TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384
          - pattern: rustls::cipher_suite::TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256
          - pattern: |
              rustls::ClientConfig::builder()
                .with_safe_default_cipher_suites()
                .with_safe_default_kx_groups()
          - pattern: |
              rustls::ServerConfig::builder()
                .with_safe_default_cipher_suites()
                .with_safe_default_kx_groups()
          - pattern: rustls::ClientConfig::builder().with_cipher_suites($SUITES)
          - pattern: rustls::ServerConfig::builder().with_cipher_suites($SUITES)
      - pattern-not-inside: |
          #[test]
          fn $TEST() {
              ...
          }
      - pattern-not-inside: |
          #[cfg(test)]
          mod $MODULE {
              ...
          }
      - pattern-not-inside: |
          mod tests {
              ...
          }
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: TLS cipher suite configuration detected in codebase"
  - id: rust-crypto-sha256
    message: SHA256 hash function usage detected
    severity: INFO
    languages:
      - rust
    patterns:
      - pattern-either:
          - pattern: ring::digest::digest(&ring::digest::SHA256, $DATA)
          - pattern: ring::digest::SHA256
          - pattern: ring::digest::SHA384
          - pattern: ring::digest::SHA512
          - pattern: sha2::Sha256::new()
          - pattern: sha2::Sha256::default()
          - pattern: sha2::Sha256::from($DATA)
          - pattern: |
              let mut $HASHER = sha2::Sha256::new();
              $HASHER.update($DATA);
              let $HASH = $HASHER.finalize();
          - pattern: |
              let mut $HASHER = sha2::Sha256::new();
              $HASHER.update($DATA);
              $HASHER.finalize_into($OUTPUT);
          - pattern: |
              use sha2::{Sha256, Digest};
              let mut $HASHER = Sha256::new();
              $HASHER.update($DATA);
          - pattern: crypto::sha2::Sha256::new()
          - pattern: openssl::hash::hash(openssl::hash::MessageDigest::sha256(), $DATA)
          - pattern: openssl::hash::hash(openssl::hash::MessageDigest::sha384(), $DATA)
          - pattern: openssl::hash::hash(openssl::hash::MessageDigest::sha512(), $DATA)
          - pattern: |
              let $MD = openssl::hash::MessageDigest::sha256();
              openssl::hash::hash($MD, $DATA)
          - pattern: openssl::hash::Hasher::new(openssl::hash::MessageDigest::sha256())
          - pattern: |
              let mut $HASHER = openssl::hash::Hasher::new(openssl::hash::MessageDigest::sha256());
              $HASHER.update($DATA);
              $HASHER.finish()
          - pattern: |
              use digest::Digest;
              let mut $HASHER: Box<dyn Digest> = Box::new(sha2::Sha256::new());
              $HASHER.update($DATA);
              $HASHER.finalize()
          - pattern: |
              async fn $FUNC() {
                  let mut $HASHER = sha2::Sha256::new();
                  $HASHER.update($DATA);
                  $HASHER.finalize()
              }
      - pattern-not-inside: |
          #[test]
          fn $TEST() {
              ...
          }
      - pattern-not-inside: |
          #[cfg(test)]
          mod $MODULE {
              ...
          }
      - pattern-not-inside: |
          mod tests {
              ...
          }
    focus-metavariable: $DATA
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: SHA256 hash function usage detected in codebase"
  - id: rust-crypto-tls-version
    message: TLS version configuration detected
    severity: INFO
    languages:
      - rust
    patterns:
      - pattern-either:
          - patterns:
              - pattern: rustls::ProtocolVersion::$VERSION
              - metavariable-regex:
                  metavariable: $VERSION
                  regex: (TLSv1_[0-3]|TLSv1\.[0-3])
          - pattern: rustls::ProtocolVersion::TLSv1_0
          - pattern: rustls::ProtocolVersion::TLSv1_1
          - pattern: rustls::ProtocolVersion::TLSv1_2
          - pattern: rustls::ProtocolVersion::TLSv1_3
          - pattern: |
              let $CONFIG = rustls::ClientConfig::builder()
                .with_safe_defaults()
                .with_protocol_versions(&[rustls::ProtocolVersion::TLSv1_2])
                .unwrap();
          - pattern: |
              let $CONFIG = rustls::ServerConfig::builder()
                .with_safe_defaults()
                .with_protocol_versions(&[rustls::ProtocolVersion::TLSv1_2])
                .unwrap();
          - pattern: rustls::ClientConfig::builder().with_protocol_versions($VERSIONS)
          - pattern: rustls::ServerConfig::builder().with_protocol_versions($VERSIONS)
          - patterns:
              - pattern: native_tls::Protocol::$VERSION
              - metavariable-regex:
                  metavariable: $VERSION
                  regex: (Tlsv10|Tlsv11|Tlsv12|Tlsv13)
          - pattern: native_tls::TlsConnector::builder().min_protocol_version($VERSION)
          - pattern: native_tls::TlsConnector::builder().max_protocol_version($VERSION)
          - pattern: native_tls::TlsAcceptor::builder().min_protocol_version($VERSION)
          - pattern: native_tls::TlsAcceptor::builder().max_protocol_version($VERSION)
          - pattern: native_tls::Protocol::Tlsv10
          - pattern: native_tls::Protocol::Tlsv11
          - pattern: native_tls::Protocol::Tlsv12
          - pattern: native_tls::Protocol::Tlsv13
          - pattern: |
              let $CONNECTOR = native_tls::TlsConnector::builder()
                .min_protocol_version(Some(native_tls::Protocol::Tlsv12))
                .build();
          - pattern: openssl::ssl::SslMethod::tls()
          - pattern: openssl::ssl::SslMethod::tlsv1()
          - pattern: openssl::ssl::SslMethod::tlsv1_1()
          - pattern: openssl::ssl::SslMethod::tlsv1_2()
          - pattern: openssl::ssl::SslMethod::tlsv1_3()
          - pattern: openssl::ssl::SslConnector::builder($METHOD)
          - pattern: openssl::ssl::SslAcceptor::builder($METHOD)
      - pattern-not-inside: |
          #[test]
          fn $TEST() {
              ...
          }
      - pattern-not-inside: |
          #[cfg(test)]
          mod $MODULE {
              ...
          }
      - pattern-not-inside: |
          mod tests {
              ...
          }
    focus-metavariable: $VERSION
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: TLS version configuration detected in codebase"
  - id: rust-crypto-ecdsa
    message: ECDSA cryptographic operations detected
    severity: INFO
    languages:
      - rust
    patterns:
      - pattern-either:
          - pattern: ring::signature::ECDSA_P256_SHA256_ASN1_SIGNING
          - pattern: ring::signature::ECDSA_P384_SHA384_ASN1_SIGNING
          - pattern: ring::signature::ECDSA_P256_SHA256_FIXED_SIGNING
          - pattern: ring::signature::ECDSA_P384_SHA384_FIXED_SIGNING
          - pattern: ring::signature::sign($ALGO, $PRIVATE_KEY, $MESSAGE)
          - pattern: ring::signature::verify($ALGO, $PUBLIC_KEY, $MESSAGE, $SIGNATURE)
          - pattern: ring::signature::UnparsedPublicKey::new($ALGO, $PUBLIC_KEY)
          - pattern: |
              let $ALGO = &ring::signature::ECDSA_P256_SHA256_ASN1_SIGNING;
              let $SIGNATURE = ring::signature::sign($ALGO, $PRIVATE_KEY, $MESSAGE);
          - pattern: |
              let $PUBLIC_KEY = ring::signature::UnparsedPublicKey::new(&ring::signature::ECDSA_P256_SHA256_ASN1_SIGNING, $PUBLIC_KEY_BYTES);
              ring::signature::verify($ALGO, $PUBLIC_KEY, $MESSAGE, $SIGNATURE)
          - patterns:
              - pattern: openssl::ec::EcGroup::from_curve_name($CURVE)
              - metavariable-regex:
                  metavariable: $CURVE
                  regex: (X9_62_PRIME256V1|SECP384R1|SECP521R1|SECP224R1|SECP256K1)
          - pattern: openssl::ec::EcGroup::from_curve_name(openssl::nid::Nid::X9_62_PRIME256V1)
          - pattern: openssl::ec::EcGroup::from_curve_name(openssl::nid::Nid::SECP384R1)
          - pattern: openssl::ec::EcGroup::from_curve_name(openssl::nid::Nid::SECP521R1)
          - pattern: openssl::ec::EcKey::generate($GROUP)
          - pattern: openssl::ec::EcKey::from_private_components($GROUP, $PRIVATE_KEY)
          - pattern: openssl::ec::EcKey::from_public_key($GROUP, $PUBLIC_KEY)
          - pattern: |
              let $GROUP = openssl::ec::EcGroup::from_curve_name(openssl::nid::Nid::X9_62_PRIME256V1);
              let $KEY = openssl::ec::EcKey::generate(&$GROUP);
          - pattern:
              openssl::sign::Signer::new(openssl::hash::MessageDigest::sha256(),
              $EC_KEY)
          - pattern:
              openssl::sign::Verifier::new(openssl::hash::MessageDigest::sha256(),
              $EC_KEY)
          - pattern: openssl::ecdsa::EcdsaSig::sign($MESSAGE, $PRIVATE_KEY)
          - pattern: openssl::ecdsa::EcdsaSig::verify($MESSAGE, $PUBLIC_KEY)
          - pattern: |
              async fn $FUNC() {
                  ring::signature::sign($ALGO, $PRIVATE_KEY, $MESSAGE)
              }
      - pattern-not-inside: |
          #[test]
          fn $TEST() {
              ...
          }
      - pattern-not-inside: |
          #[cfg(test)]
          mod $MODULE {
              ...
          }
      - pattern-not-inside: |
          mod tests {
              ...
          }
    focus-metavariable: $CURVE
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: ECDSA cryptographic operations detected in codebase"
  - id: typescript-crypto-tls-version
    message: TLS version configuration detected
    severity: INFO
    languages:
      - typescript
    focus-metavariable: $OPTIONS
    patterns:
      - pattern-either:
          - pattern: |
              $OPTIONS: tls.TlsOptions = {
                secureProtocol: "TLSv1_method",
                ...
              };
          - pattern: |
              $OPTIONS: tls.TlsOptions = {
                secureProtocol: "TLSv1_1_method",
                ...
              };
          - pattern: |
              $OPTIONS: tls.TlsOptions = {
                secureProtocol: "TLSv1_2_method",
                ...
              };
          - pattern: |
              $OPTIONS: tls.TlsOptions = {
                minVersion: "TLSv1.2",
                maxVersion: "TLSv1.3",
                ...
              };
          - pattern: |
              $OPTIONS = {
                secureProtocol: "TLSv1_method",
                ...
              };
          - pattern: |
              $OPTIONS = {
                minVersion: "TLSv1.2",
                ...
              };
          - pattern: |
              https.createServer($OPTIONS, $HANDLER);
          - pattern: |
              tls.createServer($OPTIONS, $HANDLER);
          - pattern: |
              tls.createSecureContext($OPTIONS);
          - pattern: |
              const $CONTEXT = tls.createSecureContext({
                secureProtocol: "TLSv1_2_method",
                ...
              });
          - pattern: |
              const $CONTEXT = tls.createSecureContext({
                minVersion: "TLSv1.2",
                ...
              });
    pattern-not-inside:
      - pattern: |
          describe($NAME, () => {
            ...
          })
      - pattern: |
          it($NAME, () => {
            ...
          })
      - pattern: |
          test($NAME, () => {
            ...
          })
      - pattern: |
          // $COMMENT
      - pattern: |
          /* $COMMENT */
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: TLS version configuration detected in codebase"
  - id: typescript-crypto-sha256
    message: SHA256 hash function usage detected
    severity: INFO
    languages:
      - typescript
    focus-metavariable: $DATA
    patterns:
      - pattern-either:
          - pattern: crypto.createHash("sha256")
          - pattern: crypto.createHash('sha256')
          - pattern: |
              $HASHER: crypto.Hash = crypto.createHash("sha256");
              $HASHER.update($DATA);
              $HASH = $HASHER.digest();
          - pattern: crypto.createHash("sha256").update($DATA).digest()
          - pattern: import * as CryptoJS from "crypto-js"; CryptoJS.SHA256($DATA)
          - pattern: require("crypto-js").SHA256($DATA)
          - pattern: CryptoJS.SHA256($DATA)
          - pattern: |
              await crypto.subtle.digest("SHA-256", $DATA);
          - patterns:
              - pattern: crypto.createHash($ALGORITHM)
              - metavariable-regex:
                  metavariable: $ALGORITHM
                  regex: '"sha256"'
          - patterns:
              - pattern: crypto.createHash($ALGORITHM)
              - metavariable-regex:
                  metavariable: $ALGORITHM
                  regex: "'sha256'"
          - patterns:
              - pattern: |
                  const $ALGORITHM = "sha256";
                  ...
                  crypto.createHash($ALGORITHM)
          - patterns:
              - pattern: |
                  await crypto.subtle.digest($ALGORITHM, $DATA);
              - metavariable-regex:
                  metavariable: $ALGORITHM
                  regex: '"SHA-256"'
          - patterns:
              - pattern: |
                  await crypto.subtle.digest($ALGORITHM, $DATA);
              - metavariable-regex:
                  metavariable: $ALGORITHM
                  regex: "'SHA-256'"
    pattern-not-inside:
      - pattern: |
          describe($NAME, () => {
            ...
          })
      - pattern: |
          it($NAME, () => {
            ...
          })
      - pattern: |
          test($NAME, () => {
            ...
          })
      - pattern: |
          // $COMMENT
      - pattern: |
          /* $COMMENT */
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: SHA256 hash function usage detected in codebase"
  - id: typescript-crypto-webcrypto-api
    message: Web Crypto API usage detected
    severity: INFO
    languages:
      - typescript
    focus-metavariable: $KEY
    patterns:
      - pattern-either:
          - pattern: crypto.subtle.encrypt($ALGO, $KEY, $DATA)
          - pattern: crypto.subtle.decrypt($ALGO, $KEY, $DATA)
          - pattern: crypto.subtle.sign($ALGO, $KEY, $DATA)
          - pattern: crypto.subtle.verify($ALGO, $KEY, $SIG, $DATA)
          - pattern: |
              $KEY = await crypto.subtle.generateKey(
                { name: "AES-GCM", length: 256 },
                true,
                ["encrypt", "decrypt"]
              );
          - pattern: crypto.subtle.digest($ALGO, $DATA)
          - pattern: |
              await crypto.subtle.digest("SHA-256", $DATA);
          - pattern: crypto.subtle.importKey($FORMAT, $KEY_DATA, $ALGO, $EXTRACTABLE, $USAGE)
          - pattern: crypto.subtle.exportKey($FORMAT, $KEY)
          - pattern: crypto.subtle.wrapKey($FORMAT, $KEY, $WRAPPING_KEY, $WRAP_ALGO)
          - pattern:
              crypto.subtle.unwrapKey($FORMAT, $WRAPPED_KEY, $UNWRAPPING_KEY, $UNWRAP_ALGO,
              $IMPORT_ALGO, $EXTRACTABLE, $USAGE)
          - pattern: |
              $KEY = await crypto.subtle.generateKey(
                { name: "Ed25519" },
                true,
                ["sign", "verify"]
              );
          - pattern: |
              $KEY = await crypto.subtle.generateKey(
                { name: "X25519" },
                true,
                ["deriveKey", "deriveBits"]
              );
          - pattern: |
              $KEY = await crypto.subtle.generateKey(
                { name: "ChaCha20-Poly1305", length: 256 },
                true,
                ["encrypt", "decrypt"]
              );
          - pattern: |
              $KEY = await crypto.subtle.generateKey(
                { name: $ALGORITHM, length: $LENGTH },
                $EXTRACTABLE,
                $USAGE
              );
          - pattern: |
              $KEY = await crypto.subtle.generateKey(
                { name: $ALGORITHM },
                $EXTRACTABLE,
                $USAGE
              );
          - pattern: |
              await crypto.subtle.deriveBits(
                { name: "PBKDF2", salt: $SALT, iterations: $ITER, hash: "SHA-256" },
                $BASE_KEY,
                $LENGTH
              );
          - pattern: |
              await crypto.subtle.deriveBits(
                { name: "HKDF", hash: "SHA-256", salt: $SALT, info: $INFO },
                $BASE_KEY,
                $LENGTH
              );
    pattern-not-inside:
      - pattern: |
          describe($NAME, () => {
            ...
          })
      - pattern: |
          it($NAME, () => {
            ...
          })
      - pattern: |
          test($NAME, () => {
            ...
          })
      - pattern: |
          // $COMMENT
      - pattern: |
          /* $COMMENT */
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: Web Crypto API usage detected in codebase"
  - id: typescript-crypto-iv-nonce
    message: IV or nonce generation for cryptographic use detected
    severity: INFO
    languages:
      - typescript
    focus-metavariable: $IV
    patterns:
      - pattern-either:
          - pattern: crypto.randomBytes($LENGTH)
          - pattern: crypto.getRandomValues($ARRAY)
          - pattern: |
              $IV: Buffer = crypto.randomBytes(16);
              ...
              crypto.createCipheriv("aes-256-cbc", $KEY, $IV);
          - pattern: |
              $NONCE: Buffer = crypto.randomBytes(12);
              ...
              crypto.createCipheriv("aes-256-gcm", $KEY, $NONCE);
          - pattern: |
              $IV = crypto.getRandomValues(new Uint8Array(16));
              ...
              await crypto.subtle.encrypt({ name: "AES-CBC", iv: $IV }, $KEY, $DATA);
          - pattern: |
              $NONCE = crypto.getRandomValues(new Uint8Array(12));
              ...
              await crypto.subtle.encrypt({ name: "AES-GCM", iv: $NONCE }, $KEY, $DATA);
          - pattern: |
              $IV = new Uint8Array(16);
              crypto.getRandomValues($IV);
              ...
              await crypto.subtle.encrypt({ name: "AES-CBC", iv: $IV }, $KEY, $DATA);
    pattern-not-inside:
      - pattern: |
          describe($NAME, () => {
            ...
          })
      - pattern: |
          it($NAME, () => {
            ...
          })
      - pattern: |
          test($NAME, () => {
            ...
          })
      - pattern: |
          // $COMMENT
      - pattern: |
          /* $COMMENT */
    metadata:
      category: crypto
      cwe: CWE-330
      impact: "Inventory: IV or nonce generation for cryptographic use detected in codebase"
  - id: typescript-crypto-digital-signatures
    message: Digital signature operations detected
    severity: INFO
    languages:
      - typescript
    focus-metavariable: $DATA
    patterns:
      - pattern-either:
          - pattern: crypto.createSign("RSA-SHA256")
          - pattern: crypto.createSign("RSA-SHA512")
          - pattern: crypto.createSign("ecdsa-with-SHA256")
          - pattern: crypto.createSign("ecdsa-with-SHA512")
          - pattern: crypto.createVerify("RSA-SHA256")
          - pattern: crypto.createVerify("RSA-SHA512")
          - pattern: crypto.createVerify("ecdsa-with-SHA256")
          - pattern: crypto.createVerify("ecdsa-with-SHA512")
          - pattern: |
              $SIGN: crypto.Sign = crypto.createSign("RSA-SHA256");
              $SIGN.update($DATA);
              $SIGNATURE = $SIGN.sign($PRIVATE_KEY);
          - pattern: |
              $VERIFY: crypto.Verify = crypto.createVerify("RSA-SHA256");
              $VERIFY.update($DATA);
              $VERIFY.verify($PUBLIC_KEY, $SIGNATURE);
          - pattern: |
              await crypto.subtle.sign({ name: "RSASSA-PKCS1-v1_5", hash: "SHA-256" }, $PRIVATE_KEY, $DATA);
          - pattern: |
              await crypto.subtle.sign({ name: "RSA-PSS", hash: "SHA-256" }, $PRIVATE_KEY, $DATA);
          - pattern: |
              await crypto.subtle.sign({ name: "ECDSA", hash: "SHA-256" }, $PRIVATE_KEY, $DATA);
          - pattern: |
              await crypto.subtle.verify({ name: "RSASSA-PKCS1-v1_5", hash: "SHA-256" }, $PUBLIC_KEY, $SIGNATURE, $DATA);
          - pattern: |
              await crypto.subtle.verify({ name: "RSA-PSS", hash: "SHA-256" }, $PUBLIC_KEY, $SIGNATURE, $DATA);
          - pattern: |
              await crypto.subtle.verify({ name: "ECDSA", hash: "SHA-256" }, $PUBLIC_KEY, $SIGNATURE, $DATA);
          - pattern: |
              $KEY = await crypto.subtle.generateKey({ name: "Ed25519" }, true, ["sign", "verify"]);
          - pattern: |
              await crypto.subtle.sign({ name: "Ed25519" }, $PRIVATE_KEY, $DATA);
          - pattern: |
              await crypto.subtle.verify({ name: "Ed25519" }, $PUBLIC_KEY, $SIGNATURE, $DATA);
    pattern-not-inside:
      - pattern: |
          describe($NAME, () => {
            ...
          })
      - pattern: |
          it($NAME, () => {
            ...
          })
      - pattern: |
          test($NAME, () => {
            ...
          })
      - pattern: |
          // $COMMENT
      - pattern: |
          /* $COMMENT */
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: Digital signature operations detected in codebase"
  - id: typescript-crypto-sha224
    message: SHA224 hash function usage detected
    severity: INFO
    languages:
      - typescript
    focus-metavariable: $DATA
    patterns:
      - pattern-either:
          - pattern: crypto.createHash("sha224")
          - pattern: crypto.createHash('sha224')
          - pattern: |
              $HASHER: crypto.Hash = crypto.createHash("sha224");
              $HASHER.update($DATA);
              $HASH = $HASHER.digest();
          - pattern: crypto.createHash("sha224").update($DATA).digest()
          - patterns:
              - pattern: crypto.createHash($ALGORITHM)
              - metavariable-regex:
                  metavariable: $ALGORITHM
                  regex: '"sha224"'
          - patterns:
              - pattern: crypto.createHash($ALGORITHM)
              - metavariable-regex:
                  metavariable: $ALGORITHM
                  regex: "'sha224'"
          - patterns:
              - pattern: |
                  await crypto.subtle.digest($ALGORITHM, $DATA);
              - metavariable-regex:
                  metavariable: $ALGORITHM
                  regex: '"SHA-224"'
          - patterns:
              - pattern: |
                  await crypto.subtle.digest($ALGORITHM, $DATA);
              - metavariable-regex:
                  metavariable: $ALGORITHM
                  regex: "'SHA-224'"
    pattern-not-inside:
      - pattern: |
          describe($NAME, () => {
            ...
          })
      - pattern: |
          it($NAME, () => {
            ...
          })
      - pattern: |
          test($NAME, () => {
            ...
          })
      - pattern: |
          // $COMMENT
      - pattern: |
          /* $COMMENT */
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: SHA224 hash function usage detected in codebase"
  - id: typescript-crypto-rsa
    message: RSA cryptographic operations detected
    severity: INFO
    languages:
      - typescript
    focus-metavariable: $KEY
    patterns:
      - pattern-either:
          - pattern: crypto.publicEncrypt($KEY, $DATA)
          - pattern: crypto.privateDecrypt($KEY, $DATA)
          - pattern: crypto.privateEncrypt($KEY, $DATA)
          - pattern: crypto.publicDecrypt($KEY, $DATA)
          - pattern: |
              $CIPHERTEXT = crypto.publicEncrypt($PUBLIC_KEY, $PLAINTEXT);
          - pattern: |
              $PLAINTEXT = crypto.privateDecrypt($PRIVATE_KEY, $CIPHERTEXT);
          - pattern: crypto.createSign("RSA-SHA256")
          - pattern: crypto.createSign("RSA-SHA512")
          - pattern: crypto.createVerify("RSA-SHA256")
          - pattern: crypto.createVerify("RSA-SHA512")
          - pattern: |
              $SIGN: crypto.Sign = crypto.createSign("RSA-SHA256");
              $SIGN.update($DATA);
              $SIGNATURE = $SIGN.sign($PRIVATE_KEY);
          - pattern: |
              $VERIFY: crypto.Verify = crypto.createVerify("RSA-SHA256");
              $VERIFY.update($DATA);
              $VERIFY.verify($PUBLIC_KEY, $SIGNATURE);
          - pattern: require("node-forge").pki.rsa.generateKeyPair($BITS)
          - pattern: require("node-forge").pki.rsa.encrypt($DATA, $PUBLIC_KEY)
          - pattern: require("node-forge").pki.rsa.decrypt($DATA, $PRIVATE_KEY)
          - pattern: require("node-forge").pki.rsa.sign($DATA, $PRIVATE_KEY)
          - pattern: require("node-forge").pki.rsa.verify($DATA, $SIGNATURE, $PUBLIC_KEY)
          - pattern: require("node-forge").pki.rsa.setPublicKey($PUBLIC_KEY)
          - pattern: require("node-forge").pki.rsa.setPrivateKey($PRIVATE_KEY)
          - pattern: |
              const $LIBRARY = await import("node-forge");
              $LIBRARY.pki.rsa.generateKeyPair($BITS);
          - pattern: |
              const $LIBRARY = require($MODULE);
              $LIBRARY.pki.rsa.generateKeyPair($BITS);
          - patterns:
              - pattern: |
                  $KEY = await crypto.subtle.generateKey(
                    { name: "RSA-OAEP", modulusLength: $BITS, publicExponent: new Uint8Array([1, 0, 1]), hash: "SHA-256" },
                    true,
                    ["encrypt", "decrypt"]
                  );
              - metavariable-regex:
                  metavariable: $BITS
                  regex: \d+
          - patterns:
              - pattern: |
                  $KEY = await crypto.subtle.generateKey(
                    { name: "RSA-PSS", modulusLength: $BITS, publicExponent: new Uint8Array([1, 0, 1]), hash: "SHA-256" },
                    true,
                    ["sign", "verify"]
                  );
              - metavariable-regex:
                  metavariable: $BITS
                  regex: \d+
          - patterns:
              - pattern: |
                  $KEY = await crypto.subtle.generateKey(
                    { name: "RSA-OAEP", modulusLength: $BITS, publicExponent: new Uint8Array([1, 0, 1]), hash: "SHA-256" },
                    true,
                    ["encrypt", "decrypt"]
                  );
              - metavariable-comparison:
                  metavariable: $BITS
                  comparison: $BITS < 2048
          - patterns:
              - pattern: |
                  $KEY = await crypto.subtle.generateKey(
                    { name: "RSA-PSS", modulusLength: $BITS, publicExponent: new Uint8Array([1, 0, 1]), hash: "SHA-256" },
                    true,
                    ["sign", "verify"]
                  );
              - metavariable-comparison:
                  metavariable: $BITS
                  comparison: $BITS < 2048
    pattern-not-inside:
      - pattern: |
          describe($NAME, () => {
            ...
          })
      - pattern: |
          it($NAME, () => {
            ...
          })
      - pattern: |
          test($NAME, () => {
            ...
          })
      - pattern: |
          // $COMMENT
      - pattern: |
          /* $COMMENT */
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: RSA cryptographic operations detected in codebase"
  - id: typescript-crypto-scrypt
    message: Scrypt key derivation function usage detected
    severity: INFO
    languages:
      - typescript
    focus-metavariable: $PASSWORD
    patterns:
      - pattern-either:
          - pattern: crypto.scrypt($PASSWORD, $SALT, $KEYLEN, $OPTIONS, $CALLBACK)
          - pattern: crypto.scryptSync($PASSWORD, $SALT, $KEYLEN, $OPTIONS)
          - pattern: |
              crypto.scrypt($PASSWORD, $SALT, $KEYLEN, { N: $N, r: $R, p: $P }, function($ERR, $KEY) {
                ...
              });
          - pattern: |
              $KEY = crypto.scryptSync($PASSWORD, $SALT, $KEYLEN, { N: $N, r: $R, p: $P });
          - patterns:
              - pattern: crypto.scryptSync($PASSWORD, $SALT, $KEYLEN, $OPTIONS)
              - metavariable-regex:
                  metavariable: $KEYLEN
                  regex: \d+
          - patterns:
              - pattern: |
                  crypto.scryptSync($PASSWORD, $SALT, $KEYLEN, { N: $N, r: $R, p: $P })
              - metavariable-regex:
                  metavariable: $N
                  regex: \d+
              - metavariable-regex:
                  metavariable: $R
                  regex: \d+
              - metavariable-regex:
                  metavariable: $P
                  regex: \d+
          - patterns:
              - pattern: |
                  crypto.scryptSync($PASSWORD, $SALT, $KEYLEN, { N: $N, r: $R, p: $P })
              - metavariable-comparison:
                  metavariable: $N
                  comparison: $N < 16384
    pattern-not-inside:
      - pattern: |
          describe($NAME, () => {
            ...
          })
      - pattern: |
          it($NAME, () => {
            ...
          })
      - pattern: |
          test($NAME, () => {
            ...
          })
      - pattern: |
          // $COMMENT
      - pattern: |
          /* $COMMENT */
    metadata:
      category: crypto
      cwe: CWE-326
      impact: "Inventory: Scrypt key derivation function usage detected in codebase"
  - id: typescript-crypto-certificate-validation
    message: Certificate validation configuration detected
    severity: INFO
    languages:
      - typescript
    focus-metavariable: $OPTIONS
    patterns:
      - pattern-either:
          - pattern: |
              $OPTIONS: tls.TlsOptions = {
                rejectUnauthorized: true,
                ...
              };
          - pattern: |
              $OPTIONS: tls.TlsOptions = {
                rejectUnauthorized: false,
                ...
              };
          - pattern: |
              $OPTIONS: tls.TlsOptions = {
                ca: $CA_CERT,
                ...
              };
          - pattern: |
              $OPTIONS: tls.TlsOptions = {
                cert: $CERT,
                key: $KEY,
                ...
              };
          - pattern: |
              $OPTIONS: tls.TlsOptions = {
                checkServerIdentity: function($HOSTNAME, $CERT) {
                  ...
                },
                ...
              };
          - pattern: |
              $AGENT: https.Agent = new https.Agent({
                rejectUnauthorized: $VALUE,
                ...
              });
          - pattern: |
              $AGENT: https.Agent = new https.Agent({
                ca: $CA_CERT,
                ...
              });
          - pattern: |
              $OPTIONS = {
                rejectUnauthorized: true,
                ...
              };
          - pattern: |
              $AGENT = new https.Agent({
                rejectUnauthorized: $VALUE,
                ...
              });
          - pattern: |
              const $CONTEXT = tls.createSecureContext({
                rejectUnauthorized: false,
                ...
              });
          - pattern: |
              const $CONTEXT = tls.createSecureContext({
                checkServerIdentity: function($HOSTNAME, $CERT) {
                  ...
                },
                ...
              });
          - pattern: |
              https.createServer({
                rejectUnauthorized: false,
                ...
              }, $HANDLER);
          - pattern: |
              tls.createServer({
                rejectUnauthorized: false,
                ...
              }, $HANDLER);
          - pattern: |
              const $AGENT = new https.Agent({
                rejectUnauthorized: false,
                ...
              });
              https.request({ agent: $AGENT, ... }, $CALLBACK);
    pattern-not-inside:
      - pattern: |
          describe($NAME, () => {
            ...
          })
      - pattern: |
          it($NAME, () => {
            ...
          })
      - pattern: |
          test($NAME, () => {
            ...
          })
      - pattern: |
          // $COMMENT
      - pattern: |
          /* $COMMENT */
    metadata:
      category: crypto
      cwe: CWE-295
      impact: "Inventory: Certificate validation configuration detected in codebase"
  - id: typescript-crypto-blake2
    message: BLAKE2 hash function usage detected
    severity: INFO
    languages:
      - typescript
    focus-metavariable: $DATA
    patterns:
      - pattern-either:
          - pattern: crypto.createHash("blake2b512")
          - pattern: crypto.createHash("blake2s256")
          - pattern: crypto.createHash('blake2b512')
          - pattern: crypto.createHash('blake2s256')
          - pattern: |
              $HASHER: crypto.Hash = crypto.createHash("blake2b512");
              $HASHER.update($DATA);
              $HASH = $HASHER.digest();
          - pattern: |
              $HASHER: crypto.Hash = crypto.createHash("blake2s256");
              $HASHER.update($DATA);
              $HASH = $HASHER.digest();
          - pattern: crypto.createHash("blake2b512").update($DATA).digest()
          - pattern: crypto.createHash("blake2s256").update($DATA).digest()
          - patterns:
              - pattern: crypto.createHash($ALGORITHM)
              - metavariable-regex:
                  metavariable: $ALGORITHM
                  regex: '"(blake2b512|blake2s256)"'
          - patterns:
              - pattern: crypto.createHash($ALGORITHM)
              - metavariable-regex:
                  metavariable: $ALGORITHM
                  regex: "'(blake2b512|blake2s256)'"
    pattern-not-inside:
      - pattern: |
          describe($NAME, () => {
            ...
          })
      - pattern: |
          it($NAME, () => {
            ...
          })
      - pattern: |
          test($NAME, () => {
            ...
          })
      - pattern: |
          // $COMMENT
      - pattern: |
          /* $COMMENT */
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: BLAKE2 hash function usage detected in codebase"
  - id: typescript-crypto-sha3
    message: SHA3 hash function usage detected
    severity: INFO
    languages:
      - typescript
    focus-metavariable: $DATA
    patterns:
      - pattern-either:
          - pattern: crypto.createHash("sha3-224")
          - pattern: crypto.createHash("sha3-256")
          - pattern: crypto.createHash("sha3-384")
          - pattern: crypto.createHash("sha3-512")
          - pattern: crypto.createHash('sha3-224')
          - pattern: crypto.createHash('sha3-256')
          - pattern: crypto.createHash('sha3-384')
          - pattern: crypto.createHash('sha3-512')
          - pattern: |
              $HASHER: crypto.Hash = crypto.createHash("sha3-256");
              $HASHER.update($DATA);
              $HASH = $HASHER.digest();
          - pattern: crypto.createHash("sha3-256").update($DATA).digest()
          - pattern: import * as CryptoJS from "crypto-js"; CryptoJS.SHA3($DATA)
          - pattern: CryptoJS.SHA3($DATA)
          - pattern: require("crypto-js").SHA3($DATA)
          - patterns:
              - pattern: crypto.createHash($ALGORITHM)
              - metavariable-regex:
                  metavariable: $ALGORITHM
                  regex: '"sha3-(224|256|384|512)"'
          - patterns:
              - pattern: crypto.createHash($ALGORITHM)
              - metavariable-regex:
                  metavariable: $ALGORITHM
                  regex: "'sha3-(224|256|384|512)'"
    pattern-not-inside:
      - pattern: |
          describe($NAME, () => {
            ...
          })
      - pattern: |
          it($NAME, () => {
            ...
          })
      - pattern: |
          test($NAME, () => {
            ...
          })
      - pattern: |
          // $COMMENT
      - pattern: |
          /* $COMMENT */
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: SHA3 hash function usage detected in codebase"
  - id: typescript-crypto-cipher-rc4
    message: RC4 stream cipher usage detected
    severity: INFO
    languages:
      - typescript
    focus-metavariable: $KEY
    patterns:
      - pattern-either:
          - pattern: crypto.createCipher("rc4", $KEY)
          - pattern: crypto.createCipher("rc4-40", $KEY)
          - pattern: crypto.createCipher("rc4-hmac-md5", $KEY)
          - pattern: crypto.createDecipher("rc4", $KEY)
          - pattern: crypto.createDecipher("rc4-40", $KEY)
          - pattern: crypto.createDecipher("rc4-hmac-md5", $KEY)
          - patterns:
              - pattern: crypto.createCipheriv($ALGORITHM, $KEY, $IV)
              - metavariable-regex:
                  metavariable: $ALGORITHM
                  regex: '"rc4(-40|-hmac-md5)?"'
          - patterns:
              - pattern: crypto.createCipheriv($ALGORITHM, $KEY, $IV)
              - metavariable-regex:
                  metavariable: $ALGORITHM
                  regex: "'rc4(-40|-hmac-md5)?'"
          - patterns:
              - pattern: |
                  const $ALGORITHM = "rc4";
                  ...
                  crypto.createCipheriv($ALGORITHM, $KEY, $IV)
          - pattern:
              import * as CryptoJS from "crypto-js"; CryptoJS.RC4.encrypt($DATA,
              $KEY)
          - pattern: CryptoJS.RC4.encrypt($DATA, $KEY)
          - pattern:
              import * as CryptoJS from "crypto-js"; CryptoJS.RC4.decrypt($DATA,
              $KEY)
          - pattern: CryptoJS.RC4.decrypt($DATA, $KEY)
          - pattern: require("crypto-js").RC4.encrypt($DATA, $KEY)
          - pattern: require("crypto-js").RC4.decrypt($DATA, $KEY)
    pattern-not-inside:
      - pattern: |
          describe($NAME, () => {
            ...
          })
      - pattern: |
          it($NAME, () => {
            ...
          })
      - pattern: |
          test($NAME, () => {
            ...
          })
      - pattern: |
          // $COMMENT
      - pattern: |
          /* $COMMENT */
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: RC4 stream cipher usage detected in codebase"
  - id: typescript-crypto-tls-cipher-suites
    message: TLS cipher suite configuration detected
    severity: INFO
    languages:
      - typescript
    focus-metavariable: $OPTIONS
    patterns:
      - pattern-either:
          - pattern: |
              $OPTIONS: tls.TlsOptions = {
                ciphers: "$CIPHER_SUITE",
                ...
              };
          - pattern: |
              $OPTIONS: tls.TlsOptions = {
                ciphers: "$CIPHER_LIST",
                ...
              };
          - pattern: |
              $OPTIONS: tls.TlsOptions = {
                honorCipherOrder: true,
                ciphers: "$CIPHER_SUITE",
                ...
              };
          - pattern: |
              $OPTIONS: tls.TlsOptions = {
                secureOptions: $FLAGS,
                ciphers: "$CIPHER_SUITE",
                ...
              };
          - pattern: |
              $OPTIONS = {
                ciphers: "$CIPHER_SUITE",
                ...
              };
    pattern-not-inside:
      - pattern: |
          describe($NAME, () => {
            ...
          })
      - pattern: |
          it($NAME, () => {
            ...
          })
      - pattern: |
          test($NAME, () => {
            ...
          })
      - pattern: |
          // $COMMENT
      - pattern: |
          /* $COMMENT */
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: TLS cipher suite configuration detected in codebase"
  - id: typescript-crypto-sha1
    message: SHA1 hash function usage detected
    severity: INFO
    languages:
      - typescript
    focus-metavariable: $DATA
    patterns:
      - pattern-either:
          - pattern: crypto.createHash("sha1")
          - pattern: crypto.createHash('sha1')
          - pattern: |
              $HASHER: crypto.Hash = crypto.createHash("sha1");
              $HASHER.update($DATA);
              $HASH = $HASHER.digest();
          - pattern: crypto.createHash("sha1").update($DATA).digest()
          - pattern: import * as CryptoJS from "crypto-js"; CryptoJS.SHA1($DATA)
          - pattern: CryptoJS.SHA1($DATA)
          - pattern: require("crypto-js").SHA1($DATA)
          - pattern: |
              await crypto.subtle.digest("SHA-1", $DATA);
          - patterns:
              - pattern: crypto.createHash($ALGORITHM)
              - metavariable-regex:
                  metavariable: $ALGORITHM
                  regex: '"sha1"'
          - patterns:
              - pattern: crypto.createHash($ALGORITHM)
              - metavariable-regex:
                  metavariable: $ALGORITHM
                  regex: "'sha1'"
          - patterns:
              - pattern: |
                  await crypto.subtle.digest($ALGORITHM, $DATA);
              - metavariable-regex:
                  metavariable: $ALGORITHM
                  regex: '"SHA-1"'
          - patterns:
              - pattern: |
                  await crypto.subtle.digest($ALGORITHM, $DATA);
              - metavariable-regex:
                  metavariable: $ALGORITHM
                  regex: "'SHA-1'"
    pattern-not-inside:
      - pattern: |
          describe($NAME, () => {
            ...
          })
      - pattern: |
          it($NAME, () => {
            ...
          })
      - pattern: |
          test($NAME, () => {
            ...
          })
      - pattern: |
          // $COMMENT
      - pattern: |
          /* $COMMENT */
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: SHA1 hash function usage detected in codebase"
  - id: typescript-crypto-salt-generation
    message: Salt generation for cryptographic use detected
    severity: INFO
    languages:
      - typescript
    focus-metavariable: $SALT
    patterns:
      - pattern-either:
          - pattern: crypto.randomBytes($LENGTH)
          - pattern: crypto.getRandomValues($ARRAY)
          - pattern: |
              $SALT: Buffer = crypto.randomBytes(16);
              ...
              crypto.pbkdf2($PASSWORD, $SALT, $ITER, $KEYLEN, $DIGEST, $CALLBACK);
          - pattern: |
              $SALT: Buffer = crypto.randomBytes(32);
              ...
              crypto.scryptSync($PASSWORD, $SALT, $KEYLEN, $OPTIONS);
          - pattern: |
              $SALT = crypto.getRandomValues(new Uint8Array(16));
              ...
              crypto.pbkdf2($PASSWORD, $SALT, $ITER, $KEYLEN, $DIGEST, $CALLBACK);
          - pattern: |
              $SALT = crypto.randomBytes($SALT_LENGTH);
              ...
              require("bcrypt").hashSync($PASSWORD, $ROUNDS);
          - pattern: |
              $SALT = await crypto.subtle.generateKey(
                { name: "AES-GCM", length: 256 },
                true,
                ["encrypt", "decrypt"]
              );
              ...
              await crypto.subtle.deriveKey(
                { name: "PBKDF2", salt: $SALT, iterations: $ITER, hash: "SHA-256" },
                $BASE_KEY,
                { name: "AES-GCM", length: 256 },
                false,
                ["encrypt", "decrypt"]
              );
          - pattern: |
              $SALT = Buffer.from("$VALUE");
              ...
              crypto.pbkdf2Sync($PASSWORD, $SALT, $ITER, $KEYLEN, $DIGEST);
          - pattern: |
              $SALT = Buffer.from("$VALUE", "hex");
              ...
              crypto.scryptSync($PASSWORD, $SALT, $KEYLEN);
          - patterns:
              - pattern: crypto.randomBytes($SALT_LENGTH)
              - metavariable-regex:
                  metavariable: $SALT_LENGTH
                  regex: \d+
              - focus-metavariable: $SALT_LENGTH
    pattern-not-inside:
      - pattern: |
          describe($NAME, () => {
            ...
          })
      - pattern: |
          it($NAME, () => {
            ...
          })
      - pattern: |
          test($NAME, () => {
            ...
          })
      - pattern: |
          // $COMMENT
      - pattern: |
          /* $COMMENT */
    metadata:
      category: crypto
      cwe: CWE-330
      impact: "Inventory: Salt generation for cryptographic use detected in codebase"
  - id: typescript-crypto-diffie-hellman
    message: Diffie-Hellman key exchange usage detected
    severity: INFO
    languages:
      - typescript
    focus-metavariable: $KEY
    patterns:
      - pattern-either:
          - pattern: crypto.createDiffieHellman($PRIME, $ENCODING)
          - pattern: crypto.createDiffieHellman($PRIME_LENGTH)
          - pattern: crypto.createDiffieHellmanGroup("modp14")
          - pattern: crypto.createDiffieHellmanGroup("modp15")
          - pattern: crypto.createDiffieHellmanGroup("modp16")
          - pattern: crypto.createDiffieHellmanGroup("modp1")
          - pattern: crypto.createDiffieHellmanGroup("modp2")
          - pattern: crypto.createDiffieHellmanGroup("modp5")
          - pattern: crypto.createDiffieHellmanGroup("modp17")
          - pattern: crypto.createDiffieHellmanGroup("modp18")
          - pattern: |
              $DH: crypto.DiffieHellman = crypto.createDiffieHellman($PRIME_LENGTH);
              $DH.generateKeys();
              $SHARED = $DH.computeSecret($PUBLIC_KEY);
          - pattern: |
              $DH: crypto.DiffieHellman = crypto.createDiffieHellmanGroup("modp14");
              $DH.generateKeys();
              $SHARED = $DH.computeSecret($PUBLIC_KEY);
          - pattern: crypto.createECDH("prime256v1")
          - pattern: crypto.createECDH("secp256k1")
          - pattern: |
              $ECDH: crypto.ECDH = crypto.createECDH("prime256v1");
              $ECDH.generateKeys();
              $SHARED = $ECDH.computeSecret($PUBLIC_KEY);
          - pattern: |
              $KEY = await crypto.subtle.generateKey(
                { name: "ECDH", namedCurve: "P-256" },
                true,
                ["deriveKey", "deriveBits"]
              );
          - pattern: |
              await crypto.subtle.deriveKey(
                { name: "ECDH", public: $PUBLIC_KEY },
                $PRIVATE_KEY,
                { name: "AES-GCM", length: 256 },
                true,
                ["encrypt", "decrypt"]
              );
          - pattern: |
              $KEY = await crypto.subtle.generateKey(
                { name: "X25519" },
                true,
                ["deriveKey", "deriveBits"]
              );
          - pattern: |
              await crypto.subtle.deriveKey(
                { name: "X25519", public: $PUBLIC_KEY },
                $PRIVATE_KEY,
                { name: "AES-GCM", length: 256 },
                true,
                ["encrypt", "decrypt"]
              );
    pattern-not-inside:
      - pattern: |
          describe($NAME, () => {
            ...
          })
      - pattern: |
          it($NAME, () => {
            ...
          })
      - pattern: |
          test($NAME, () => {
            ...
          })
      - pattern: |
          // $COMMENT
      - pattern: |
          /* $COMMENT */
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: Diffie-Hellman key exchange usage detected in codebase"
  - id: typescript-crypto-password-hashing
    message: Password hashing operations detected
    severity: INFO
    languages:
      - typescript
    focus-metavariable: $PASSWORD
    patterns:
      - pattern-either:
          - pattern: crypto.pbkdf2($PASSWORD, $SALT, $ITER, $KEYLEN, $DIGEST, $CALLBACK)
          - pattern: crypto.pbkdf2Sync($PASSWORD, $SALT, $ITER, $KEYLEN, $DIGEST)
          - pattern: crypto.scrypt($PASSWORD, $SALT, $KEYLEN, $OPTIONS, $CALLBACK)
          - pattern: crypto.scryptSync($PASSWORD, $SALT, $KEYLEN, $OPTIONS)
          - pattern: require("bcrypt").hash($PASSWORD, $ROUNDS, $CALLBACK)
          - pattern: require("bcrypt").hashSync($PASSWORD, $ROUNDS)
          - pattern: require("bcrypt").compare($PASSWORD, $HASH, $CALLBACK)
          - pattern: require("bcrypt").compareSync($PASSWORD, $HASH)
          - pattern: require("bcryptjs").hash($PASSWORD, $ROUNDS, $CALLBACK)
          - pattern: require("bcryptjs").hashSync($PASSWORD, $ROUNDS)
          - pattern: require("bcryptjs").compare($PASSWORD, $HASH, $CALLBACK)
          - pattern: require("bcryptjs").compareSync($PASSWORD, $HASH)
          - pattern: |
              $HASH = await bcrypt.hash($PASSWORD, $ROUNDS);
              ...
              $MATCH = await bcrypt.compare($PASSWORD, $HASH);
          - pattern: import * as bcrypt from "bcrypt"; await bcrypt.hash($PASSWORD, $ROUNDS)
          - pattern: import * as bcrypt from "bcryptjs"; await bcrypt.hash($PASSWORD, $ROUNDS)
          - pattern: bcrypt.hashSync($PASSWORD, $ROUNDS)
          - pattern: bcrypt.compare($PASSWORD, $HASH, $CALLBACK)
          - pattern: bcrypt.compareSync($PASSWORD, $HASH)
          - pattern: bcryptjs.hashSync($PASSWORD, $ROUNDS)
          - pattern: bcryptjs.compare($PASSWORD, $HASH, $CALLBACK)
          - pattern: bcryptjs.compareSync($PASSWORD, $HASH)
          - pattern: |
              await bcrypt.compare($PASSWORD, $HASH);
          - pattern: |
              await bcryptjs.compare($PASSWORD, $HASH);
          - pattern: |
              const $LIBRARY = await import("bcrypt");
              await $LIBRARY.hash($PASSWORD, $ROUNDS);
          - pattern: |
              const $LIBRARY = await import("bcryptjs");
              await $LIBRARY.hash($PASSWORD, $ROUNDS);
          - pattern: |
              const $LIBRARY = require($MODULE);
              $LIBRARY.hashSync($PASSWORD, $ROUNDS);
          - patterns:
              - pattern: bcrypt.hashSync($PASSWORD, $ROUNDS)
              - metavariable-comparison:
                  metavariable: $ROUNDS
                  comparison: $ROUNDS < 10
          - patterns:
              - pattern: bcryptjs.hashSync($PASSWORD, $ROUNDS)
              - metavariable-comparison:
                  metavariable: $ROUNDS
                  comparison: $ROUNDS < 10
          - patterns:
              - pattern: require("bcrypt").hashSync($PASSWORD, $ROUNDS)
              - metavariable-comparison:
                  metavariable: $ROUNDS
                  comparison: $ROUNDS < 10
          - patterns:
              - pattern: require("bcryptjs").hashSync($PASSWORD, $ROUNDS)
              - metavariable-comparison:
                  metavariable: $ROUNDS
                  comparison: $ROUNDS < 10
    pattern-not-inside:
      - pattern: |
          describe($NAME, () => {
            ...
          })
      - pattern: |
          it($NAME, () => {
            ...
          })
      - pattern: |
          test($NAME, () => {
            ...
          })
      - pattern: |
          // $COMMENT
      - pattern: |
          /* $COMMENT */
    metadata:
      category: crypto
      cwe: CWE-326
      impact: "Inventory: Password hashing operations detected in codebase"
  - id: typescript-crypto-hmac
    message: HMAC usage detected
    severity: INFO
    languages:
      - typescript
    focus-metavariable: $DATA
    patterns:
      - pattern-either:
          - pattern: crypto.createHmac("sha256", $KEY)
          - pattern: crypto.createHmac("sha512", $KEY)
          - pattern: crypto.createHmac("sha1", $KEY)
          - pattern: crypto.createHmac("md5", $KEY)
          - pattern: crypto.createHmac("sha384", $KEY)
          - patterns:
              - pattern: crypto.createHmac($ALGORITHM, $KEY)
              - metavariable-regex:
                  metavariable: $ALGORITHM
                  regex: '"(sha256|sha512|sha1|md5|sha384)"'
          - patterns:
              - pattern: crypto.createHmac($ALGORITHM, $KEY)
              - metavariable-regex:
                  metavariable: $ALGORITHM
                  regex: "'(sha256|sha512|sha1|md5|sha384)'"
          - patterns:
              - pattern: |
                  const $ALGORITHM = "sha256";
                  ...
                  crypto.createHmac($ALGORITHM, $KEY)
          - pattern: |
              $HMAC: crypto.Hmac = crypto.createHmac("sha256", $KEY);
              $HMAC.update($DATA);
              $RESULT = $HMAC.digest();
          - pattern: crypto.createHmac("sha256", $KEY).update($DATA).digest()
          - pattern: import * as CryptoJS from "crypto-js"; CryptoJS.HmacSHA256($DATA, $KEY)
          - pattern: import * as CryptoJS from "crypto-js"; CryptoJS.HmacSHA512($DATA, $KEY)
          - pattern: import * as CryptoJS from "crypto-js"; CryptoJS.HmacSHA1($DATA, $KEY)
          - pattern: CryptoJS.HmacSHA256($DATA, $KEY)
          - pattern: CryptoJS.HmacSHA512($DATA, $KEY)
          - pattern: CryptoJS.HmacSHA1($DATA, $KEY)
          - pattern: |
              await crypto.subtle.sign(
                { name: "HMAC", hash: "SHA-256" },
                $KEY,
                $DATA
              );
          - pattern: |
              await crypto.subtle.verify(
                { name: "HMAC", hash: "SHA-256" },
                $KEY,
                $SIGNATURE,
                $DATA
              );
    pattern-not-inside:
      - pattern: |
          describe($NAME, () => {
            ...
          })
      - pattern: |
          it($NAME, () => {
            ...
          })
      - pattern: |
          test($NAME, () => {
            ...
          })
      - pattern: |
          // $COMMENT
      - pattern: |
          /* $COMMENT */
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: HMAC usage detected in codebase"
  - id: typescript-crypto-hardcoded-key
    message: Hardcoded cryptographic key detected
    severity: INFO
    languages:
      - typescript
    mode: taint
    pattern-sources:
      - pattern: |
          const $KEY: string = "$VALUE";
      - pattern: |
          let $KEY: string = "$VALUE";
      - pattern: |
          const $KEY = "$VALUE";
      - pattern: |
          let $KEY = "$VALUE";
      - pattern: |
          $KEY = "$VALUE";
      - pattern: |
          $KEY = Buffer.from("$VALUE");
      - pattern: |
          $KEY = Buffer.from("$VALUE", "hex");
      - pattern: |
          $KEY = Buffer.from("$VALUE", "base64");
      - pattern: |
          $KEY_DATA = new Uint8Array([$VALUES]);
      - pattern: |
          $OPTIONS = {
            key: "$VALUE",
            ...
          };
    pattern-sinks:
      - pattern: crypto.createCipheriv($ALGO, $KEY, $IV)
      - pattern: crypto.createDecipheriv($ALGO, $KEY, $IV)
      - pattern: crypto.subtle.encrypt($ALGO, $KEY, $DATA)
      - pattern: crypto.subtle.decrypt($ALGO, $KEY, $DATA)
      - pattern: crypto.subtle.sign($ALGO, $KEY, $DATA)
      - pattern: crypto.subtle.verify($ALGO, $KEY, $SIG, $DATA)
      - pattern: |
          await crypto.subtle.importKey("raw", $KEY_DATA, { name: "AES-GCM" }, false, ["encrypt", "decrypt"])
      - pattern: |
          crypto.createCipheriv("aes-256-cbc", $OPTIONS.key, $IV)
    metavariable-propagator:
      metavariable: $KEY
      from: $KEY = $VALUE
      to: $KEY
    pattern-not-inside:
      - pattern: |
          describe($NAME, () => {
            ...
          })
      - pattern: |
          it($NAME, () => {
            ...
          })
      - pattern: |
          test($NAME, () => {
            ...
          })
      - pattern: |
          // $COMMENT
      - pattern: |
          /* $COMMENT */
      - pattern: |
          /**
           * $DOCSTRING
           */
    metadata:
      category: crypto
      cwe: CWE-798
      impact: "Inventory: Hardcoded cryptographic key detected in codebase"
  - id: typescript-crypto-key-derivation
    message: Key derivation function usage detected
    severity: INFO
    languages:
      - typescript
    focus-metavariable: $PASSWORD
    patterns:
      - pattern-either:
          - pattern: crypto.pbkdf2($PASSWORD, $SALT, $ITER, $KEYLEN, $DIGEST, $CALLBACK)
          - pattern: crypto.pbkdf2Sync($PASSWORD, $SALT, $ITER, $KEYLEN, $DIGEST)
          - pattern: crypto.scrypt($PASSWORD, $SALT, $KEYLEN, $OPTIONS, $CALLBACK)
          - pattern: crypto.scryptSync($PASSWORD, $SALT, $KEYLEN, $OPTIONS)
          - pattern: crypto.createECDH("prime256v1")
          - pattern: |
              $ECDH: crypto.ECDH = crypto.createECDH("prime256v1");
              $ECDH.generateKeys();
              $SHARED = $ECDH.computeSecret($PUBLIC_KEY);
          - pattern:
              crypto.subtle.deriveKey($ALGO, $BASE_KEY, $DERIVED_ALGO, $EXTRACTABLE,
              $USAGE)
          - pattern: crypto.subtle.deriveBits($ALGO, $BASE_KEY, $LENGTH)
          - pattern: |
              $KEY = await crypto.subtle.deriveKey(
                { name: "PBKDF2", salt: $SALT, iterations: $ITER, hash: "SHA-256" },
                $BASE_KEY,
                { name: "AES-GCM", length: 256 },
                false,
                ["encrypt", "decrypt"]
              );
          - pattern: |
              $KEY = await crypto.subtle.deriveKey(
                { name: "HKDF", hash: "SHA-256", salt: $SALT, info: $INFO },
                $BASE_KEY,
                { name: "AES-GCM", length: 256 },
                false,
                ["encrypt", "decrypt"]
              );
    pattern-not-inside:
      - pattern: |
          describe($NAME, () => {
            ...
          })
      - pattern: |
          it($NAME, () => {
            ...
          })
      - pattern: |
          test($NAME, () => {
            ...
          })
      - pattern: |
          // $COMMENT
      - pattern: |
          /* $COMMENT */
    metadata:
      category: crypto
      cwe: CWE-326
      impact: "Inventory: Key derivation function usage detected in codebase"
  - id: typescript-crypto-md5
    message: MD5 hash function usage detected
    severity: INFO
    languages:
      - typescript
    focus-metavariable: $DATA
    patterns:
      - pattern-either:
          - pattern: crypto.createHash("md5")
          - pattern: crypto.createHash('md5')
          - pattern: |
              $HASHER: crypto.Hash = crypto.createHash("md5");
              $HASHER.update($DATA);
              $HASH = $HASHER.digest();
          - pattern: crypto.createHash("md5").update($DATA).digest()
          - pattern: import * as CryptoJS from "crypto-js"; CryptoJS.MD5($DATA)
          - pattern: require("crypto-js").MD5($DATA)
          - pattern: CryptoJS.MD5($DATA)
          - patterns:
              - pattern: crypto.createHash($ALGORITHM)
              - metavariable-regex:
                  metavariable: $ALGORITHM
                  regex: '"md5"'
          - patterns:
              - pattern: crypto.createHash($ALGORITHM)
              - metavariable-regex:
                  metavariable: $ALGORITHM
                  regex: "'md5'"
          - patterns:
              - pattern: |
                  const $ALGORITHM = "md5";
                  ...
                  crypto.createHash($ALGORITHM)
          - pattern: |
              const $ALGORITHM = "md5";
              crypto.createHash($ALGORITHM)
    pattern-not-inside:
      - pattern: |
          describe($NAME, () => {
            ...
          })
      - pattern: |
          it($NAME, () => {
            ...
          })
      - pattern: |
          test($NAME, () => {
            ...
          })
      - pattern: |
          // $COMMENT
      - pattern: |
          /* $COMMENT */
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: MD5 hash function usage detected in codebase"
  - id: typescript-crypto-argon2
    message: Argon2 key derivation function usage detected
    severity: INFO
    languages:
      - typescript
    focus-metavariable: $PASSWORD
    patterns:
      - pattern-either:
          - pattern: require("argon2").hash($PASSWORD, $OPTIONS)
          - pattern: require("argon2").verify($HASH, $PASSWORD)
          - pattern: require("argon2-browser").hash($PASSWORD, $OPTIONS)
          - pattern: require("argon2-browser").verify($HASH, $PASSWORD)
          - pattern: |
              $HASH = await argon2.hash($PASSWORD, { type: argon2.argon2i, memoryCost: $MEMORY, timeCost: $TIME, parallelism: $PARALLELISM });
          - pattern: |
              $MATCH = await argon2.verify($HASH, $PASSWORD);
          - pattern: import * as argon2 from "argon2"; await argon2.hash($PASSWORD, $OPTIONS)
          - pattern:
              import * as argon2 from "argon2-browser"; await argon2.hash($PASSWORD,
              $OPTIONS)
          - pattern: |
              $HASH = await argon2.hash($PASSWORD, { type: argon2.argon2d, memoryCost: $MEMORY, timeCost: $TIME, parallelism: $PARALLELISM });
          - pattern: |
              $HASH = await argon2.hash($PASSWORD, { type: argon2.argon2id, memoryCost: $MEMORY, timeCost: $TIME, parallelism: $PARALLELISM });
          - pattern: |
              const $LIBRARY = await import("argon2");
              await $LIBRARY.hash($PASSWORD, $OPTIONS);
          - pattern: |
              const $LIBRARY = await import("argon2-browser");
              await $LIBRARY.hash($PASSWORD, $OPTIONS);
          - pattern: |
              const $LIBRARY = require($MODULE);
              await $LIBRARY.hash($PASSWORD, $OPTIONS);
          - patterns:
              - pattern: |
                  await argon2.hash($PASSWORD, { type: argon2.argon2i, memoryCost: $MEMORY, timeCost: $TIME, parallelism: $PARALLELISM })
              - metavariable-comparison:
                  metavariable: $MEMORY
                  comparison: $MEMORY < 65536
          - patterns:
              - pattern: |
                  await argon2.hash($PASSWORD, { type: argon2.argon2i, memoryCost: $MEMORY, timeCost: $TIME, parallelism: $PARALLELISM })
              - metavariable-comparison:
                  metavariable: $TIME
                  comparison: $TIME < 3
    pattern-not-inside:
      - pattern: |
          describe($NAME, () => {
            ...
          })
      - pattern: |
          it($NAME, () => {
            ...
          })
      - pattern: |
          test($NAME, () => {
            ...
          })
      - pattern: |
          // $COMMENT
      - pattern: |
          /* $COMMENT */
    metadata:
      category: crypto
      cwe: CWE-326
      impact: "Inventory: Argon2 key derivation function usage detected in codebase"
  - id: typescript-crypto-cipher-des
    message: DES cipher usage detected
    severity: INFO
    languages:
      - typescript
    focus-metavariable: $KEY
    patterns:
      - pattern-either:
          - pattern: crypto.createCipher("des", $KEY)
          - pattern: crypto.createCipher("des-ede", $KEY)
          - pattern: crypto.createCipher("des-ede3", $KEY)
          - pattern: crypto.createCipheriv("des", $KEY, $IV)
          - pattern: crypto.createCipheriv("des-ede", $KEY, $IV)
          - pattern: crypto.createCipheriv("des-ede3", $KEY, $IV)
          - patterns:
              - pattern: crypto.createCipheriv($ALGORITHM, $KEY, $IV)
              - metavariable-regex:
                  metavariable: $ALGORITHM
                  regex: '"des(-ede|-ede3)?(-cbc|-ecb|-cfb|-ofb)?"'
          - patterns:
              - pattern: crypto.createCipheriv($ALGORITHM, $KEY, $IV)
              - metavariable-regex:
                  metavariable: $ALGORITHM
                  regex: "'des(-ede|-ede3)?(-cbc|-ecb|-cfb|-ofb)?'"
          - patterns:
              - pattern: |
                  const $ALGORITHM = "des-ede3-cbc";
                  ...
                  crypto.createCipheriv($ALGORITHM, $KEY, $IV)
          - pattern: crypto.createDecipher("des", $KEY)
          - pattern: crypto.createDecipher("des-ede", $KEY)
          - pattern: crypto.createDecipher("des-ede3", $KEY)
          - pattern: crypto.createDecipheriv("des", $KEY, $IV)
          - pattern: crypto.createDecipheriv("des-ede", $KEY, $IV)
          - pattern: crypto.createDecipheriv("des-ede3", $KEY, $IV)
          - pattern:
              import * as CryptoJS from "crypto-js"; CryptoJS.DES.encrypt($DATA,
              $KEY)
          - pattern: CryptoJS.DES.encrypt($DATA, $KEY)
          - pattern:
              import * as CryptoJS from "crypto-js"; CryptoJS.DES.decrypt($DATA,
              $KEY)
          - pattern: CryptoJS.DES.decrypt($DATA, $KEY)
          - pattern:
              import * as CryptoJS from "crypto-js"; CryptoJS.TripleDES.encrypt($DATA,
              $KEY)
          - pattern: CryptoJS.TripleDES.encrypt($DATA, $KEY)
          - pattern:
              import * as CryptoJS from "crypto-js"; CryptoJS.TripleDES.decrypt($DATA,
              $KEY)
          - pattern: CryptoJS.TripleDES.decrypt($DATA, $KEY)
          - pattern: require("crypto-js").DES.encrypt($DATA, $KEY)
          - pattern: require("crypto-js").DES.decrypt($DATA, $KEY)
          - pattern: require("crypto-js").TripleDES.encrypt($DATA, $KEY)
          - pattern: require("crypto-js").TripleDES.decrypt($DATA, $KEY)
    pattern-not-inside:
      - pattern: |
          describe($NAME, () => {
            ...
          })
      - pattern: |
          it($NAME, () => {
            ...
          })
      - pattern: |
          test($NAME, () => {
            ...
          })
      - pattern: |
          // $COMMENT
      - pattern: |
          /* $COMMENT */
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: DES cipher usage detected in codebase"
  - id: typescript-crypto-pbkdf2
    message: PBKDF2 key derivation function usage detected
    severity: INFO
    languages:
      - typescript
    focus-metavariable: $PASSWORD
    patterns:
      - pattern-either:
          - pattern: crypto.pbkdf2($PASSWORD, $SALT, $ITER, $KEYLEN, $DIGEST, $CALLBACK)
          - pattern: crypto.pbkdf2Sync($PASSWORD, $SALT, $ITER, $KEYLEN, $DIGEST)
          - pattern: |
              crypto.pbkdf2($PASSWORD, $SALT, $ITER, $KEYLEN, "sha256", function($ERR, $KEY) {
                ...
              });
          - pattern: |
              $KEY = crypto.pbkdf2Sync($PASSWORD, $SALT, $ITER, $KEYLEN, "sha256");
          - patterns:
              - pattern: crypto.pbkdf2Sync($PASSWORD, $SALT, $ITER, $KEYLEN, $DIGEST)
              - metavariable-regex:
                  metavariable: $ITER
                  regex: \d+
              - metavariable-regex:
                  metavariable: $KEYLEN
                  regex: \d+
          - patterns:
              - pattern: crypto.pbkdf2Sync($PASSWORD, $SALT, $ITER, $KEYLEN, $DIGEST)
              - metavariable-comparison:
                  metavariable: $ITER
                  comparison: $ITER < 100000
          - patterns:
              - pattern: |
                  await crypto.subtle.deriveKey(
                    { name: "PBKDF2", salt: $SALT, iterations: $ITER, hash: "SHA-256" },
                    $BASE_KEY,
                    { name: "AES-GCM", length: 256 },
                    false,
                    ["encrypt", "decrypt"]
                  );
              - metavariable-comparison:
                  metavariable: $ITER
                  comparison: $ITER < 100000
          - pattern: |
              $KEY = await crypto.subtle.deriveKey(
                { name: "PBKDF2", salt: $SALT, iterations: $ITER, hash: "SHA-256" },
                $BASE_KEY,
                { name: "AES-GCM", length: 256 },
                false,
                ["encrypt", "decrypt"]
              );
          - patterns:
              - pattern: crypto.pbkdf2Sync($PASSWORD, $SALT, $ITER, $KEYLEN, $DIGEST)
              - metavariable-regex:
                  metavariable: $DIGEST
                  regex: '"(sha256|sha512|sha1|sha384|sha224)"'
          - patterns:
              - pattern: crypto.pbkdf2Sync($PASSWORD, $SALT, $ITER, $KEYLEN, $DIGEST)
              - metavariable-regex:
                  metavariable: $DIGEST
                  regex: "'(sha256|sha512|sha1|sha384|sha224)'"
          - pattern: |
              const $LIBRARY = await import("crypto");
              await $LIBRARY.pbkdf2($PASSWORD, $SALT, $ITER, $KEYLEN, $DIGEST, $CALLBACK);
    pattern-not-inside:
      - pattern: |
          describe($NAME, () => {
            ...
          })
      - pattern: |
          it($NAME, () => {
            ...
          })
      - pattern: |
          test($NAME, () => {
            ...
          })
      - pattern: |
          // $COMMENT
      - pattern: |
          /* $COMMENT */
    metadata:
      category: crypto
      cwe: CWE-326
      impact: "Inventory: PBKDF2 key derivation function usage detected in codebase"
  - id: typescript-crypto-cipher-modes
    message: Cryptographic cipher mode usage detected
    severity: INFO
    languages:
      - typescript
    focus-metavariable: $KEY
    patterns:
      - pattern-either:
          - pattern: crypto.createCipheriv("aes-128-cbc", $KEY, $IV)
          - pattern: crypto.createCipheriv("aes-192-cbc", $KEY, $IV)
          - pattern: crypto.createCipheriv("aes-256-cbc", $KEY, $IV)
          - pattern: crypto.createCipheriv("aes-128-ecb", $KEY, $IV)
          - pattern: crypto.createCipheriv("aes-192-ecb", $KEY, $IV)
          - pattern: crypto.createCipheriv("aes-256-ecb", $KEY, $IV)
          - pattern: crypto.createCipheriv("aes-128-cfb", $KEY, $IV)
          - pattern: crypto.createCipheriv("aes-192-cfb", $KEY, $IV)
          - pattern: crypto.createCipheriv("aes-256-cfb", $KEY, $IV)
          - pattern: crypto.createCipheriv("aes-128-ofb", $KEY, $IV)
          - pattern: crypto.createCipheriv("aes-192-ofb", $KEY, $IV)
          - pattern: crypto.createCipheriv("aes-256-ofb", $KEY, $IV)
          - pattern: crypto.createCipheriv("aes-128-ctr", $KEY, $IV)
          - pattern: crypto.createCipheriv("aes-192-ctr", $KEY, $IV)
          - pattern: crypto.createCipheriv("aes-256-ctr", $KEY, $IV)
          - pattern: crypto.createCipheriv("aes-128-gcm", $KEY, $IV)
          - pattern: crypto.createCipheriv("aes-192-gcm", $KEY, $IV)
          - pattern: crypto.createCipheriv("aes-256-gcm", $KEY, $IV)
          - pattern: crypto.createDecipheriv("aes-128-cbc", $KEY, $IV)
          - pattern: crypto.createDecipheriv("aes-192-cbc", $KEY, $IV)
          - pattern: crypto.createDecipheriv("aes-256-cbc", $KEY, $IV)
          - pattern: crypto.createDecipheriv("aes-128-ecb", $KEY, $IV)
          - pattern: crypto.createDecipheriv("aes-192-ecb", $KEY, $IV)
          - pattern: crypto.createDecipheriv("aes-256-ecb", $KEY, $IV)
          - pattern: crypto.createDecipheriv("aes-128-cfb", $KEY, $IV)
          - pattern: crypto.createDecipheriv("aes-192-cfb", $KEY, $IV)
          - pattern: crypto.createDecipheriv("aes-256-cfb", $KEY, $IV)
          - pattern: crypto.createDecipheriv("aes-128-ofb", $KEY, $IV)
          - pattern: crypto.createDecipheriv("aes-192-ofb", $KEY, $IV)
          - pattern: crypto.createDecipheriv("aes-256-ofb", $KEY, $IV)
          - pattern: crypto.createDecipheriv("aes-128-ctr", $KEY, $IV)
          - pattern: crypto.createDecipheriv("aes-192-ctr", $KEY, $IV)
          - pattern: crypto.createDecipheriv("aes-256-ctr", $KEY, $IV)
          - pattern: crypto.createDecipheriv("aes-128-gcm", $KEY, $IV)
          - pattern: crypto.createDecipheriv("aes-192-gcm", $KEY, $IV)
          - pattern: crypto.createDecipheriv("aes-256-gcm", $KEY, $IV)
          - pattern: |
              $CIPHER: crypto.Cipher = crypto.createCipheriv("aes-256-$MODE", $KEY, $IV);
              $CIPHERTEXT = $CIPHER.update($PLAINTEXT);
              $CIPHERTEXT += $CIPHER.final();
          - pattern: |
              $DECIPHER: crypto.Decipher = crypto.createDecipheriv("aes-256-$MODE", $KEY, $IV);
              $PLAINTEXT = $DECIPHER.update($CIPHERTEXT);
              $PLAINTEXT += $DECIPHER.final();
    pattern-not-inside:
      - pattern: |
          describe($NAME, () => {
            ...
          })
      - pattern: |
          it($NAME, () => {
            ...
          })
      - pattern: |
          test($NAME, () => {
            ...
          })
      - pattern: |
          // $COMMENT
      - pattern: |
          /* $COMMENT */
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: Cryptographic cipher mode usage detected in codebase"
  - id: typescript-crypto-cipher-aes
    message: AES cipher usage detected
    severity: INFO
    languages:
      - typescript
    focus-metavariable: $KEY
    patterns:
      - pattern-either:
          - pattern: crypto.createCipher("aes-128-cbc", $KEY)
          - pattern: crypto.createCipher("aes-192-cbc", $KEY)
          - pattern: crypto.createCipher("aes-256-cbc", $KEY)
          - pattern: crypto.createCipheriv("aes-128-cbc", $KEY, $IV)
          - pattern: crypto.createCipheriv("aes-192-cbc", $KEY, $IV)
          - pattern: crypto.createCipheriv("aes-256-cbc", $KEY, $IV)
          - patterns:
              - pattern: crypto.createCipheriv($ALGORITHM, $KEY, $IV)
              - metavariable-regex:
                  metavariable: $ALGORITHM
                  regex: '"aes-[0-9]+-(cbc|gcm|ctr|cfb|ofb|ecb)"'
          - patterns:
              - pattern: crypto.createCipheriv($ALGORITHM, $KEY, $IV)
              - metavariable-regex:
                  metavariable: $ALGORITHM
                  regex: "'aes-[0-9]+-(cbc|gcm|ctr|cfb|ofb|ecb)'"
          - patterns:
              - pattern: |
                  const $ALGORITHM = "aes-256-cbc";
                  ...
                  crypto.createCipheriv($ALGORITHM, $KEY, $IV)
          - pattern: crypto.createDecipher("aes-128-cbc", $KEY)
          - pattern: crypto.createDecipher("aes-192-cbc", $KEY)
          - pattern: crypto.createDecipher("aes-256-cbc", $KEY)
          - pattern: crypto.createDecipheriv("aes-128-cbc", $KEY, $IV)
          - pattern: crypto.createDecipheriv("aes-192-cbc", $KEY, $IV)
          - pattern: crypto.createDecipheriv("aes-256-cbc", $KEY, $IV)
          - pattern: |
              $CIPHER: crypto.Cipher = crypto.createCipheriv("aes-256-gcm", $KEY, $IV);
              $CIPHERTEXT = $CIPHER.update($PLAINTEXT);
              $CIPHERTEXT += $CIPHER.final();
          - pattern:
              import * as CryptoJS from "crypto-js"; CryptoJS.AES.encrypt($DATA,
              $KEY)
          - pattern: CryptoJS.AES.encrypt($DATA, $KEY)
          - pattern:
              import * as CryptoJS from "crypto-js"; CryptoJS.AES.decrypt($DATA,
              $KEY)
          - pattern: CryptoJS.AES.decrypt($DATA, $KEY)
          - pattern: require("crypto-js").AES.encrypt($DATA, $KEY)
          - pattern: require("crypto-js").AES.decrypt($DATA, $KEY)
          - pattern: |
              $KEY = await crypto.subtle.generateKey(
                { name: "AES-GCM", length: 256 },
                true,
                ["encrypt", "decrypt"]
              );
          - pattern: |
              $KEY = await crypto.subtle.generateKey(
                { name: "AES-CBC", length: 256 },
                true,
                ["encrypt", "decrypt"]
              );
          - pattern: |
              $KEY = await crypto.subtle.generateKey(
                { name: "AES-CTR", length: 256 },
                true,
                ["encrypt", "decrypt"]
              );
          - pattern: |
              $KEY = await crypto.subtle.generateKey(
                { name: "AES-GCM", length: 128 },
                true,
                ["encrypt", "decrypt"]
              );
          - pattern: |
              $KEY = await crypto.subtle.generateKey(
                { name: "AES-GCM", length: 192 },
                true,
                ["encrypt", "decrypt"]
              );
          - pattern: |
              $KEY = await crypto.subtle.generateKey(
                { name: "AES-KW", length: 256 },
                true,
                ["wrapKey", "unwrapKey"]
              );
    pattern-not-inside:
      - pattern: |
          describe($NAME, () => {
            ...
          })
      - pattern: |
          it($NAME, () => {
            ...
          })
      - pattern: |
          test($NAME, () => {
            ...
          })
      - pattern: |
          // $COMMENT
      - pattern: |
          /* $COMMENT */
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: AES cipher usage detected in codebase"
  - id: typescript-crypto-key-length
    message: Cryptographic key length usage detected
    severity: INFO
    languages:
      - typescript
    patterns:
      - pattern-either:
          - patterns:
              - pattern: |
                  crypto.subtle.generateKey({ name: "RSA-OAEP", modulusLength: $BITS, publicExponent: new Uint8Array([1, 0, 1]), hash: "SHA-256" }, $EXTRACTABLE, $USAGE)
              - metavariable-regex:
                  metavariable: $BITS
                  regex: \d+
              - focus-metavariable: $BITS
          - patterns:
              - pattern: |
                  crypto.subtle.generateKey({ name: "RSA-OAEP", modulusLength: $BITS, publicExponent: new Uint8Array([1, 0, 1]), hash: "SHA-256" }, $EXTRACTABLE, $USAGE)
              - metavariable-comparison:
                  metavariable: $BITS
                  comparison: $BITS < 2048
              - focus-metavariable: $BITS
          - patterns:
              - pattern: |
                  crypto.subtle.generateKey({ name: "RSA-PSS", modulusLength: $BITS, publicExponent: new Uint8Array([1, 0, 1]), hash: "SHA-256" }, $EXTRACTABLE, $USAGE)
              - metavariable-regex:
                  metavariable: $BITS
                  regex: \d+
              - focus-metavariable: $BITS
          - patterns:
              - pattern: |
                  crypto.subtle.generateKey({ name: "RSASSA-PKCS1-v1_5", modulusLength: $BITS, publicExponent: new Uint8Array([1, 0, 1]), hash: "SHA-256" }, $EXTRACTABLE, $USAGE)
              - metavariable-regex:
                  metavariable: $BITS
                  regex: \d+
              - focus-metavariable: $BITS
          - patterns:
              - pattern: |
                  crypto.subtle.generateKey({ name: "ECDSA", namedCurve: $CURVE }, $EXTRACTABLE, $USAGE)
              - metavariable-regex:
                  metavariable: $CURVE
                  regex: '"(P-224|P-256|P-384|P-521|secp160k1|secp256k1|prime256v1)"'
              - focus-metavariable: $CURVE
          - pattern: crypto.createECDH($CURVE)
          - patterns:
              - pattern: |
                  crypto.subtle.generateKey({ name: "AES-GCM", length: $LENGTH }, $EXTRACTABLE, $USAGE)
              - metavariable-regex:
                  metavariable: $LENGTH
                  regex: \d+
              - focus-metavariable: $LENGTH
          - patterns:
              - pattern: |
                  crypto.subtle.generateKey({ name: "AES-GCM", length: $LENGTH }, $EXTRACTABLE, $USAGE)
              - metavariable-comparison:
                  metavariable: $LENGTH
                  comparison: $LENGTH < 128
              - focus-metavariable: $LENGTH
          - patterns:
              - pattern: |
                  crypto.subtle.generateKey({ name: "AES-CBC", length: $LENGTH }, $EXTRACTABLE, $USAGE)
              - metavariable-regex:
                  metavariable: $LENGTH
                  regex: \d+
              - focus-metavariable: $LENGTH
          - patterns:
              - pattern: |
                  crypto.subtle.generateKey({ name: "AES-CTR", length: $LENGTH }, $EXTRACTABLE, $USAGE)
              - metavariable-regex:
                  metavariable: $LENGTH
                  regex: \d+
              - focus-metavariable: $LENGTH
          - patterns:
              - pattern: |
                  crypto.subtle.generateKey({ name: "AES-KW", length: $LENGTH }, $EXTRACTABLE, $USAGE)
              - metavariable-regex:
                  metavariable: $LENGTH
                  regex: \d+
              - focus-metavariable: $LENGTH
          - patterns:
              - pattern: |
                  $KEY = Buffer.alloc($SIZE);
                  ...
                  crypto.createCipheriv("aes-256-cbc", $KEY, $IV);
              - metavariable-regex:
                  metavariable: $SIZE
                  regex: \d+
              - focus-metavariable: $SIZE
          - patterns:
              - pattern: |
                  $KEY = new Uint8Array($SIZE);
                  ...
                  await crypto.subtle.importKey("raw", $KEY, { name: "AES-GCM" }, false, ["encrypt", "decrypt"]);
              - metavariable-regex:
                  metavariable: $SIZE
                  regex: \d+
              - focus-metavariable: $SIZE
          - patterns:
              - pattern: crypto.pbkdf2Sync($PASSWORD, $SALT, $ITER, $KEYLEN, $DIGEST)
              - metavariable-regex:
                  metavariable: $KEYLEN
                  regex: \d+
              - focus-metavariable: $KEYLEN
          - patterns:
              - pattern: crypto.scryptSync($PASSWORD, $SALT, $KEYLEN, $OPTIONS)
              - metavariable-regex:
                  metavariable: $KEYLEN
                  regex: \d+
              - focus-metavariable: $KEYLEN
          - patterns:
              - pattern: |
                  await crypto.subtle.deriveKey(
                    { name: "PBKDF2", salt: $SALT, iterations: $ITER, hash: "SHA-256" },
                    $BASE_KEY,
                    { name: "AES-GCM", length: $LENGTH },
                    false,
                    ["encrypt", "decrypt"]
                  );
              - metavariable-regex:
                  metavariable: $LENGTH
                  regex: \d+
              - focus-metavariable: $LENGTH
    pattern-not-inside:
      - pattern: |
          describe($NAME, () => {
            ...
          })
      - pattern: |
          it($NAME, () => {
            ...
          })
      - pattern: |
          test($NAME, () => {
            ...
          })
      - pattern: |
          // $COMMENT
      - pattern: |
          /* $COMMENT */
    metadata:
      category: crypto
      cwe: CWE-326
      impact: "Inventory: Cryptographic key length usage detected in codebase"
  - id: typescript-crypto-random-generation
    message: Random number generation for cryptographic use detected
    severity: INFO
    languages:
      - typescript
    focus-metavariable: $LENGTH
    patterns:
      - pattern-either:
          - pattern: crypto.randomBytes($LENGTH)
          - pattern: crypto.getRandomValues($ARRAY)
          - pattern: |
              $BYTES: Buffer = crypto.randomBytes($LENGTH);
              ...
              $BYTES
          - pattern: |
              $ARRAY = new Uint8Array($LENGTH);
              crypto.getRandomValues($ARRAY);
          - pattern: |
              $KEY = await crypto.subtle.generateKey(
                { name: "AES-GCM", length: 256 },
                true,
                ["encrypt", "decrypt"]
              );
          - pattern: |
              $IV = new Uint8Array(12);
              crypto.getRandomValues($IV);
    pattern-not-inside:
      - pattern: |
          describe($NAME, () => {
            ...
          })
      - pattern: |
          it($NAME, () => {
            ...
          })
      - pattern: |
          test($NAME, () => {
            ...
          })
      - pattern: |
          // $COMMENT
      - pattern: |
          /* $COMMENT */
    metadata:
      category: crypto
      cwe: CWE-338
      impact:
        "Inventory: Random number generation for cryptographic use detected in
        codebase"
  - id: typescript-crypto-sha512
    message: SHA512 hash function usage detected
    severity: INFO
    languages:
      - typescript
    focus-metavariable: $DATA
    patterns:
      - pattern-either:
          - pattern: crypto.createHash("sha512")
          - pattern: crypto.createHash('sha512')
          - pattern: crypto.createHash("sha384")
          - pattern: crypto.createHash('sha384')
          - pattern: |
              $HASHER: crypto.Hash = crypto.createHash("sha512");
              $HASHER.update($DATA);
              $HASH = $HASHER.digest();
          - pattern: |
              $HASHER: crypto.Hash = crypto.createHash("sha384");
              $HASHER.update($DATA);
              $HASH = $HASHER.digest();
          - pattern: crypto.createHash("sha512").update($DATA).digest()
          - pattern: crypto.createHash("sha384").update($DATA).digest()
          - pattern: import * as CryptoJS from "crypto-js"; CryptoJS.SHA512($DATA)
          - pattern: import * as CryptoJS from "crypto-js"; CryptoJS.SHA384($DATA)
          - pattern: CryptoJS.SHA512($DATA)
          - pattern: CryptoJS.SHA384($DATA)
          - pattern: require("crypto-js").SHA512($DATA)
          - pattern: require("crypto-js").SHA384($DATA)
          - pattern: |
              await crypto.subtle.digest("SHA-512", $DATA);
          - pattern: |
              await crypto.subtle.digest("SHA-384", $DATA);
          - patterns:
              - pattern: crypto.createHash($ALGORITHM)
              - metavariable-regex:
                  metavariable: $ALGORITHM
                  regex: '"(sha512|sha384)"'
          - patterns:
              - pattern: crypto.createHash($ALGORITHM)
              - metavariable-regex:
                  metavariable: $ALGORITHM
                  regex: "'(sha512|sha384)'"
          - patterns:
              - pattern: |
                  await crypto.subtle.digest($ALGORITHM, $DATA);
              - metavariable-regex:
                  metavariable: $ALGORITHM
                  regex: '"(SHA-512|SHA-384)"'
          - patterns:
              - pattern: |
                  await crypto.subtle.digest($ALGORITHM, $DATA);
              - metavariable-regex:
                  metavariable: $ALGORITHM
                  regex: "'(SHA-512|SHA-384)'"
    pattern-not-inside:
      - pattern: |
          describe($NAME, () => {
            ...
          })
      - pattern: |
          it($NAME, () => {
            ...
          })
      - pattern: |
          test($NAME, () => {
            ...
          })
      - pattern: |
          // $COMMENT
      - pattern: |
          /* $COMMENT */
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: SHA512 hash function usage detected in codebase"
  - id: typescript-crypto-ecdsa
    message: ECDSA cryptographic operations detected
    severity: INFO
    languages:
      - typescript
    focus-metavariable: $KEY
    patterns:
      - pattern-either:
          - pattern: crypto.createSign("ecdsa-with-SHA256")
          - pattern: crypto.createSign("ecdsa-with-SHA512")
          - pattern: crypto.createVerify("ecdsa-with-SHA256")
          - pattern: crypto.createVerify("ecdsa-with-SHA512")
          - pattern: |
              $SIGN: crypto.Sign = crypto.createSign("ecdsa-with-SHA256");
              $SIGN.update($DATA);
              $SIGNATURE = $SIGN.sign($PRIVATE_KEY);
          - pattern: |
              $VERIFY: crypto.Verify = crypto.createVerify("ecdsa-with-SHA256");
              $VERIFY.update($DATA);
              $VERIFY.verify($PUBLIC_KEY, $SIGNATURE);
          - pattern: crypto.createECDH("prime256v1")
          - pattern: crypto.createECDH("secp256k1")
          - pattern: crypto.createECDH("secp384r1")
          - pattern: crypto.createECDH("secp521r1")
          - pattern: |
              $ECDH: crypto.ECDH = crypto.createECDH("prime256v1");
              $ECDH.generateKeys();
              $SHARED = $ECDH.computeSecret($PUBLIC_KEY);
          - pattern: |
              $KEY = await crypto.subtle.generateKey({ name: "ECDSA", namedCurve: "P-256" }, $EXTRACTABLE, $USAGE);
          - pattern: |
              $KEY = await crypto.subtle.generateKey({ name: "ECDSA", namedCurve: "P-384" }, $EXTRACTABLE, $USAGE);
          - pattern: |
              $KEY = await crypto.subtle.generateKey({ name: "ECDSA", namedCurve: "P-521" }, $EXTRACTABLE, $USAGE);
          - pattern: |
              await crypto.subtle.sign({ name: "ECDSA", hash: "SHA-256" }, $PRIVATE_KEY, $DATA);
          - pattern: |
              await crypto.subtle.verify({ name: "ECDSA", hash: "SHA-256" }, $PUBLIC_KEY, $SIGNATURE, $DATA);
          - pattern: |
              $KEY = await crypto.subtle.generateKey({ name: "Ed25519" }, $EXTRACTABLE, $USAGE);
          - pattern: |
              await crypto.subtle.sign({ name: "Ed25519" }, $PRIVATE_KEY, $DATA);
          - pattern: |
              await crypto.subtle.verify({ name: "Ed25519" }, $PUBLIC_KEY, $SIGNATURE, $DATA);
    pattern-not-inside:
      - pattern: |
          describe($NAME, () => {
            ...
          })
      - pattern: |
          it($NAME, () => {
            ...
          })
      - pattern: |
          test($NAME, () => {
            ...
          })
      - pattern: |
          // $COMMENT
      - pattern: |
          /* $COMMENT */
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: ECDSA cryptographic operations detected in codebase"
  - id: python-crypto-cipher-aes
    message: AES cipher usage detected
    severity: INFO
    languages:
      - python
    focus-metavariable: $KEY
    paths:
      include:
        - "**/*.py"
        - "**/*.pyi"
      exclude:
        - "**/__pycache__/**"
        - "**/*.pyc"
    patterns:
      - pattern-either:
          - pattern: AES.new($KEY, $MODE)
          - pattern: AES.new($KEY, AES.MODE_ECB)
          - pattern: AES.new($KEY, AES.MODE_CBC, $IV)
          - pattern: AES.new($KEY, AES.MODE_GCM, $NONCE)
          - pattern: |
              $CIPHER = AES.new($KEY, $MODE)
              $CIPHERTEXT = $CIPHER.encrypt($PLAINTEXT)
          - pattern: |
              $CIPHER = AES.new($KEY, $MODE)
              $PLAINTEXT = $CIPHER.decrypt($CIPHERTEXT)
          - pattern: cryptography.hazmat.primitives.ciphers.algorithms.AES($KEY)
          - pattern: Cipher(algorithms.AES($KEY), $MODE)
          - pattern: |
              from Crypto.Cipher import AES
              $CIPHER = AES.new($KEY, $MODE)
              $CIPHERTEXT = $CIPHER.encrypt($PLAINTEXT)
          - pattern: |
              from Crypto.Cipher import AES
              $CIPHER = AES.new($KEY, $MODE)
              $PLAINTEXT = $CIPHER.decrypt($CIPHERTEXT)
          - pattern: |
              from cryptography.hazmat.primitives.ciphers import Cipher, algorithms, modes
              $CIPHER = Cipher(algorithms.AES($KEY), $MODE, $BACKEND)
              $ENCRYPTOR = $CIPHER.encryptor()
              $CIPHERTEXT = $ENCRYPTOR.update($PLAINTEXT) + $ENCRYPTOR.finalize()
          - pattern: |
              from cryptography.hazmat.primitives.ciphers import Cipher, algorithms, modes
              $CIPHER = Cipher(algorithms.AES($KEY), $MODE, $BACKEND)
              $DECRYPTOR = $CIPHER.decryptor()
              $PLAINTEXT = $DECRYPTOR.update($CIPHERTEXT) + $DECRYPTOR.finalize()
          - patterns:
              - pattern-inside: |
                  $KEY = os.urandom($LENGTH)
                  ...
              - metavariable-pattern:
                  metavariable: $KEY
                  patterns:
                    - pattern: AES.new($KEY, $MODE)
                    - pattern: Cipher(algorithms.AES($KEY), $MODE, $BACKEND)
    pattern-not-inside:
      - pattern: |
          """
          $DOCSTRING
          """
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: AES cipher usage detected in codebase"
  - id: python-crypto-hkdf
    message: HKDF key derivation function usage detected
    severity: INFO
    languages:
      - python
    patterns:
      - pattern-either:
          - pattern: HKDF($LENGTH, $SALT, $INFO, $HASH, $BACKEND)
          - pattern: |
              $HKDF = HKDF($LENGTH, $SALT, $INFO, $HASH, $BACKEND)
              $KEY = $HKDF.derive($KEY_MATERIAL)
          - pattern: |
              $HKDF = HKDF($LENGTH, $SALT, $INFO, $HASH, $BACKEND)
              $KEY = $HKDF.derive($KEY_MATERIAL)
          - pattern: HKDF.extract($SALT, $INPUT_MATERIAL)
          - pattern: HKDF.expand($PRK, $INFO, $LENGTH)
          - pattern: |
              from Crypto.Protocol.KDF import HKDF
              $KEY = HKDF($LENGTH, $SALT, $INFO, $HASH)
          - pattern: |
              from Crypto.Protocol.KDF import HKDF
              $KEY = HKDF($LENGTH, $SALT, $INFO, $HASH, $BACKEND)
          - pattern: |
              from cryptography.hazmat.primitives.kdf.hkdf import HKDF
              $HKDF = HKDF($ALGORITHM, $LENGTH, $SALT, $INFO, $BACKEND)
              $KEY = $HKDF.derive($KEY_MATERIAL)
          - pattern: |
              from cryptography.hazmat.primitives.kdf.hkdf import HKDF
              $HKDF = HKDF($ALGORITHM, $LENGTH, $SALT, $INFO, $BACKEND)
              $KEY = $HKDF.derive($KEY_MATERIAL)
          - pattern: |
              from cryptography.hazmat.primitives.kdf.hkdf import HKDFExpand
              $HKDF = HKDFExpand($ALGORITHM, $LENGTH, $INFO, $BACKEND)
              $KEY = $HKDF.derive($PRK)
          - pattern: |
              from cryptography.hazmat.primitives.kdf.hkdf import HKDFExtract
              $HKDF = HKDFExtract($ALGORITHM, $SALT, $BACKEND)
              $PRK = $HKDF.extract($INPUT_MATERIAL)
    pattern-not-inside:
      - pattern: |
          """
          $DOCSTRING
          """
    metadata:
      category: crypto
      cwe: CWE-326
      impact: "Inventory: HKDF key derivation function usage detected in codebase"
  - id: python-crypto-diffie-hellman
    message: Diffie-Hellman key exchange usage detected
    severity: INFO
    languages:
      - python
    patterns:
      - pattern-either:
          - pattern: dh.generate_parameters($GENERATOR, $KEY_SIZE, $BACKEND)
          - pattern: |
              $PARAMETERS = dh.generate_parameters($GENERATOR, $KEY_SIZE, $BACKEND)
              $PRIVATE_KEY = dh.generate_private_key($PARAMETERS, $BACKEND)
          - pattern: dh.generate_private_key($PARAMETERS, $BACKEND)
          - pattern: |
              $PRIVATE_KEY = dh.generate_private_key($PARAMETERS, $BACKEND)
              $PUBLIC_KEY = $PRIVATE_KEY.public_key()
          - pattern: |
              $PRIVATE_KEY = dh.generate_private_key($PARAMETERS, $BACKEND)
              ...
              $SHARED_KEY = $PRIVATE_KEY.exchange($PUBLIC_KEY)
          - pattern: |
              $PRIVATE_KEY = dh.generate_private_key($PARAMETERS, $BACKEND)
              ...
              $SHARED_KEY = dh.derive_shared_key($PRIVATE_KEY, $PUBLIC_KEY)
          - pattern: dh.DHParameterNumbers($P, $G)
          - pattern: dh.DHPrivateNumbers($PRIVATE_VALUE, $PUBLIC_NUMBERS)
          - pattern: dh.DHPublicNumbers($Y, $PARAMETER_NUMBERS)
          - pattern: |
              from cryptography.hazmat.primitives.asymmetric import dh
              $PARAMETERS = dh.generate_parameters($GENERATOR, $KEY_SIZE, $BACKEND)
          - pattern: |
              from cryptography.hazmat.primitives.asymmetric import dh
              $PRIVATE_KEY = dh.generate_private_key($PARAMETERS, $BACKEND)
          - pattern: |
              from cryptography.hazmat.primitives.asymmetric import dh
              $PRIVATE_KEY = dh.generate_private_key($PARAMETERS, $BACKEND)
              $PUBLIC_KEY = $PRIVATE_KEY.public_key()
              $SHARED_KEY = $PRIVATE_KEY.exchange($PUBLIC_KEY)
          - pattern: |
              from cryptography.hazmat.primitives.asymmetric import dh
              $PARAM_NUMS = dh.DHParameterNumbers($P, $G)
              $PARAMETERS = $PARAM_NUMS.parameters($BACKEND)
          - pattern: |
              from cryptography.hazmat.primitives.asymmetric import dh
              $PRIV_NUMS = dh.DHPrivateNumbers($PRIVATE_VALUE, $PUBLIC_NUMS)
              $PRIVATE_KEY = $PRIV_NUMS.private_key($BACKEND)
    pattern-not-inside:
      - pattern: |
          """
          $DOCSTRING
          """
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: Diffie-Hellman key exchange usage detected in codebase"
  - id: python-crypto-key-length
    message: Cryptographic key length configuration detected
    severity: INFO
    languages:
      - python
    paths:
      include:
        - "**/*.py"
        - "**/*.pyi"
      exclude:
        - "**/__pycache__/**"
        - "**/*.pyc"
    focus-metavariable: $KEY_SIZE
    patterns:
      - pattern-either:
          - pattern: |
              $PRIVATE_KEY = rsa.generate_private_key($PUBLIC_EXPONENT, $KEY_SIZE, $BACKEND)
          - patterns:
              - pattern: |
                  $PRIVATE_KEY = rsa.generate_private_key($PUBLIC_EXPONENT, $KEY_SIZE, $BACKEND)
              - metavariable-regex:
                  metavariable: $KEY_SIZE
                  regex: \d+
          - patterns:
              - pattern: |
                  $PRIVATE_KEY = rsa.generate_private_key($PUBLIC_EXPONENT, $KEY_SIZE, $BACKEND)
              - metavariable-comparison:
                  metavariable: $KEY_SIZE
                  comparison: $KEY_SIZE < 2048
          - pattern: |
              from Crypto.PublicKey import RSA
              $KEY = RSA.generate($BITS)
          - patterns:
              - pattern: |
                  from Crypto.PublicKey import RSA
                  $KEY = RSA.generate($BITS)
              - metavariable-regex:
                  metavariable: $BITS
                  regex: \d+
          - patterns:
              - pattern: |
                  from Crypto.PublicKey import RSA
                  $KEY = RSA.generate($BITS)
              - metavariable-comparison:
                  metavariable: $BITS
                  comparison: $BITS < 2048
          - pattern: |
              from Crypto.Cipher import AES
              $KEY = os.urandom($KEY_LENGTH)
              $CIPHER = AES.new($KEY, $MODE)
          - patterns:
              - pattern: |
                  from Crypto.Cipher import AES
                  $KEY = os.urandom($KEY_LENGTH)
                  $CIPHER = AES.new($KEY, $MODE)
              - metavariable-regex:
                  metavariable: $KEY_LENGTH
                  regex: \d+
          - pattern: |
              from cryptography.hazmat.primitives.ciphers.algorithms import AES
              $KEY = os.urandom($KEY_LENGTH)
              $CIPHER = Cipher(AES($KEY), $MODE, $BACKEND)
          - patterns:
              - pattern: |
                  from cryptography.hazmat.primitives.ciphers.algorithms import AES
                  $KEY = os.urandom($KEY_LENGTH)
                  $CIPHER = Cipher(AES($KEY), $MODE, $BACKEND)
              - metavariable-regex:
                  metavariable: $KEY_LENGTH
                  regex: (8|12|16|24|32|64|128|256|512|1024|2048|4096)
          - patterns:
              - pattern: |
                  from Crypto.Cipher import AES
                  $KEY = os.urandom($KEY_LENGTH)
                  $CIPHER = AES.new($KEY, $MODE)
              - metavariable-comparison:
                  metavariable: $KEY_LENGTH
                  comparison: $KEY_LENGTH < 16
          - patterns:
              - pattern: |
                  from Crypto.Cipher import AES
                  $KEY = os.urandom($KEY_LENGTH)
                  $CIPHER = AES.new($KEY, $MODE)
              - metavariable-regex:
                  metavariable: $KEY_LENGTH
                  regex: (8|12|16|24|32|64|128|256|512|1024|2048|4096)
          - patterns:
              - pattern: |
                  from cryptography.hazmat.primitives.ciphers.algorithms import AES
                  $KEY = os.urandom($KEY_LENGTH)
                  $CIPHER = Cipher(AES($KEY), $MODE, $BACKEND)
              - metavariable-comparison:
                  metavariable: $KEY_LENGTH
                  comparison: $KEY_LENGTH < 16
    pattern-not-inside:
      - pattern: |
          """
          $DOCSTRING
          """
    metadata:
      category: crypto
      cwe: CWE-326
      impact: "Inventory: Cryptographic key length configuration detected in codebase"
  - id: python-crypto-cipher-3des
    message: 3DES (Triple DES) cipher usage detected
    severity: INFO
    languages:
      - python
    focus-metavariable: $KEY
    paths:
      include:
        - "**/*.py"
        - "**/*.pyi"
      exclude:
        - "**/__pycache__/**"
        - "**/*.pyc"
    patterns:
      - pattern-either:
          - pattern: DES3.new($KEY, $MODE)
          - pattern: TripleDES.new($KEY, $MODE)
          - pattern: |
              $CIPHER = DES3.new($KEY, $MODE)
              $CIPHERTEXT = $CIPHER.encrypt($PLAINTEXT)
          - pattern: |
              $CIPHER = DES3.new($KEY, $MODE)
              $PLAINTEXT = $CIPHER.decrypt($CIPHERTEXT)
          - pattern: |
              $CIPHER = TripleDES.new($KEY, $MODE)
              $CIPHERTEXT = $CIPHER.encrypt($PLAINTEXT)
          - pattern: |
              $CIPHER = TripleDES.new($KEY, $MODE)
              $PLAINTEXT = $CIPHER.decrypt($CIPHERTEXT)
          - pattern: cryptography.hazmat.primitives.ciphers.algorithms.TripleDES($KEY)
          - pattern: |
              from Crypto.Cipher import DES3
              $CIPHER = DES3.new($KEY, $MODE)
              $CIPHERTEXT = $CIPHER.encrypt($PLAINTEXT)
          - pattern: |
              from Crypto.Cipher import DES3
              $CIPHER = DES3.new($KEY, $MODE)
              $PLAINTEXT = $CIPHER.decrypt($CIPHERTEXT)
          - pattern: |
              from cryptography.hazmat.primitives.ciphers import Cipher, algorithms, modes
              $CIPHER = Cipher(algorithms.TripleDES($KEY), $MODE, $BACKEND)
    pattern-not-inside:
      - pattern: |
          """
          $DOCSTRING
          """
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: 3DES (Triple DES) cipher usage detected in codebase"
  - id: python-crypto-key-derivation
    message: Key derivation function usage detected
    severity: INFO
    languages:
      - python
    paths:
      include:
        - "**/*.py"
        - "**/*.pyi"
      exclude:
        - "**/__pycache__/**"
        - "**/*.pyc"
    focus-metavariable: $PASSWORD
    patterns:
      - pattern-either:
          - pattern: hashlib.pbkdf2_hmac($HASH_NAME, $PASSWORD, $SALT, $ITER)
          - pattern: hashlib.pbkdf2_hmac($HASH_NAME, $PASSWORD, $SALT, $ITER, dklen=$KEYLEN)
          - patterns:
              - pattern: hashlib.pbkdf2_hmac("$HASH", $PASSWORD, $SALT, $ITER)
              - metavariable-regex:
                  metavariable: $HASH
                  regex: (md5|sha1|sha224|sha256|sha384|sha512|sha3_224|sha3_256|sha3_384|sha3_512)
          - patterns:
              - pattern: hashlib.pbkdf2_hmac($HASH_NAME, $PASSWORD, $SALT, $ITER)
              - metavariable-comparison:
                  metavariable: $ITER
                  comparison: $ITER < 100000
          - patterns:
              - pattern: scrypt.hash($PASSWORD, $SALT, $N, $R, $P)
              - metavariable-comparison:
                  metavariable: $N
                  comparison: $N < 16384
          - pattern: |
              $KEY = hashlib.pbkdf2_hmac($HASH_NAME, $PASSWORD, $SALT, $ITER)
              ...
              $KEY
          - pattern: argon2.hash_password($PASSWORD, $SALT)
          - pattern: argon2.verify_password($HASH, $PASSWORD)
          - pattern: scrypt.hash($PASSWORD, $SALT, $N, $R, $P)
          - pattern: scrypt.verify($HASH, $PASSWORD)
    pattern-not-inside:
      - pattern: |
          """
          $DOCSTRING
          """
    metadata:
      category: crypto
      cwe: CWE-326
      impact: "Inventory: Key derivation function usage detected in codebase"
  - id: python-crypto-tls-version
    message: TLS version configuration detected
    severity: INFO
    languages:
      - python
    focus-metavariable: $VERSION
    paths:
      include:
        - "**/*.py"
        - "**/*.pyi"
      exclude:
        - "**/__pycache__/**"
        - "**/*.pyc"
    patterns:
      - pattern-either:
          - pattern: ssl.PROTOCOL_SSLv2
          - pattern: ssl.PROTOCOL_SSLv3
          - pattern: ssl.PROTOCOL_TLSv1
          - pattern: ssl.PROTOCOL_TLSv1_1
          - pattern: ssl.PROTOCOL_TLSv1_2
          - pattern: ssl.PROTOCOL_TLSv1_3
          - pattern: ssl.create_default_context(ssl.PROTOCOL_TLSv1)
          - pattern: |
              $CONTEXT = ssl.create_default_context()
              $CONTEXT.minimum_version = ssl.TLSVersion.$VERSION
          - pattern: |
              $CONTEXT = ssl.SSLContext(ssl.PROTOCOL_TLSv1_2)
              ...
    pattern-not-inside:
      - pattern: |
          """
          $DOCSTRING
          """
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: TLS version configuration detected in codebase"
  - id: python-crypto-random-generation
    message: Random number generation for cryptographic use detected
    severity: INFO
    languages:
      - python
    focus-metavariable: $LENGTH
    paths:
      include:
        - "**/*.py"
        - "**/*.pyi"
      exclude:
        - "**/__pycache__/**"
        - "**/*.pyc"
    patterns:
      - pattern-either:
          - pattern: secrets.token_bytes($LENGTH)
          - pattern: secrets.token_hex($LENGTH)
          - pattern: secrets.token_urlsafe($LENGTH)
          - pattern: os.urandom($LENGTH)
          - patterns:
              - pattern: secrets.token_bytes($LENGTH)
              - metavariable-regex:
                  metavariable: $LENGTH
                  regex: (8|12|16|24|32|64|128|256|512|1024|2048|4096)
          - patterns:
              - pattern: os.urandom($LENGTH)
              - metavariable-regex:
                  metavariable: $LENGTH
                  regex: (8|12|16|24|32|64|128|256|512|1024|2048|4096)
          - pattern: random.getrandbits($BITS)
          - pattern: random.randint($MIN, $MAX)
          - pattern: random.random()
          - pattern: |
              $KEY = secrets.token_bytes($LENGTH)
              ...
              $KEY
          - pattern: |
              $IV = os.urandom($LENGTH)
              ...
              $IV
    pattern-not-inside:
      - pattern: |
          """
          $DOCSTRING
          """
    metadata:
      category: crypto
      cwe: CWE-338
      impact:
        "Inventory: Random number generation for cryptographic use detected in
        codebase"
  - id: python-crypto-cipher-camellia
    message: Camellia cipher usage detected
    severity: INFO
    languages:
      - python
    patterns:
      - pattern-either:
          - pattern: Camellia.new($KEY, $MODE)
          - pattern: Camellia.new($KEY, Camellia.MODE_ECB)
          - pattern: Camellia.new($KEY, Camellia.MODE_CBC, $IV)
          - pattern: Camellia.new($KEY, Camellia.MODE_CFB, $IV)
          - pattern: Camellia.new($KEY, Camellia.MODE_OFB, $IV)
          - pattern: Camellia.new($KEY, Camellia.MODE_CTR, $COUNTER)
          - pattern: Camellia.new($KEY, Camellia.MODE_GCM, $NONCE)
          - pattern: |
              $CIPHER = Camellia.new($KEY, $MODE)
              $CIPHERTEXT = $CIPHER.encrypt($PLAINTEXT)
          - pattern: |
              $CIPHER = Camellia.new($KEY, $MODE)
              $PLAINTEXT = $CIPHER.decrypt($CIPHERTEXT)
          - pattern: |
              from Crypto.Cipher import Camellia
              $CIPHER = Camellia.new($KEY, $MODE)
              $CIPHERTEXT = $CIPHER.encrypt($PLAINTEXT)
          - pattern: |
              from Crypto.Cipher import Camellia
              $CIPHER = Camellia.new($KEY, $MODE)
              $PLAINTEXT = $CIPHER.decrypt($CIPHERTEXT)
          - pattern: cryptography.hazmat.primitives.ciphers.algorithms.Camellia($KEY)
          - pattern: Cipher(algorithms.Camellia($KEY), $MODE)
          - pattern: |
              from cryptography.hazmat.primitives.ciphers import Cipher, algorithms, modes
              $CIPHER = Cipher(algorithms.Camellia($KEY), $MODE, $BACKEND)
    pattern-not-inside:
      - pattern: |
          """
          $DOCSTRING
          """
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: Camellia cipher usage detected in codebase"
  - id: python-crypto-blake2
    message: BLAKE2 hash function usage detected
    severity: INFO
    languages:
      - python
    focus-metavariable: $DATA
    paths:
      include:
        - "**/*.py"
        - "**/*.pyi"
      exclude:
        - "**/__pycache__/**"
        - "**/*.pyc"
    patterns:
      - pattern-either:
          - pattern: hashlib.blake2b($DATA)
          - pattern: hashlib.blake2s($DATA)
          - pattern: hashlib.blake2b($DATA, digest_size=$SIZE)
          - pattern: hashlib.blake2s($DATA, digest_size=$SIZE)
          - pattern: hashlib.blake2b($DATA, key=$KEY)
          - pattern: hashlib.blake2b($DATA, salt=$SALT)
          - pattern: hashlib.blake2b($DATA, person=$PERSON)
          - pattern: hashlib.blake2b($DATA, key=$KEY, salt=$SALT)
          - pattern: hashlib.blake2b($DATA, key=$KEY, salt=$SALT, person=$PERSON)
          - pattern: hashlib.blake2b($DATA, key=$KEY, salt=$SALT, person=$PERSON, digest_size=$SIZE)
          - pattern: hashlib.blake2s($DATA, key=$KEY)
          - pattern: hashlib.blake2s($DATA, salt=$SALT)
          - pattern: hashlib.blake2s($DATA, person=$PERSON)
          - pattern: hashlib.blake2s($DATA, key=$KEY, salt=$SALT)
          - pattern: hashlib.blake2s($DATA, key=$KEY, salt=$SALT, person=$PERSON)
          - pattern: hashlib.blake2s($DATA, key=$KEY, salt=$SALT, person=$PERSON, digest_size=$SIZE)
          - pattern: |
              $HASHER = hashlib.blake2b($DATA)
              $HASH = $HASHER.digest()
          - pattern: |
              $HASHER = hashlib.blake2b($DATA, key=$KEY)
              $HASHER.update($MORE_DATA)
              $HASH = $HASHER.digest()
          - pattern: |
              $HASHER = hashlib.blake2b($DATA, key=$KEY, salt=$SALT)
              $HASHER.update($MORE_DATA)
              $HASH = $HASHER.digest()
          - pattern: |
              $HASHER = hashlib.blake2s($DATA, key=$KEY)
              $HASHER.update($MORE_DATA)
              $HASH = $HASHER.digest()
          - pattern: hashlib.blake2b($DATA).hexdigest()
          - pattern: hashlib.blake2s($DATA).hexdigest()
          - pattern: hashlib.blake2b($DATA, key=$KEY).hexdigest()
          - pattern: hashlib.blake2s($DATA, key=$KEY).hexdigest()
          - patterns:
              - pattern: hashlib.blake2b($DATA, digest_size=$SIZE)
              - metavariable-regex:
                  metavariable: $SIZE
                  regex: (16|20|28|32|48|64)
          - patterns:
              - pattern: hashlib.blake2s($DATA, digest_size=$SIZE)
              - metavariable-regex:
                  metavariable: $SIZE
                  regex: (16|20|28|32)
    pattern-not-inside:
      - pattern: |
          """
          $DOCSTRING
          """
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: BLAKE2 hash function usage detected in codebase"
  - id: python-crypto-ecdsa
    message: ECDSA cryptographic operations detected
    severity: INFO
    languages:
      - python
    paths:
      include:
        - "**/*.py"
        - "**/*.pyi"
      exclude:
        - "**/__pycache__/**"
        - "**/*.pyc"
    focus-metavariable: $PRIVATE_KEY
    patterns:
      - pattern-either:
          - pattern: ec.generate_private_key($CURVE, $BACKEND)
          - pattern: |
              $PRIVATE_KEY = ec.generate_private_key($CURVE, $BACKEND)
              $PUBLIC_KEY = $PRIVATE_KEY.public_key()
          - pattern: ec.SECP256R1()
          - pattern: ec.SECP384R1()
          - pattern: ec.SECP521R1()
          - pattern: ec.SECP256K1()
          - pattern: ec.BrainpoolP256R1()
          - pattern: ec.BrainpoolP384R1()
          - pattern: ec.BrainpoolP512R1()
          - pattern: |
              $PRIVATE_KEY = ec.generate_private_key($CURVE, $BACKEND)
              ...
              $PRIVATE_KEY.sign($DATA, $ALGORITHM)
          - patterns:
              - pattern-inside: |
                  $PRIVATE_KEY = ec.generate_private_key($CURVE, $BACKEND)
                  ...
              - metavariable-pattern:
                  metavariable: $PRIVATE_KEY
                  patterns:
                    - pattern: $PRIVATE_KEY.sign($DATA, $ALGORITHM)
          - pattern: |
              $PUBLIC_KEY = $PRIVATE_KEY.public_key()
              ...
              $PUBLIC_KEY.verify($SIGNATURE, $DATA, $ALGORITHM)
          - pattern: |
              from ecdsa import SigningKey
              $KEY = SigningKey.generate(curve=$CURVE)
          - pattern: |
              from ecdsa import SigningKey
              $KEY = SigningKey.from_string($KEY_DATA, curve=$CURVE)
          - pattern: |
              from ecdsa import SigningKey
              $KEY = SigningKey.generate(curve=$CURVE)
              ...
              $SIGNATURE = $KEY.sign($DATA)
          - pattern: |
              from ecdsa import VerifyingKey
              $KEY = VerifyingKey.from_string($KEY_DATA, curve=$CURVE)
              ...
              $KEY.verify($SIGNATURE, $DATA)
          - pattern: |
              from ecdsa import curves
              $CURVE = curves.SECP256k1
          - pattern: |
              from ecdsa import curves
              $CURVE = curves.NIST256p
          - pattern: |
              from ecdsa import curves
              $CURVE = curves.NIST384p
          - pattern: |
              from ecdsa import curves
              $CURVE = curves.NIST521p
    pattern-not-inside:
      - pattern: |
          """
          $DOCSTRING
          """
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: ECDSA cryptographic operations detected in codebase"
  - id: python-crypto-sha1
    message: SHA1 hash function usage detected
    severity: INFO
    languages:
      - python
    focus-metavariable: $DATA
    paths:
      include:
        - "**/*.py"
        - "**/*.pyi"
      exclude:
        - "**/__pycache__/**"
        - "**/*.pyc"
    patterns:
      - pattern-either:
          - pattern: hashlib.sha1($DATA)
          - pattern: hashlib.sha1()
          - pattern: |
              $HASHER = hashlib.sha1()
              $HASHER.update($DATA)
              $HASH = $HASHER.digest()
          - pattern: |
              $HASHER = hashlib.sha1()
              ...
              $HASH = $HASHER.hexdigest()
          - pattern: hashlib.sha1($DATA).hexdigest()
          - pattern: hashlib.sha1($DATA).digest()
          - pattern: hmac.new($KEY, $MSG, hashlib.sha1)
          - pattern: hmac.new($KEY, $MSG, digestmod=hashlib.sha1)
          - pattern: pbkdf2_hmac("sha1", $PASSWORD, $SALT, $ITER)
          - patterns:
              - pattern: pbkdf2_hmac("sha1", $PASSWORD, $SALT, $ITER)
              - metavariable-comparison:
                  metavariable: $ITER
                  comparison: $ITER < 100000
          - patterns:
              - pattern: hashlib.sha1($DATA)
              - metavariable-regex:
                  metavariable: $DATA
                  regex: .+
    pattern-not-inside:
      - pattern: |
          """
          $DOCSTRING
          """
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: SHA1 hash function usage detected in codebase"
  - id: python-crypto-sha3
    message: SHA3 hash function usage detected
    severity: INFO
    languages:
      - python
    focus-metavariable: $DATA
    paths:
      include:
        - "**/*.py"
        - "**/*.pyi"
      exclude:
        - "**/__pycache__/**"
        - "**/*.pyc"
    patterns:
      - pattern-either:
          - pattern: hashlib.sha3_224($DATA)
          - pattern: hashlib.sha3_256($DATA)
          - pattern: hashlib.sha3_384($DATA)
          - pattern: hashlib.sha3_512($DATA)
          - pattern: hashlib.sha3_224()
          - pattern: hashlib.sha3_256()
          - pattern: hashlib.sha3_384()
          - pattern: hashlib.sha3_512()
          - pattern: hashlib.shake_128($DATA)
          - pattern: hashlib.shake_256($DATA)
          - pattern: hashlib.shake_128()
          - pattern: hashlib.shake_256()
          - pattern: |
              $HASHER = hashlib.sha3_256()
              $HASHER.update($DATA)
              $HASH = $HASHER.digest()
          - pattern: |
              $HASHER = hashlib.shake_128()
              $HASHER.update($DATA)
              $HASH = $HASHER.digest($LENGTH)
          - pattern: |
              $HASHER = hashlib.shake_256()
              $HASHER.update($DATA)
              $HASH = $HASHER.digest($LENGTH)
          - pattern: hashlib.sha3_256($DATA).hexdigest()
          - pattern: hashlib.sha3_512($DATA).hexdigest()
          - pattern: hashlib.shake_128($DATA).hexdigest($LENGTH)
          - pattern: hashlib.shake_256($DATA).hexdigest($LENGTH)
          - pattern: hashlib.shake_128($DATA).digest($LENGTH)
          - pattern: hashlib.shake_256($DATA).digest($LENGTH)
          - patterns:
              - pattern: hashlib.shake_128($DATA).digest($LENGTH)
              - metavariable-regex:
                  metavariable: $LENGTH
                  regex: \d+
          - patterns:
              - pattern: hashlib.shake_256($DATA).digest($LENGTH)
              - metavariable-regex:
                  metavariable: $LENGTH
                  regex: \d+
    pattern-not-inside:
      - pattern: |
          """
          $DOCSTRING
          """
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: SHA3 hash function usage detected in codebase"
  - id: python-crypto-cipher-twofish
    message: Twofish cipher usage detected
    severity: INFO
    languages:
      - python
    patterns:
      - pattern-either:
          - pattern: Twofish.new($KEY, $MODE)
          - pattern: Twofish.new($KEY, Twofish.MODE_ECB)
          - pattern: Twofish.new($KEY, Twofish.MODE_CBC, $IV)
          - pattern: Twofish.new($KEY, Twofish.MODE_CFB, $IV)
          - pattern: Twofish.new($KEY, Twofish.MODE_OFB, $IV)
          - pattern: Twofish.new($KEY, Twofish.MODE_CTR, $COUNTER)
          - pattern: |
              $CIPHER = Twofish.new($KEY, $MODE)
              $CIPHERTEXT = $CIPHER.encrypt($PLAINTEXT)
          - pattern: |
              $CIPHER = Twofish.new($KEY, $MODE)
              $PLAINTEXT = $CIPHER.decrypt($CIPHERTEXT)
          - pattern: |
              from Crypto.Cipher import Twofish
              $CIPHER = Twofish.new($KEY, $MODE)
              $CIPHERTEXT = $CIPHER.encrypt($PLAINTEXT)
          - pattern: |
              from Crypto.Cipher import Twofish
              $CIPHER = Twofish.new($KEY, $MODE)
              $PLAINTEXT = $CIPHER.decrypt($CIPHERTEXT)
    pattern-not-inside:
      - pattern: |
          """
          $DOCSTRING
          """
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: Twofish cipher usage detected in codebase"
  - id: python-crypto-sha256
    message: SHA256 hash function usage detected
    severity: INFO
    languages:
      - python
    focus-metavariable: $DATA
    paths:
      include:
        - "**/*.py"
        - "**/*.pyi"
      exclude:
        - "**/__pycache__/**"
        - "**/*.pyc"
    patterns:
      - pattern-either:
          - pattern: hashlib.sha256($DATA)
          - pattern: hashlib.sha256()
          - pattern: |
              $HASHER = hashlib.sha256()
              $HASHER.update($DATA)
              $HASH = $HASHER.digest()
          - pattern: |
              $HASHER = hashlib.sha256()
              ...
              $HASH = $HASHER.hexdigest()
          - pattern: hashlib.sha256($DATA).hexdigest()
          - pattern: hashlib.sha256($DATA).digest()
          - pattern: hmac.new($KEY, $MSG, hashlib.sha256)
          - pattern: hmac.new($KEY, $MSG, digestmod=hashlib.sha256)
          - pattern: pbkdf2_hmac("sha256", $PASSWORD, $SALT, $ITER)
          - patterns:
              - pattern: pbkdf2_hmac("sha256", $PASSWORD, $SALT, $ITER)
              - metavariable-comparison:
                  metavariable: $ITER
                  comparison: $ITER < 100000
    pattern-not-inside:
      - pattern: |
          """
          $DOCSTRING
          """
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: SHA256 hash function usage detected in codebase"
  - id: python-crypto-cipher-des
    message: DES cipher usage detected
    severity: INFO
    languages:
      - python
    focus-metavariable: $KEY
    paths:
      include:
        - "**/*.py"
        - "**/*.pyi"
      exclude:
        - "**/__pycache__/**"
        - "**/*.pyc"
    patterns:
      - pattern-either:
          - pattern: DES.new($KEY, $MODE)
          - pattern: DES3.new($KEY, $MODE)
          - pattern: |
              $CIPHER = DES.new($KEY, $MODE)
              $CIPHERTEXT = $CIPHER.encrypt($PLAINTEXT)
          - pattern: |
              $CIPHER = DES3.new($KEY, $MODE)
              $PLAINTEXT = $CIPHER.decrypt($CIPHERTEXT)
          - pattern: cryptography.hazmat.primitives.ciphers.algorithms.TripleDES($KEY)
    pattern-not-inside:
      - pattern: |
          """
          $DOCSTRING
          """
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: DES cipher usage detected in codebase"
  - id: python-crypto-md5
    message: MD5 hash function usage detected
    severity: INFO
    languages:
      - python
    focus-metavariable: $DATA
    paths:
      include:
        - "**/*.py"
        - "**/*.pyi"
      exclude:
        - "**/__pycache__/**"
        - "**/*.pyc"
    patterns:
      - pattern-either:
          - pattern: hashlib.md5($DATA)
          - pattern: hashlib.md5()
          - pattern: |
              $HASHER = hashlib.md5()
              $HASHER.update($DATA)
              $HASH = $HASHER.digest()
          - pattern: |
              $HASHER = hashlib.md5()
              ...
              $HASH = $HASHER.hexdigest()
          - pattern: hashlib.md5($DATA).hexdigest()
          - pattern: hashlib.md5($DATA).digest()
          - pattern: hmac.new($KEY, $MSG, hashlib.md5)
          - pattern: hmac.new($KEY, $MSG, digestmod=hashlib.md5)
          - pattern: hashlib.pbkdf2_hmac("md5", $PASSWORD, $SALT, $ITER)
          - pattern: hashlib.pbkdf2_hmac("md5", $PASSWORD, $SALT, $ITER, dklen=$KEYLEN)
          - patterns:
              - pattern: hashlib.pbkdf2_hmac("md5", $PASSWORD, $SALT, $ITER)
              - metavariable-comparison:
                  metavariable: $ITER
                  comparison: $ITER < 100000
    pattern-not-inside:
      - pattern: |
          """
          $DOCSTRING
          """
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: MD5 hash function usage detected in codebase"
  - id: python-crypto-fernet
    message: Fernet symmetric encryption usage detected
    severity: INFO
    languages:
      - python
    focus-metavariable: $KEY
    paths:
      include:
        - "**/*.py"
        - "**/*.pyi"
      exclude:
        - "**/__pycache__/**"
        - "**/*.pyc"
    patterns:
      - pattern-either:
          - pattern: Fernet($KEY)
          - pattern: |
              $FERNET = Fernet($KEY)
              $TOKEN = $FERNET.encrypt($DATA)
          - pattern: |
              $FERNET = Fernet($KEY)
              $DATA = $FERNET.decrypt($TOKEN)
          - pattern: |
              from cryptography.fernet import Fernet
              $FERNET = Fernet($KEY)
              $TOKEN = $FERNET.encrypt($DATA)
          - pattern: |
              from cryptography.fernet import Fernet
              $FERNET = Fernet($KEY)
              $DATA = $FERNET.decrypt($TOKEN)
          - pattern: |
              from cryptography.fernet import Fernet
              $KEY = Fernet.generate_key()
              $FERNET = Fernet($KEY)
          - pattern: |
              from cryptography.fernet import Fernet
              $FERNET = Fernet($KEY)
              ...
              $FERNET.encrypt($DATA)
          - pattern: |
              from cryptography.fernet import Fernet
              $FERNET = Fernet($KEY)
              ...
              $FERNET.decrypt($TOKEN)
          - pattern: |
              from cryptography.fernet import MultiFernet
              $FERNET = MultiFernet([$FERNET1, $FERNET2])
              $TOKEN = $FERNET.encrypt($DATA)
          - pattern: |
              from cryptography.fernet import MultiFernet
              $FERNET = MultiFernet([$FERNET1, $FERNET2])
              $DATA = $FERNET.decrypt($TOKEN)
    pattern-not-inside:
      - pattern: |
          """
          $DOCSTRING
          """
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: Fernet symmetric encryption usage detected in codebase"
  - id: python-crypto-iv-nonce
    message: IV or nonce generation and usage detected
    severity: INFO
    languages:
      - python
    focus-metavariable: $IV
    paths:
      include:
        - "**/*.py"
        - "**/*.pyi"
      exclude:
        - "**/__pycache__/**"
        - "**/*.pyc"
    patterns:
      - pattern-either:
          - pattern: os.urandom($LENGTH)
          - pattern: secrets.token_bytes($LENGTH)
          - patterns:
              - pattern: os.urandom($LENGTH)
              - metavariable-regex:
                  metavariable: $LENGTH
                  regex: (8|12|16|24|32|64)
          - patterns:
              - pattern-inside: |
                  $IV = os.urandom($LENGTH)
                  ...
              - metavariable-pattern:
                  metavariable: $IV
                  patterns:
                    - pattern: AES.new($KEY, AES.MODE_CBC, $IV)
                    - pattern: Cipher(algorithms.AES($KEY), modes.CBC($IV), $BACKEND)
          - patterns:
              - pattern-inside: |
                  $NONCE = os.urandom($LENGTH)
                  ...
              - metavariable-pattern:
                  metavariable: $NONCE
                  patterns:
                    - pattern: AES.new($KEY, AES.MODE_GCM, $NONCE)
                    - pattern: Cipher(algorithms.AES($KEY), modes.GCM($NONCE), $BACKEND)
          - pattern: |
              $IV = os.urandom($LENGTH)
              ...
              AES.new($KEY, AES.MODE_CBC, $IV)
          - pattern: |
              $NONCE = os.urandom($LENGTH)
              ...
              AES.new($KEY, AES.MODE_GCM, $NONCE)
          - pattern: |
              $IV = secrets.token_bytes($LENGTH)
              ...
              AES.new($KEY, AES.MODE_CBC, $IV)
          - pattern: |
              $NONCE = secrets.token_bytes($LENGTH)
              ...
              AES.new($KEY, AES.MODE_GCM, $NONCE)
          - pattern: |
              from cryptography.hazmat.primitives.ciphers import modes
              $IV = os.urandom(16)
              $MODE = modes.CBC($IV)
          - pattern: |
              from cryptography.hazmat.primitives.ciphers import modes
              $NONCE = os.urandom(12)
              $MODE = modes.GCM($NONCE)
          - pattern: |
              from Crypto.Cipher import AES
              $IV = os.urandom(16)
              $CIPHER = AES.new($KEY, AES.MODE_CBC, $IV)
          - pattern: |
              from Crypto.Cipher import AES
              $NONCE = os.urandom(12)
              $CIPHER = AES.new($KEY, AES.MODE_GCM, $NONCE)
          - pattern: |
              $IV = b"$STATIC_IV"
              ...
              AES.new($KEY, AES.MODE_CBC, $IV)
          - pattern: |
              $NONCE = b"$STATIC_NONCE"
              ...
              AES.new($KEY, AES.MODE_GCM, $NONCE)
          - pattern: |
              $IV = "$STATIC_IV"
              ...
              AES.new($KEY, AES.MODE_CBC, $IV.encode())
          - pattern: |
              $IV = [0x00] * $LENGTH
              ...
              AES.new($KEY, AES.MODE_CBC, bytes($IV))
          - pattern: |
              $IV = b"\x00" * $LENGTH
              ...
              AES.new($KEY, AES.MODE_CBC, $IV)
    pattern-not-inside:
      - pattern: |
          """
          $DOCSTRING
          """
    metadata:
      category: crypto
      cwe: CWE-330
      impact: "Inventory: IV or nonce generation and usage detected in codebase"
  - id: python-crypto-digital-signatures
    message: Digital signature operations detected
    severity: INFO
    languages:
      - python
    focus-metavariable: $PRIVATE_KEY
    paths:
      include:
        - "**/*.py"
        - "**/*.pyi"
      exclude:
        - "**/__pycache__/**"
        - "**/*.pyc"
    patterns:
      - pattern-either:
          - pattern: |
              $PRIVATE_KEY = rsa.generate_private_key($PUBLIC_EXPONENT, $KEY_SIZE, $BACKEND)
              ...
              $PRIVATE_KEY.sign($DATA, $PADDING, $ALGORITHM)
          - pattern: |
              $PUBLIC_KEY = $PRIVATE_KEY.public_key()
              ...
              $PUBLIC_KEY.verify($SIGNATURE, $DATA, $PADDING, $ALGORITHM)
          - pattern: |
              $PRIVATE_KEY = ec.generate_private_key($CURVE, $BACKEND)
              ...
              $PRIVATE_KEY.sign($DATA, $ALGORITHM)
          - pattern: |
              $PUBLIC_KEY = $PRIVATE_KEY.public_key()
              ...
              $PUBLIC_KEY.verify($SIGNATURE, $DATA, $ALGORITHM)
          - pattern: |
              from Crypto.Signature import pkcs1_15
              $SIGNER = pkcs1_15.new($PRIVATE_KEY)
              $SIGNATURE = $SIGNER.sign($HASH)
          - pattern: |
              from Crypto.Signature import pkcs1_15
              $VERIFIER = pkcs1_15.new($PUBLIC_KEY)
              $VERIFIER.verify($HASH, $SIGNATURE)
          - pattern: |
              from Crypto.Signature import DSS
              $SIGNER = DSS.new($PRIVATE_KEY, $MODE)
              $SIGNATURE = $SIGNER.sign($HASH)
          - pattern: |
              from Crypto.Signature import DSS
              $VERIFIER = DSS.new($PUBLIC_KEY, $MODE)
              $VERIFIER.verify($HASH, $SIGNATURE)
          - pattern: |
              from ecdsa import SigningKey
              $KEY = SigningKey.generate(curve=$CURVE)
              $SIGNATURE = $KEY.sign($DATA)
          - pattern: |
              from ecdsa import VerifyingKey
              $KEY = VerifyingKey.from_string($KEY_DATA, curve=$CURVE)
              $KEY.verify($SIGNATURE, $DATA)
          - pattern: |
              from cryptography.hazmat.primitives.asymmetric import padding
              $SIGNATURE = $PRIVATE_KEY.sign($DATA, padding.PKCS1v15(), $ALGORITHM)
          - pattern: |
              from cryptography.hazmat.primitives.asymmetric import padding
              $PUBLIC_KEY.verify($SIGNATURE, $DATA, padding.PKCS1v15(), $ALGORITHM)
          - pattern: |
              from cryptography.hazmat.primitives.asymmetric import padding
              $SIGNATURE = $PRIVATE_KEY.sign($DATA, padding.PSS($MGF, $SALT_LENGTH), $ALGORITHM)
          - pattern: |
              from cryptography.hazmat.primitives.asymmetric import padding
              $PUBLIC_KEY.verify($SIGNATURE, $DATA, padding.PSS($MGF, $SALT_LENGTH), $ALGORITHM)
          - pattern: |
              from cryptography.hazmat.primitives.asymmetric import ed25519
              $PRIVATE_KEY = ed25519.Ed25519PrivateKey.generate()
              $SIGNATURE = $PRIVATE_KEY.sign($DATA)
          - pattern: |
              from cryptography.hazmat.primitives.asymmetric import ed25519
              $PUBLIC_KEY = $PRIVATE_KEY.public_key()
              $PUBLIC_KEY.verify($SIGNATURE, $DATA)
          - pattern: |
              from cryptography.hazmat.primitives.asymmetric import ed448
              $PRIVATE_KEY = ed448.Ed448PrivateKey.generate()
              $SIGNATURE = $PRIVATE_KEY.sign($DATA)
          - pattern: |
              from cryptography.hazmat.primitives.asymmetric import ed448
              $PUBLIC_KEY = $PRIVATE_KEY.public_key()
              $PUBLIC_KEY.verify($SIGNATURE, $DATA)
    pattern-not-inside:
      - pattern: |
          """
          $DOCSTRING
          """
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: Digital signature operations detected in codebase"
  - id: python-crypto-cipher-salsa20
    message: Salsa20 cipher usage detected
    severity: INFO
    languages:
      - python
    patterns:
      - pattern-either:
          - pattern: Salsa20.new($KEY, $NONCE)
          - pattern: |
              $CIPHER = Salsa20.new($KEY, $NONCE)
              $CIPHERTEXT = $CIPHER.encrypt($PLAINTEXT)
          - pattern: |
              $CIPHER = Salsa20.new($KEY, $NONCE)
              $PLAINTEXT = $CIPHER.decrypt($CIPHERTEXT)
          - pattern: |
              from Crypto.Cipher import Salsa20
              $CIPHER = Salsa20.new($KEY, $NONCE)
              $CIPHERTEXT = $CIPHER.encrypt($PLAINTEXT)
          - pattern: |
              from Crypto.Cipher import Salsa20
              $CIPHER = Salsa20.new($KEY, $NONCE)
              $PLAINTEXT = $CIPHER.decrypt($CIPHERTEXT)
    pattern-not-inside:
      - pattern: |
          """
          $DOCSTRING
          """
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: Salsa20 cipher usage detected in codebase"
  - id: python-crypto-cipher-modes
    message: Cipher mode usage detected
    severity: INFO
    languages:
      - python
    focus-metavariable: $MODE
    paths:
      include:
        - "**/*.py"
        - "**/*.pyi"
      exclude:
        - "**/__pycache__/**"
        - "**/*.pyc"
    patterns:
      - pattern-either:
          - pattern: AES.MODE_ECB
          - pattern: AES.MODE_CBC
          - pattern: AES.MODE_CFB
          - pattern: AES.MODE_OFB
          - pattern: AES.MODE_CTR
          - pattern: AES.MODE_GCM
          - pattern: AES.MODE_CCM
          - pattern: AES.MODE_XTS
          - pattern: AES.new($KEY, AES.MODE_ECB)
          - pattern: AES.new($KEY, AES.MODE_CBC, $IV)
          - pattern: AES.new($KEY, AES.MODE_CFB, $IV)
          - pattern: AES.new($KEY, AES.MODE_OFB, $IV)
          - pattern: AES.new($KEY, AES.MODE_CTR, $COUNTER)
          - pattern: AES.new($KEY, AES.MODE_GCM, $NONCE)
          - pattern: AES.new($KEY, AES.MODE_CCM, $NONCE)
          - pattern: AES.new($KEY, AES.MODE_XTS, $TWEAK)
          - pattern: |
              from Crypto.Cipher import AES
              $CIPHER = AES.new($KEY, AES.MODE_ECB)
          - pattern: |
              from Crypto.Cipher import AES
              $CIPHER = AES.new($KEY, AES.MODE_CBC, $IV)
          - pattern: |
              from Crypto.Cipher import AES
              $CIPHER = AES.new($KEY, AES.MODE_GCM, $NONCE)
          - pattern: modes.ECB()
          - pattern: modes.CBC($IV)
          - pattern: modes.CFB($IV)
          - pattern: modes.OFB($IV)
          - pattern: modes.CTR($COUNTER)
          - pattern: modes.GCM($NONCE)
          - pattern: modes.CCM($NONCE, $TAG_LENGTH)
          - pattern: modes.XTS($TWEAK)
          - pattern: |
              from cryptography.hazmat.primitives.ciphers import modes
              $MODE = modes.ECB()
          - pattern: |
              from cryptography.hazmat.primitives.ciphers import modes
              $MODE = modes.CBC($IV)
          - pattern: |
              from cryptography.hazmat.primitives.ciphers import modes
              $MODE = modes.GCM($NONCE)
          - pattern: |
              from cryptography.hazmat.primitives.ciphers import Cipher, algorithms, modes
              $CIPHER = Cipher(algorithms.AES($KEY), modes.ECB(), $BACKEND)
          - pattern: |
              from cryptography.hazmat.primitives.ciphers import Cipher, algorithms, modes
              $CIPHER = Cipher(algorithms.AES($KEY), modes.CBC($IV), $BACKEND)
          - pattern: |
              from cryptography.hazmat.primitives.ciphers import Cipher, algorithms, modes
              $CIPHER = Cipher(algorithms.AES($KEY), modes.GCM($NONCE), $BACKEND)
    pattern-not-inside:
      - pattern: |
          """
          $DOCSTRING
          """
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: Cipher mode usage detected in codebase"
  - id: python-crypto-tls-cipher-suites
    message: TLS cipher suite configuration detected
    severity: INFO
    languages:
      - python
    focus-metavariable: $SUITE
    paths:
      include:
        - "**/*.py"
        - "**/*.pyi"
      exclude:
        - "**/__pycache__/**"
        - "**/*.pyc"
    patterns:
      - pattern-either:
          - pattern: |
              $CONTEXT = ssl.create_default_context()
              $CONTEXT.set_ciphers($CIPHER_STRING)
          - pattern: |
              $CONTEXT = ssl.SSLContext(ssl.PROTOCOL_TLSv1_2)
              $CONTEXT.set_ciphers($CIPHER_STRING)
          - pattern: |
              $CONTEXT = ssl.create_default_context()
              $CONTEXT.ciphers()
          - pattern: |
              $CONTEXT = ssl.SSLContext(ssl.PROTOCOL_TLSv1_2)
              $CONTEXT.ciphers()
          - pattern: |
              import ssl
              $CONTEXT = ssl.create_default_context()
              $CONTEXT.set_ciphers("$CIPHER_LIST")
          - pattern: |
              import ssl
              $CONTEXT = ssl.SSLContext(ssl.PROTOCOL_TLSv1_2)
              $CONTEXT.set_ciphers("$CIPHER_LIST")
          - pattern: |
              from urllib3.util.ssl_ import create_urllib3_context
              $CONTEXT = create_urllib3_context()
              $CONTEXT.set_ciphers($CIPHER_STRING)
          - pattern: |
              import requests
              $SESSION = requests.Session()
              $SESSION.mount("https://", $ADAPTER)
              ...
              $ADAPTER.init_poolmanager(ciphers=$CIPHER_STRING)
    pattern-not-inside:
      - pattern: |
          """
          $DOCSTRING
          """
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: TLS cipher suite configuration detected in codebase"
  - id: python-crypto-rsa
    message: RSA cryptographic operations detected
    severity: INFO
    languages:
      - python
    patterns:
      - pattern-either:
          - pattern: rsa.generate_private_key($PUBLIC_EXPONENT, $KEY_SIZE, $BACKEND)
          - pattern: rsa.generate_private_key($PUBLIC_EXPONENT, $KEY_SIZE)
          - pattern: |
              $PRIVATE_KEY = rsa.generate_private_key($PUBLIC_EXPONENT, $KEY_SIZE, $BACKEND)
              $PUBLIC_KEY = $PRIVATE_KEY.public_key()
          - pattern: rsa.RSAPrivateKey.generate($PUBLIC_EXPONENT, $KEY_SIZE, $BACKEND)
          - pattern: rsa.RSAPublicKey.from_encoded($DATA, $BACKEND)
          - pattern: |
              $PRIVATE_KEY = rsa.generate_private_key($PUBLIC_EXPONENT, $KEY_SIZE, $BACKEND)
              ...
              $PRIVATE_KEY.encrypt($PLAINTEXT, $PADDING)
          - pattern: |
              $PRIVATE_KEY = rsa.generate_private_key($PUBLIC_EXPONENT, $KEY_SIZE, $BACKEND)
              ...
              $PRIVATE_KEY.decrypt($CIPHERTEXT, $PADDING)
          - pattern: |
              $PUBLIC_KEY = $PRIVATE_KEY.public_key()
              ...
              $PUBLIC_KEY.encrypt($PLAINTEXT, $PADDING)
          - pattern: |
              $PRIVATE_KEY = rsa.generate_private_key($PUBLIC_EXPONENT, $KEY_SIZE, $BACKEND)
              ...
              $PRIVATE_KEY.sign($DATA, $PADDING, $ALGORITHM)
          - pattern: |
              $PUBLIC_KEY = $PRIVATE_KEY.public_key()
              ...
              $PUBLIC_KEY.verify($SIGNATURE, $DATA, $PADDING, $ALGORITHM)
          - pattern: serialization.load_pem_private_key($DATA, $PASSWORD, $BACKEND)
          - pattern: serialization.load_pem_public_key($DATA, $BACKEND)
          - pattern: serialization.load_der_private_key($DATA, $PASSWORD, $BACKEND)
          - pattern: serialization.load_der_public_key($DATA, $BACKEND)
          - pattern: serialization.load_ssh_private_key($DATA, $PASSWORD, $BACKEND)
          - pattern: serialization.load_ssh_public_key($DATA, $BACKEND)
          - pattern: serialization.load_pem_parameters($DATA, $BACKEND)
          - pattern: serialization.load_der_parameters($DATA, $BACKEND)
          - pattern: padding.PKCS1v15()
          - pattern: padding.OAEP($MGF, $ALGORITHM, $LABEL)
          - pattern: padding.PSS($MGF, $SALT_LENGTH)
          - pattern: padding.PKCS1v15()
          - pattern: |
              from Crypto.PublicKey import RSA
              $KEY = RSA.generate($BITS)
          - pattern: |
              from Crypto.PublicKey import RSA
              $KEY = RSA.importKey($KEY_DATA)
          - pattern: |
              from Crypto.Cipher import PKCS1_v1_5
              $CIPHER = PKCS1_v1_5.new($PUBLIC_KEY)
              $CIPHERTEXT = $CIPHER.encrypt($PLAINTEXT)
          - pattern: |
              from Crypto.Cipher import PKCS1_v1_5
              $CIPHER = PKCS1_v1_5.new($PRIVATE_KEY)
              $PLAINTEXT = $CIPHER.decrypt($CIPHERTEXT, $SENTINEL)
          - pattern: |
              from Crypto.Signature import pkcs1_15
              $SIGNER = pkcs1_15.new($PRIVATE_KEY)
              $SIGNATURE = $SIGNER.sign($HASH)
          - pattern: |
              from Crypto.Signature import pkcs1_15
              $VERIFIER = pkcs1_15.new($PUBLIC_KEY)
              $VERIFIER.verify($HASH, $SIGNATURE)
          - patterns:
              - pattern-inside: |
                  $PRIVATE_KEY = rsa.generate_private_key(...)
                  ...
              - metavariable-pattern:
                  metavariable: $PRIVATE_KEY
                  patterns:
                    - pattern: $PRIVATE_KEY.encrypt(...)
                    - pattern: $PRIVATE_KEY.decrypt(...)
                    - pattern: $PRIVATE_KEY.sign(...)
          - patterns:
              - pattern-inside: |
                  $PRIVATE_KEY = rsa.generate_private_key(...)
                  ...
              - metavariable-pattern:
                  metavariable: $PRIVATE_KEY
                  patterns:
                    - pattern: $PUBLIC_KEY = $PRIVATE_KEY.public_key()
                    - pattern-either:
                        - pattern: $PUBLIC_KEY.encrypt(...)
                        - pattern: $PUBLIC_KEY.verify(...)
    pattern-not-inside:
      - pattern: |
          """
          $DOCSTRING
          """
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: RSA cryptographic operations detected in codebase"
  - id: python-crypto-hmac
    message: HMAC usage detected
    severity: INFO
    languages:
      - python
    focus-metavariable: $KEY
    paths:
      include:
        - "**/*.py"
        - "**/*.pyi"
      exclude:
        - "**/__pycache__/**"
        - "**/*.pyc"
    patterns:
      - pattern-either:
          - pattern: hmac.new($KEY, $MSG, $DIGEST)
          - pattern: hmac.new($KEY, $MSG, digestmod=$DIGEST)
          - pattern: |
              $HMAC = hmac.new($KEY, $MSG, $DIGEST)
              $HMAC.update($DATA)
              $RESULT = $HMAC.digest()
          - pattern: |
              $HMAC = hmac.new($KEY, $MSG, digestmod=$DIGEST)
              ...
              $RESULT = $HMAC.hexdigest()
          - pattern: hmac.new($KEY, $MSG, hashlib.md5)
          - pattern: hmac.new($KEY, $MSG, hashlib.sha1)
          - pattern: hmac.new($KEY, $MSG, hashlib.sha256)
          - pattern: hmac.new($KEY, $MSG, hashlib.sha512)
          - pattern: hmac.new($KEY, $MSG, hashlib.sha3_256)
          - pattern: hmac.new($KEY, $MSG, hashlib.sha3_512)
          - pattern: hmac.new($KEY, $MSG, hashlib.blake2b)
          - pattern: hmac.new($KEY, $MSG, digestmod=hashlib.md5)
          - pattern: hmac.new($KEY, $MSG, digestmod=hashlib.sha1)
          - pattern: hmac.new($KEY, $MSG, digestmod=hashlib.sha256)
          - pattern: hmac.new($KEY, $MSG, digestmod=hashlib.sha512)
          - pattern: hmac.new($KEY, $MSG, digestmod=hashlib.sha3_256)
          - pattern: hmac.new($KEY, $MSG, digestmod=hashlib.sha3_512)
          - pattern: hmac.new($KEY, $MSG, digestmod=hashlib.blake2b)
          - pattern: |
              $HMAC = hmac.new($KEY, $MSG, $DIGEST)
              ...
              hmac.compare_digest($HMAC.digest(), $EXPECTED)
          - pattern: |
              $HMAC = hmac.new($KEY, $MSG, digestmod=$DIGEST)
              ...
              base64.b64encode($HMAC.digest())
          - pattern: |
              $HMAC = hmac.new($KEY, $MSG, digestmod=$DIGEST)
              ...
              $HMAC.hexdigest()
          - pattern: hmac.digest($KEY, $MSG, $DIGEST)
          - pattern: hmac.digest($KEY, $MSG, digest=$DIGEST)
          - pattern: hmac.compare_digest($DIGEST1, $DIGEST2)
          - patterns:
              - pattern: hmac.new($KEY, $MSG, digestmod="$ALG")
              - metavariable-regex:
                  metavariable: $ALG
                  regex: (md5|sha1|sha224|sha256|sha384|sha512|sha3_224|sha3_256|sha3_384|sha3_512|blake2b|blake2s)
          - pattern: |
              $HMAC = hmac.new($KEY, $MSG, digestmod=$DIGEST)
              ...
              hmac.compare_digest($HMAC.digest(), $EXPECTED)
          - patterns:
              - pattern-inside: |
                  $KEY = secrets.token_bytes($LENGTH)
                  ...
              - metavariable-pattern:
                  metavariable: $KEY
                  patterns:
                    - pattern: hmac.new($KEY, $MSG, $DIGEST)
                    - pattern: hmac.new($KEY, $MSG, digestmod=$DIGEST)
    pattern-not-inside:
      - pattern: |
          """
          $DOCSTRING
          """
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: HMAC usage detected in codebase"
  - id: python-crypto-cipher-rc4
    message: RC4 cipher usage detected
    severity: INFO
    languages:
      - python
    patterns:
      - pattern-either:
          - pattern: ARC4.new($KEY)
          - pattern: |
              $CIPHER = ARC4.new($KEY)
              $CIPHERTEXT = $CIPHER.encrypt($PLAINTEXT)
          - pattern: |
              $CIPHER = ARC4.new($KEY)
              $PLAINTEXT = $CIPHER.decrypt($CIPHERTEXT)
          - pattern: |
              from Crypto.Cipher import ARC4
              $CIPHER = ARC4.new($KEY)
              $CIPHERTEXT = $CIPHER.encrypt($PLAINTEXT)
          - pattern: |
              from Crypto.Cipher import ARC4
              $CIPHER = ARC4.new($KEY)
              $PLAINTEXT = $CIPHER.decrypt($CIPHERTEXT)
          - pattern: |
              from Crypto.Cipher import ARC4
              $CIPHER = ARC4.new($KEY)
              ...
              $CIPHER.encrypt($PLAINTEXT)
          - pattern: |
              from Crypto.Cipher import ARC4
              $CIPHER = ARC4.new($KEY)
              ...
              $CIPHER.decrypt($CIPHERTEXT)
    pattern-not-inside:
      - pattern: |
          """
          $DOCSTRING
          """
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: RC4 cipher usage detected in codebase"
  - id: python-crypto-cipher-blowfish
    message: Blowfish cipher usage detected
    severity: INFO
    languages:
      - python
    patterns:
      - pattern-either:
          - pattern: Blowfish.new($KEY, $MODE)
          - pattern: Blowfish.new($KEY, Blowfish.MODE_ECB)
          - pattern: Blowfish.new($KEY, Blowfish.MODE_CBC, $IV)
          - pattern: Blowfish.new($KEY, Blowfish.MODE_CFB, $IV)
          - pattern: Blowfish.new($KEY, Blowfish.MODE_OFB, $IV)
          - pattern: Blowfish.new($KEY, Blowfish.MODE_CTR, $COUNTER)
          - pattern: |
              $CIPHER = Blowfish.new($KEY, $MODE)
              $CIPHERTEXT = $CIPHER.encrypt($PLAINTEXT)
          - pattern: |
              $CIPHER = Blowfish.new($KEY, $MODE)
              $PLAINTEXT = $CIPHER.decrypt($CIPHERTEXT)
          - pattern: |
              from Crypto.Cipher import Blowfish
              $CIPHER = Blowfish.new($KEY, $MODE)
              $CIPHERTEXT = $CIPHER.encrypt($PLAINTEXT)
          - pattern: |
              from Crypto.Cipher import Blowfish
              $CIPHER = Blowfish.new($KEY, $MODE)
              $PLAINTEXT = $CIPHER.decrypt($CIPHERTEXT)
          - pattern: cryptography.hazmat.primitives.ciphers.algorithms.Blowfish($KEY)
          - pattern: Cipher(algorithms.Blowfish($KEY), $MODE)
          - pattern: |
              from cryptography.hazmat.primitives.ciphers import Cipher, algorithms, modes
              $CIPHER = Cipher(algorithms.Blowfish($KEY), $MODE, $BACKEND)
    pattern-not-inside:
      - pattern: |
          """
          $DOCSTRING
          """
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: Blowfish cipher usage detected in codebase"
  - id: python-crypto-cipher-chacha20
    message: ChaCha20 cipher usage detected
    severity: INFO
    languages:
      - python
    patterns:
      - pattern-either:
          - pattern: ChaCha20.new($KEY, $NONCE)
          - pattern: |
              $CIPHER = ChaCha20.new($KEY, $NONCE)
              $CIPHERTEXT = $CIPHER.encrypt($PLAINTEXT)
          - pattern: |
              $CIPHER = ChaCha20.new($KEY, $NONCE)
              $PLAINTEXT = $CIPHER.decrypt($CIPHERTEXT)
          - pattern: |
              from Crypto.Cipher import ChaCha20
              $CIPHER = ChaCha20.new($KEY, $NONCE)
              $CIPHERTEXT = $CIPHER.encrypt($PLAINTEXT)
          - pattern: |
              from Crypto.Cipher import ChaCha20
              $CIPHER = ChaCha20.new($KEY, $NONCE)
              $PLAINTEXT = $CIPHER.decrypt($CIPHERTEXT)
          - pattern: |
              from Crypto.Cipher import ChaCha20_Poly1305
              $CIPHER = ChaCha20_Poly1305.new($KEY, $NONCE)
              $CIPHERTEXT = $CIPHER.encrypt_and_digest($PLAINTEXT)
          - pattern: |
              from Crypto.Cipher import ChaCha20_Poly1305
              $CIPHER = ChaCha20_Poly1305.new($KEY, $NONCE)
              $PLAINTEXT = $CIPHER.decrypt_and_verify($CIPHERTEXT, $TAG)
          - pattern: cryptography.hazmat.primitives.ciphers.algorithms.ChaCha20($KEY)
          - pattern: Cipher(algorithms.ChaCha20($KEY), $MODE)
          - pattern: |
              from cryptography.hazmat.primitives.ciphers import Cipher, algorithms, modes
              $CIPHER = Cipher(algorithms.ChaCha20($KEY), modes.ChaCha20Poly1305($NONCE), $BACKEND)
          - pattern: |
              from cryptography.hazmat.primitives.ciphers.aead import ChaCha20Poly1305
              $CIPHER = ChaCha20Poly1305($KEY)
              $CIPHERTEXT = $CIPHER.encrypt($NONCE, $PLAINTEXT, $ASSOCIATED_DATA)
          - pattern: |
              from cryptography.hazmat.primitives.ciphers.aead import ChaCha20Poly1305
              $CIPHER = ChaCha20Poly1305($KEY)
              $PLAINTEXT = $CIPHER.decrypt($NONCE, $CIPHERTEXT, $ASSOCIATED_DATA)
    pattern-not-inside:
      - pattern: |
          """
          $DOCSTRING
          """
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: ChaCha20 cipher usage detected in codebase"
  - id: python-crypto-sha512
    message: SHA512 hash function usage detected
    severity: INFO
    languages:
      - python
    focus-metavariable: $DATA
    paths:
      include:
        - "**/*.py"
        - "**/*.pyi"
      exclude:
        - "**/__pycache__/**"
        - "**/*.pyc"
    patterns:
      - pattern-either:
          - pattern: hashlib.sha512($DATA)
          - pattern: hashlib.sha512()
          - pattern: |
              $HASHER = hashlib.sha512()
              $HASHER.update($DATA)
              $HASH = $HASHER.digest()
          - pattern: |
              $HASHER = hashlib.sha512()
              ...
              $HASH = $HASHER.hexdigest()
          - pattern: hashlib.sha512($DATA).hexdigest()
          - pattern: hashlib.sha512($DATA).digest()
          - pattern: hmac.new($KEY, $MSG, hashlib.sha512)
          - pattern: hmac.new($KEY, $MSG, digestmod=hashlib.sha512)
          - pattern: pbkdf2_hmac("sha512", $PASSWORD, $SALT, $ITER)
    pattern-not-inside:
      - pattern: |
          """
          $DOCSTRING
          """
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: SHA512 hash function usage detected in codebase"
  - id: python-crypto-certificate-validation
    message: SSL/TLS certificate validation configuration detected
    severity: INFO
    languages:
      - python
    focus-metavariable: $CONTEXT
    paths:
      include:
        - "**/*.py"
        - "**/*.pyi"
      exclude:
        - "**/__pycache__/**"
        - "**/*.pyc"
    patterns:
      - pattern-either:
          - pattern: |
              $CONTEXT = ssl.create_default_context()
              $CONTEXT.check_hostname = False
          - pattern: |
              $CONTEXT = ssl.SSLContext(ssl.PROTOCOL_TLSv1_2)
              $CONTEXT.check_hostname = False
          - pattern: |
              $CONTEXT = ssl.create_default_context()
              $CONTEXT.verify_mode = ssl.CERT_NONE
          - pattern: |
              $CONTEXT = ssl.SSLContext(ssl.PROTOCOL_TLSv1_2)
              $CONTEXT.verify_mode = ssl.CERT_NONE
          - pattern: |
              $CONTEXT = ssl.create_default_context()
              $CONTEXT.verify_mode = ssl.CERT_OPTIONAL
          - pattern: |
              $CONTEXT = ssl.SSLContext(ssl.PROTOCOL_TLSv1_2)
              $CONTEXT.verify_mode = ssl.CERT_OPTIONAL
          - pattern: |
              $CONTEXT = ssl.create_default_context()
              $CONTEXT.verify_mode = ssl.CERT_REQUIRED
          - pattern: |
              $CONTEXT = ssl.SSLContext(ssl.PROTOCOL_TLSv1_2)
              $CONTEXT.verify_mode = ssl.CERT_REQUIRED
          - pattern: |
              import ssl
              $CONTEXT = ssl._create_unverified_context()
          - pattern: |
              import ssl
              $CONTEXT = ssl.create_default_context()
              $CONTEXT.load_verify_locations($CAFILE)
          - pattern: |
              import ssl
              $CONTEXT = ssl.create_default_context()
              $CONTEXT.load_cert_chain($CERTFILE, $KEYFILE)
          - pattern: |
              import requests
              requests.get($URL, verify=False)
          - pattern: |
              import requests
              requests.post($URL, verify=False, data=$DATA)
          - pattern: |
              import urllib3
              urllib3.disable_warnings(urllib3.exceptions.InsecureRequestWarning)
              ...
              requests.get($URL, verify=False)
    pattern-not-inside:
      - pattern: |
          """
          $DOCSTRING
          """
    metadata:
      category: crypto
      cwe: CWE-295
      impact: "Inventory: SSL/TLS certificate validation configuration detected in codebase"
  - id: python-crypto-password-hashing
    message: Password hashing operations detected
    severity: INFO
    languages:
      - python
    focus-metavariable: $PASSWORD
    paths:
      include:
        - "**/*.py"
        - "**/*.pyi"
      exclude:
        - "**/__pycache__/**"
        - "**/*.pyc"
    patterns:
      - pattern-either:
          - pattern: bcrypt.hashpw($PASSWORD, $SALT)
          - pattern: bcrypt.checkpw($PASSWORD, $HASH)
          - pattern: bcrypt.gensalt($ROUNDS)
          - patterns:
              - pattern: bcrypt.gensalt($ROUNDS)
              - metavariable-comparison:
                  metavariable: $ROUNDS
                  comparison: $ROUNDS < 10
          - pattern: argon2.hash_password($PASSWORD, $SALT)
          - pattern: argon2.verify_password($HASH, $PASSWORD)
          - pattern: scrypt.hash($PASSWORD, $SALT, $N, $R, $P)
          - pattern: scrypt.verify($HASH, $PASSWORD)
          - pattern: hashlib.pbkdf2_hmac("sha256", $PASSWORD, $SALT, $ITER)
          - pattern: |
              $HASH = bcrypt.hashpw($PASSWORD, bcrypt.gensalt())
              ...
              bcrypt.checkpw($INPUT, $HASH)
          - pattern: passlib.hash.bcrypt.hash($PASSWORD)
          - pattern: passlib.hash.bcrypt.verify($PASSWORD, $HASH)
          - pattern: passlib.hash.argon2.hash($PASSWORD)
          - pattern: passlib.hash.argon2.verify($PASSWORD, $HASH)
          - pattern: passlib.hash.sha256_crypt.hash($PASSWORD)
          - pattern: passlib.hash.sha256_crypt.verify($PASSWORD, $HASH)
          - pattern: passlib.hash.pbkdf2_sha256.hash($PASSWORD)
          - pattern: passlib.hash.pbkdf2_sha256.verify($PASSWORD, $HASH)
          - pattern: passlib.hash.pbkdf2_sha512.hash($PASSWORD)
          - pattern: passlib.hash.pbkdf2_sha512.verify($PASSWORD, $HASH)
          - pattern: |
              from passlib.hash import bcrypt
              $HASH = bcrypt.hash($PASSWORD)
          - pattern: |
              from passlib.hash import bcrypt
              bcrypt.verify($PASSWORD, $HASH)
          - pattern: |
              from passlib.hash import argon2
              $HASH = argon2.hash($PASSWORD)
          - pattern: |
              from passlib.hash import argon2
              argon2.verify($PASSWORD, $HASH)
    pattern-not-inside:
      - pattern: |
          """
          $DOCSTRING
          """
    metadata:
      category: crypto
      cwe: CWE-326
      impact: "Inventory: Password hashing operations detected in codebase"
  - id: python-crypto-hardcoded-key
    message: Hardcoded cryptographic key detected
    severity: INFO
    languages:
      - python
    paths:
      include:
        - "**/*.py"
        - "**/*.pyi"
      exclude:
        - "**/__pycache__/**"
        - "**/*.pyc"
    mode: taint
    pattern-sources:
      - pattern: $KEY = "$VALUE"
      - pattern: $KEY = '$VALUE'
      - pattern: $KEY = b"$VALUE"
      - pattern: $KEY = b'$VALUE'
      - pattern: KEY = "$VALUE"
      - pattern: KEY = '$VALUE'
      - pattern: KEY = b"$VALUE"
      - pattern: KEY = b'$VALUE'
      - pattern: '"$VALUE"'
      - pattern: "'$VALUE'"
      - pattern: b"$VALUE"
      - pattern: b'$VALUE'
      - pattern: |
          $KEY = os.getenv("$ENV_VAR", "$DEFAULT_KEY")
      - pattern: |
          $KEY = os.getenv("$ENV_VAR") or "$DEFAULT_KEY"
      - pattern: |
          $KEY = os.getenv("$ENV_VAR")
          if not $KEY:
              $KEY = "$DEFAULT_KEY"
      - pattern: |
          $KEY = os.environ.get("$ENV_VAR", "$DEFAULT_KEY")
      - pattern: |
          $CONFIG = {"key": "$VALUE"}
      - pattern: |
          $CONFIG = {"key": b"$VALUE"}
      - pattern: |
          class $CONFIG:
              $FIELD = "$VALUE"
      - pattern: |
          class $CONFIG:
              $FIELD = b"$VALUE"
    pattern-sinks:
      - pattern: AES.new($KEY, $MODE)
      - pattern: DES.new($KEY, $MODE)
      - pattern: DES3.new($KEY, $MODE)
      - pattern: TripleDES.new($KEY, $MODE)
      - pattern: ARC4.new($KEY)
      - pattern: Blowfish.new($KEY, $MODE)
      - pattern: Twofish.new($KEY, $MODE)
      - pattern: Camellia.new($KEY, $MODE)
      - pattern: ChaCha20.new($KEY, $NONCE)
      - pattern: Salsa20.new($KEY, $NONCE)
      - pattern: Fernet($KEY)
      - pattern: MultiFernet([$KEY, ...])
      - pattern: Cipher(algorithms.AES($KEY), $MODE, $BACKEND)
      - pattern: Cipher(algorithms.DES($KEY), $MODE, $BACKEND)
      - pattern: Cipher(algorithms.TripleDES($KEY), $MODE, $BACKEND)
      - pattern: Cipher(algorithms.Blowfish($KEY), $MODE, $BACKEND)
      - pattern: Cipher(algorithms.Camellia($KEY), $MODE, $BACKEND)
      - pattern: Cipher(algorithms.ChaCha20($KEY), $MODE, $BACKEND)
      - pattern: rsa.generate_private_key($PUBLIC_EXPONENT, $KEY, $BACKEND)
      - pattern: ec.generate_private_key($CURVE, $BACKEND)
      - pattern: hmac.new($KEY, $MSG, $DIGEST)
      - pattern: hmac.new($KEY, $MSG, digestmod=$DIGEST)
    pattern-not-inside:
      - pattern: |
          """
          $DOCSTRING
          """
    metadata:
      category: crypto
      cwe: CWE-798
      impact: "Inventory: Hardcoded cryptographic key detected in codebase"
  - id: python-crypto-pycryptodome
    message: PyCryptodome library usage detected
    severity: INFO
    languages:
      - python
    patterns:
      - pattern-either:
          - pattern: |
              from Crypto.Cipher import $CIPHER
          - pattern: |
              from Crypto.PublicKey import $KEY_TYPE
          - pattern: |
              from Crypto.Hash import $HASH_TYPE
          - pattern: |
              from Crypto.Signature import $SIGNATURE_TYPE
          - pattern: |
              from Crypto.Random import $RANDOM_TYPE
          - pattern: |
              from Crypto.Protocol import $PROTOCOL_TYPE
          - pattern: |
              from Crypto.Util import $UTIL_TYPE
          - pattern: |
              from Crypto.Cipher import AES, DES, DES3, ARC4, ChaCha20, Salsa20
          - pattern: |
              from Crypto.PublicKey import RSA, DSA, ECC
          - pattern: |
              from Crypto.Hash import MD5, SHA1, SHA256, SHA512, SHA3_256, SHA3_512, BLAKE2b
          - pattern: |
              from Crypto.Signature import pkcs1_15, DSS, eddsa
          - pattern: |
              from Crypto.Random import get_random_bytes
          - pattern: |
              from Crypto.Protocol.KDF import PBKDF2, HKDF, scrypt
          - pattern: |
              from Crypto.Util.Padding import pad, unpad
          - pattern: |
              import Crypto.Cipher
          - pattern: |
              import Crypto.PublicKey
          - pattern: |
              import Crypto.Hash
          - pattern: |
              import Crypto.Signature
    pattern-not-inside:
      - pattern: |
          """
          $DOCSTRING
          """
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: PyCryptodome library usage detected in codebase"
  - id: go-crypto-password-hashing
    message: Password hashing operations detected
    severity: INFO
    languages:
      - go
    patterns:
      - pattern-either:
          - pattern: bcrypt.GenerateFromPassword($PASSWORD, $COST)
          - pattern: bcrypt.CompareHashAndPassword($HASH, $PASSWORD)
          - pattern: pbkdf2.Key($PASSWORD, $SALT, $ITER, $KEYLEN, $HASH)
          - pattern: scrypt.Key($PASSWORD, $SALT, $N, $R, $P, $KEYLEN)
          - pattern: argon2.Key($PASSWORD, $SALT, $TIME, $MEMORY, $THREADS, $KEYLEN)
          - pattern: argon2.IDKey($PASSWORD, $SALT, $TIME, $MEMORY, $THREADS, $KEYLEN)
          - pattern: |
              $HASH, $ERR := bcrypt.GenerateFromPassword($PASSWORD, $COST)
              ...
              bcrypt.CompareHashAndPassword($HASH, $INPUT)
    metadata:
      category: crypto
      cwe: CWE-326
      impact: "Inventory: Password hashing operations detected in codebase"
  - id: go-crypto-iv-reuse
    message: Initialization vector (IV) usage detected
    severity: INFO
    languages:
      - go
    patterns:
      - pattern-either:
          - pattern: |
              $IV := []byte("$STATIC_VALUE")
              ...
              cipher.NewCBCEncrypter($BLOCK, $IV)
          - pattern: |
              $IV := make([]byte, $SIZE)
              ...
              cipher.NewCBCEncrypter($BLOCK, $IV)
          - pattern: |
              var $IV = []byte("$STATIC_VALUE")
              ...
              cipher.NewGCM($BLOCK).Seal($DST, $IV, $PLAINTEXT, $DATA)
          - pattern: cipher.NewCBCEncrypter($BLOCK, []byte("$STATIC_IV"))
          - pattern: cipher.NewCBCDecrypter($BLOCK, []byte("$STATIC_IV"))
    metadata:
      category: crypto
      cwe: CWE-329
      impact: "Inventory: Initialization vector (IV) usage detected in codebase"
  - id: go-crypto-nonce-gcm
    message: Nonce usage in GCM mode detected
    severity: INFO
    languages:
      - go
    patterns:
      - pattern-either:
          - pattern: |
              $NONCE := []byte("$STATIC_VALUE")
              ...
              $GCM.Seal($DST, $NONCE, $PLAINTEXT, $DATA)
          - pattern: |
              $NONCE := make([]byte, $SIZE)
              ...
              $GCM.Seal($DST, $NONCE, $PLAINTEXT, $DATA)
          - pattern: $GCM.Seal($DST, []byte("$STATIC_NONCE"), $PLAINTEXT, $DATA)
          - pattern: |
              for $I := 0; $I < $N; $I++ {
                ...
                $GCM.Seal($DST, $NONCE, $PLAINTEXT, $DATA)
              }
    metadata:
      category: crypto
      cwe: CWE-329
      impact: "Inventory: Nonce usage in GCM mode detected in codebase"
  - id: go-crypto-tls-cipher-suites
    message: TLS cipher suite configuration detected
    severity: INFO
    languages:
      - go
    patterns:
      - pattern-either:
          - pattern: tls.CipherSuites()
          - pattern: tls.InsecureCipherSuites()
          - pattern: |
              &tls.Config{CipherSuites: $SUITES}
          - pattern: |
              $CONFIG := &tls.Config{
                CipherSuites: $SUITES,
                ...
              }
          - pattern: tls.TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384
          - pattern: tls.TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305
          - pattern: tls.TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384
          - pattern: tls.TLS_AES_256_GCM_SHA384
          - pattern: tls.TLS_AES_128_GCM_SHA256
          - pattern: tls.TLS_CHACHA20_POLY1305_SHA256
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: TLS cipher suite configuration detected in codebase"
  - id: go-crypto-hmac
    message: HMAC usage detected
    severity: INFO
    languages:
      - go
    patterns:
      - pattern-either:
          - pattern: hmac.New($HASH, $KEY)
          - pattern: |
              $HMAC := hmac.New($HASH, $KEY)
              ...
              $HMAC.Write($DATA)
              ...
              $RESULT := $HMAC.Sum($SUFFIX)
          - pattern: |
              $HMAC := hmac.New($HASH, $KEY)
              ...
              $HMAC.Write($DATA)
              ...
              $RESULT := $HMAC.Sum(nil)
          - pattern: hmac.New(md5.New, $KEY)
          - pattern: hmac.New(sha1.New, $KEY)
          - pattern: hmac.New(sha256.New, $KEY)
          - pattern: hmac.New(sha512.New, $KEY)
          - pattern: hmac.New(sha512.New384, $KEY)
          - pattern: hmac.New(crypto.MD5.New, $KEY)
          - pattern: hmac.New(crypto.SHA1.New, $KEY)
          - pattern: hmac.New(crypto.SHA256.New, $KEY)
          - pattern: hmac.New(crypto.SHA512.New, $KEY)
          - pattern: hmac.New(crypto.SHA384.New, $KEY)
          - pattern: hmac.New(crypto.SHA3_224.New, $KEY)
          - pattern: hmac.New(crypto.SHA3_256.New, $KEY)
          - pattern: hmac.New(crypto.SHA3_384.New, $KEY)
          - pattern: hmac.New(crypto.SHA3_512.New, $KEY)
          - pattern: |
              $HASH := crypto.MD5
              $HMAC := hmac.New($HASH.New, $KEY)
          - pattern: |
              $HASH := crypto.SHA256
              $HMAC := hmac.New($HASH.New, $KEY)
          - pattern: |
              $HASH := crypto.SHA512
              $HMAC := hmac.New($HASH.New, $KEY)
          - pattern: |
              $HMAC := hmac.New($HASH.New, $KEY)
              ...
              hex.EncodeToString($HMAC.Sum(nil))
          - pattern: |
              $HMAC := hmac.New($HASH.New, $KEY)
              ...
              base64.StdEncoding.EncodeToString($HMAC.Sum(nil))
          - pattern: |
              $HMAC := hmac.New($HASH.New, $KEY)
              ...
              hmac.Equal($HMAC.Sum(nil), $EXPECTED)
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: HMAC usage detected in codebase"
  - id: go-crypto-chacha20
    message: ChaCha20 cipher usage detected
    severity: INFO
    languages:
      - go
    patterns:
      - pattern-either:
          - pattern: chacha20.NewUnauthenticatedCipher($KEY, $NONCE)
          - pattern: chacha20poly1305.New($KEY)
          - pattern: |
              $CIPHER, $ERR := chacha20.NewUnauthenticatedCipher($KEY, $NONCE)
              $CIPHER.XORKeyStream($DST, $SRC)
          - pattern: |
              $AEAD, $ERR := chacha20poly1305.New($KEY)
              $AEAD.Seal($DST, $NONCE, $PLAINTEXT, $DATA)
          - pattern: |
              $AEAD, $ERR := chacha20poly1305.New($KEY)
              $AEAD.Open($DST, $NONCE, $CIPHERTEXT, $DATA)
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: ChaCha20 cipher usage detected in codebase"
  - id: go-crypto-tls-version
    message: TLS version configuration detected
    severity: INFO
    languages:
      - go
    patterns:
      - pattern-either:
          - patterns:
              - pattern: tls.$VERSION
              - metavariable-regex:
                  metavariable: $VERSION
                  regex: Version(SSL30|TLS10|TLS11|TLS12|TLS13)
          - patterns:
              - pattern: $CONFIG.MinVersion = tls.$VERSION
              - metavariable-regex:
                  metavariable: $VERSION
                  regex: Version(SSL30|TLS10|TLS11|TLS12|TLS13)
          - patterns:
              - pattern: $CONFIG.MaxVersion = tls.$VERSION
              - metavariable-regex:
                  metavariable: $VERSION
                  regex: Version(SSL30|TLS10|TLS11|TLS12|TLS13)
          - patterns:
              - pattern: |
                  $CONFIG := &tls.Config{
                    MinVersion: tls.$VERSION,
                    ...
                  }
              - metavariable-regex:
                  metavariable: $VERSION
                  regex: Version(SSL30|TLS10|TLS11|TLS12|TLS13)
          - patterns:
              - pattern: |
                  $CONFIG := &tls.Config{
                    MaxVersion: tls.$VERSION,
                    ...
                  }
              - metavariable-regex:
                  metavariable: $VERSION
                  regex: Version(SSL30|TLS10|TLS11|TLS12|TLS13)
          - patterns:
              - pattern: |
                  $CONFIG := &tls.Config{
                    MinVersion: tls.$MIN_VERSION,
                    MaxVersion: tls.$MAX_VERSION,
                    ...
                  }
              - metavariable-regex:
                  metavariable: $MIN_VERSION
                  regex: Version(SSL30|TLS10|TLS11|TLS12|TLS13)
              - metavariable-regex:
                  metavariable: $MAX_VERSION
                  regex: Version(SSL30|TLS10|TLS11|TLS12|TLS13)
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: TLS version configuration detected in codebase"
  - id: go-crypto-dynamic-cipher
    message: Dynamic cipher selection detected
    severity: INFO
    languages:
      - go
    patterns:
      - pattern-either:
          - pattern: |
              switch $ALGO {
              case "des":
                $CIPHER = des.NewCipher($KEY)
              ...
              }
          - pattern: |
              if $ALGO == "rc4" {
                $CIPHER = rc4.NewCipher($KEY)
              }
          - pattern: |
              if $ALGO == "des" {
                $CIPHER = des.NewCipher($KEY)
              }
          - pattern: |
              $CIPHERS := map[string]func([]byte) (cipher.Block, error){
                ...,
                "des": des.NewCipher,
                ...
              }
          - pattern: |
              $CIPHERS := map[string]func([]byte) (cipher.Stream, error){
                ...,
                "rc4": rc4.NewCipher,
                ...
              }
          - pattern: |
              func getCipher($TYPE string, $KEY []byte) cipher.Block {
                ...
                return des.NewCipher($KEY)
                ...
              }
          - pattern: |
              $CIPHER := getCipherByName($CONFIG.Algorithm, $KEY)
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: Dynamic cipher selection detected in codebase"
  - id: go-crypto-argon2
    message: Argon2 key derivation function usage detected
    severity: INFO
    languages:
      - go
    patterns:
      - pattern-either:
          - pattern: argon2.Key($PASSWORD, $SALT, $TIME, $MEMORY, $THREADS, $KEYLEN)
          - pattern: argon2.IDKey($PASSWORD, $SALT, $TIME, $MEMORY, $THREADS, $KEYLEN)
          - pattern: |
              $KEY := argon2.Key($PASSWORD, $SALT, $TIME, $MEMORY, $THREADS, $KEYLEN)
              ...
              $KEY
          - patterns:
              - pattern: argon2.Key($PASSWORD, $SALT, $TIME, $MEMORY, $THREADS, $KEYLEN)
              - metavariable-regex:
                  metavariable: $TIME
                  regex: \d+
              - metavariable-regex:
                  metavariable: $MEMORY
                  regex: \d+
              - metavariable-regex:
                  metavariable: $THREADS
                  regex: \d+
              - metavariable-regex:
                  metavariable: $KEYLEN
                  regex: \d+
          - patterns:
              - pattern: argon2.IDKey($PASSWORD, $SALT, $TIME, $MEMORY, $THREADS, $KEYLEN)
              - metavariable-regex:
                  metavariable: $TIME
                  regex: \d+
              - metavariable-regex:
                  metavariable: $MEMORY
                  regex: \d+
              - metavariable-regex:
                  metavariable: $THREADS
                  regex: \d+
              - metavariable-regex:
                  metavariable: $KEYLEN
                  regex: \d+
    metadata:
      category: crypto
      cwe: CWE-326
      impact: "Inventory: Argon2 key derivation function usage detected in codebase"
  - id: go-crypto-bcrypt
    message: bcrypt password hashing usage detected
    severity: INFO
    languages:
      - go
    patterns:
      - pattern-either:
          - pattern: bcrypt.GenerateFromPassword($PASSWORD, $COST)
          - pattern: bcrypt.CompareHashAndPassword($HASH, $PASSWORD)
          - pattern: |
              $HASH, $ERR := bcrypt.GenerateFromPassword($PASSWORD, $COST)
              ...
              $HASH
          - pattern: |
              $ERR := bcrypt.CompareHashAndPassword($HASH, $PASSWORD)
              ...
          - patterns:
              - pattern: bcrypt.GenerateFromPassword($PASSWORD, $COST)
              - metavariable-regex:
                  metavariable: $COST
                  regex: \d+
    metadata:
      category: crypto
      cwe: CWE-326
      impact: "Inventory: bcrypt password hashing usage detected in codebase"
  - id: go-crypto-diffie-hellman
    message: Diffie-Hellman key exchange usage detected
    severity: INFO
    languages:
      - go
    patterns:
      - pattern-either:
          - pattern: dh.GenerateKey($GROUP)
          - pattern: dh.ComputeSecret($PRIV, $PUB)
          - pattern: |
              $PRIV, $PUB, $ERR := dh.GenerateKey($GROUP)
              ...
              $SECRET := dh.ComputeSecret($PRIV, $PEER_PUB)
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: Diffie-Hellman key exchange usage detected in codebase"
  - id: go-crypto-cipher-rc2
    message: RC2 cipher usage detected
    severity: INFO
    languages:
      - go
    patterns:
      - pattern-either:
          - pattern: rc2.NewCipher($KEY)
          - pattern: $CIPHER := rc2.NewCipher($KEY)
          - pattern: cipher.NewCBCEncrypter(rc2.NewCipher($KEY), $IV)
          - pattern: cipher.NewCBCDecrypter(rc2.NewCipher($KEY), $IV)
          - pattern: |
              $BLOCK := rc2.NewCipher($KEY)
              ...
              cipher.NewCBCEncrypter($BLOCK, $IV)
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: RC2 cipher usage detected in codebase"
  - id: go-crypto-key-derivation
    message: Key derivation function usage detected
    severity: INFO
    languages:
      - go
    patterns:
      - pattern-either:
          - pattern: $KEY := []byte($PASSWORD)
          - pattern: $KEY := md5.Sum([]byte($PASSWORD))
          - pattern: $KEY := sha1.Sum([]byte($PASSWORD))
          - pattern: $KEY := sha256.Sum256([]byte($PASSWORD))
          - pattern: $KEY := sha512.Sum512([]byte($PASSWORD))
          - pattern: |
              hasher := md5.New()
              ...
              hasher.Write([]byte($PASSWORD))
              ...
              $KEY := hasher.Sum(nil)
          - pattern: |
              hasher := sha1.New()
              ...
              hasher.Write([]byte($PASSWORD))
              ...
              $KEY := hasher.Sum(nil)
          - pattern: |
              hasher := sha256.New()
              ...
              hasher.Write([]byte($PASSWORD))
              ...
              $KEY := hasher.Sum(nil)
          - pattern: |
              hasher := sha512.New()
              ...
              hasher.Write([]byte($PASSWORD))
              ...
              $KEY := hasher.Sum(nil)
          - patterns:
              - pattern: pbkdf2.Key($PASSWORD, $SALT, $ITER, $KEYLEN, $HASH)
              - metavariable-regex:
                  metavariable: $ITER
                  regex: \d+
              - metavariable-regex:
                  metavariable: $KEYLEN
                  regex: \d+
          - pattern: pbkdf2.Key($PASSWORD, nil, $ITER, $KEYLEN, $HASH)
          - pattern: pbkdf2.Key($PASSWORD, []byte("$STATIC_SALT"), $ITER, $KEYLEN, $HASH)
          - pattern: |
              $KEY := pbkdf2.Key($PASSWORD, $SALT, $ITER, $KEYLEN, $HASH)
              ...
              aes.NewCipher($KEY)
          - pattern: |
              $KEY := pbkdf2.Key($PASSWORD, $SALT, $ITER, $KEYLEN, $HASH)
              ...
              des.NewCipher($KEY)
    metadata:
      category: crypto
      cwe: CWE-326
      impact: "Inventory: Key derivation function usage detected in codebase"
  - id: go-crypto-md5
    message: MD5 hash function usage detected
    severity: INFO
    languages:
      - go
    patterns:
      - pattern-either:
          - pattern: md5.New()
          - pattern: md5.Sum($DATA)
          - pattern: |
              $HASHER := md5.New()
              $HASHER.Write($DATA)
              $HASH := $HASHER.Sum($SUFFIX)
          - pattern: |
              $HASHER := md5.New()
              ...
              $HASHER.Sum($SUFFIX)
          - pattern: crypto.MD5.New()
          - pattern: |
              $HASH := crypto.MD5
              $HASHER := $HASH.New()
          - pattern: var $HASHER hash.Hash = md5.New()
          - pattern: $HASHER := hash.Hash(md5.New())
          - pattern: hex.EncodeToString(md5.Sum($DATA))
          - pattern: base64.StdEncoding.EncodeToString(md5.Sum($DATA))
          - pattern: fmt.Sprintf("%x", md5.Sum($DATA))
          - pattern: fmt.Sprintf("%X", md5.Sum($DATA))
          - pattern: io.WriteString(md5.New(), $DATA)
          - pattern: |
              $HASHER := md5.New()
              io.Copy($HASHER, $READER)
          - pattern: hmac.New(md5.New, $KEY)
          - pattern: hmac.New(crypto.MD5.New, $KEY)
          - pattern: pbkdf2.Key($PASSWORD, $SALT, $ITER, $KEYLEN, md5.New)
          - pattern: pbkdf2.Key($PASSWORD, $SALT, $ITER, $KEYLEN, crypto.MD5.New)
          - pattern: $HASH := md5.Sum($DATA)
          - pattern: $CHECKSUM := md5.Sum($DATA)
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: MD5 hash function usage detected in codebase"
  - id: go-crypto-cipher-blowfish
    message: Blowfish cipher usage detected
    severity: INFO
    languages:
      - go
    patterns:
      - pattern-either:
          - pattern: blowfish.NewCipher($KEY)
          - pattern: blowfish.NewSaltedCipher($KEY, $SALT)
          - pattern: $CIPHER := blowfish.NewCipher($KEY)
          - pattern: $CIPHER := blowfish.NewSaltedCipher($KEY, $SALT)
          - pattern: cipher.NewCBCDecrypter(blowfish.NewCipher($KEY), $IV)
          - pattern: cipher.NewCBCEncrypter(blowfish.NewCipher($KEY), $IV)
          - pattern: cipher.NewOFB(blowfish.NewCipher($KEY), $IV)
          - pattern: cipher.NewCFBDecrypter(blowfish.NewCipher($KEY), $IV)
          - pattern: cipher.NewCFBEncrypter(blowfish.NewCipher($KEY), $IV)
          - pattern: cipher.NewCTR(blowfish.NewCipher($KEY), $IV)
          - pattern: |
              $BLOCK := blowfish.NewCipher($KEY)
              ...
              cipher.NewCBCEncrypter($BLOCK, $IV)
          - pattern: |
              $BLOCK := blowfish.NewSaltedCipher($KEY, $SALT)
              ...
              cipher.NewCBCDecrypter($BLOCK, $IV)
          - pattern: var $CIPHER cipher.Block = blowfish.NewCipher($KEY)
          - pattern: $CIPHER := cipher.Block(blowfish.NewCipher($KEY))
          - pattern: |
              func $FNAME($CIPHER cipher.Block) {
                ...
              }
              ...
              $FNAME(blowfish.NewCipher($KEY))
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: Blowfish cipher usage detected in codebase"
  - id: go-crypto-cipher-rc4
    message: RC4 stream cipher usage detected
    severity: INFO
    languages:
      - go
    patterns:
      - pattern-either:
          - pattern: rc4.NewCipher($KEY)
          - pattern: $CIPHER := rc4.NewCipher($KEY)
          - pattern: $STREAM := rc4.NewCipher($KEY)
          - pattern: "cipher.StreamReader{S: rc4.NewCipher($KEY), R: $READER}"
          - pattern: "cipher.StreamWriter{S: rc4.NewCipher($KEY), W: $WRITER}"
          - pattern: |
              $CIPHER := rc4.NewCipher($KEY)
              $CIPHER.XORKeyStream($DST, $SRC)
          - pattern: |
              $CIPHER := rc4.NewCipher($KEY)
              ...
              $CIPHER.XORKeyStream($DST, $SRC)
          - pattern: |
              $CIPHER := rc4.NewCipher($KEY)
              $READER := cipher.StreamReader{S: $CIPHER, R: $INPUT}
          - pattern: |
              $CIPHER := rc4.NewCipher($KEY)
              $WRITER := cipher.StreamWriter{S: $CIPHER, W: $OUTPUT}
          - pattern: var $STREAM cipher.Stream = rc4.NewCipher($KEY)
          - pattern: $STREAM := cipher.Stream(rc4.NewCipher($KEY))
          - pattern: |
              func $FNAME($STREAM cipher.Stream) {
                ...
              }
              ...
              $FNAME(rc4.NewCipher($KEY))
          - pattern: |
              $CIPHER := rc4.NewCipher($KEY)
              io.Copy($WRITER, &cipher.StreamReader{S: $CIPHER, R: $READER})
          - pattern: |
              $CIPHER := rc4.NewCipher($KEY)
              for $I := 0; $I < len($DATA); $I++ {
                $DATA[$I] ^= $CIPHER.XORKeyStream($DST, $SRC)
              }
          - pattern: |
              $CIPHER, $ERR := rc4.NewCipher($KEY)
              if $ERR == nil {
                $CIPHER.XORKeyStream($DST, $SRC)
              }
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: RC4 stream cipher usage detected in codebase"
  - id: go-crypto-hash-legacy
    message: Legacy hash function usage detected
    severity: INFO
    languages:
      - go
    patterns:
      - pattern-either:
          - pattern: md4.New()
          - pattern: md4.Sum($DATA)
          - pattern: ripemd160.New()
          - pattern: |
              hasher := md4.New()
              ...
              hasher.Write($DATA)
              ...
              $HASH := hasher.Sum(nil)
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: Legacy hash function usage detected in codebase"
  - id: go-crypto-cipher-modes
    message: Cipher mode usage detected
    severity: INFO
    languages:
      - go
    patterns:
      - pattern-either:
          - pattern: cipher.NewOFB($BLOCK, $IV)
          - pattern: cipher.NewCFB($BLOCK, $IV)
          - pattern: cipher.NewCFBEncrypter($BLOCK, $IV)
          - pattern: cipher.NewCFBDecrypter($BLOCK, $IV)
          - pattern: cipher.NewCBCEncrypter($BLOCK, $IV)
          - pattern: cipher.NewCBCDecrypter($BLOCK, $IV)
          - pattern: cipher.NewGCM($BLOCK)
          - pattern: |
              $GCM := cipher.NewGCM($BLOCK)
              ...
              $GCM.Seal($DST, $NONCE, $PLAINTEXT, $DATA)
          - pattern: |
              $GCM := cipher.NewGCM($BLOCK)
              ...
              $GCM.Open($DST, $NONCE, $CIPHERTEXT, $DATA)
          - pattern: |
              $STREAM := cipher.NewCTR($BLOCK, $IV)
              ...
              $STREAM.XORKeyStream($DST, $SRC)
          - pattern: |
              $MODE := cipher.NewCBCEncrypter($BLOCK, $IV)
              ...
              $MODE.CryptBlocks($DST, $SRC)
          - pattern: |
              $MODE := cipher.NewCBCDecrypter($BLOCK, $IV)
              ...
              $MODE.CryptBlocks($DST, $SRC)
    metadata:
      category: crypto
      cwe: CWE-327
      impact:
        "Inventory: Cipher mode usage detected in codebase (OFB, CFB, CTR, CBC,
        GCM)"
  - id: go-crypto-hash-comparison
    message: Hash function used in comparison or verification detected
    severity: INFO
    languages:
      - go
    patterns:
      - pattern-either:
          - pattern: |
              $EXPECTED := md5.Sum($DATA)
              ...
              $ACTUAL := md5.Sum($OTHER)
              ...
              bytes.Equal($EXPECTED[:], $ACTUAL[:])
          - pattern: |
              $EXPECTED := sha1.Sum($DATA)
              ...
              $ACTUAL := sha1.Sum($OTHER)
              ...
              bytes.Equal($EXPECTED[:], $ACTUAL[:])
          - pattern: |
              $HASH1 := hex.EncodeToString(md5.Sum($DATA1))
              $HASH2 := hex.EncodeToString(md5.Sum($DATA2))
              ...
              $HASH1 == $HASH2
          - pattern: |
              $HASH1 := hex.EncodeToString(sha1.Sum($DATA1))
              $HASH2 := hex.EncodeToString(sha1.Sum($DATA2))
              ...
              $HASH1 == $HASH2
          - pattern: |
              if hex.EncodeToString(md5.Sum($DATA)) == $EXPECTED {
                ...
              }
          - pattern: |
              if hex.EncodeToString(sha1.Sum($DATA)) == $EXPECTED {
                ...
              }
    metadata:
      category: crypto
      cwe: CWE-327
      impact:
        "Inventory: Hash function used in comparison or verification detected
        in codebase"
  - id: go-crypto-salt-generation
    message: Salt generation for cryptographic use detected
    severity: INFO
    languages:
      - go
    patterns:
      - pattern-either:
          - pattern: |
              $SALT := make([]byte, $SIZE)
              ...
              rand.Read($SALT)
              ...
              pbkdf2.Key($PASSWORD, $SALT, $ITER, $KEYLEN, $HASH)
          - pattern: |
              $SALT := make([]byte, $SIZE)
              ...
              rand.Read($SALT)
              ...
              bcrypt.GenerateFromPassword($PASSWORD, $COST)
          - pattern: |
              $SALT := make([]byte, $SIZE)
              ...
              rand.Read($SALT)
              ...
              scrypt.Key($PASSWORD, $SALT, $N, $R, $P, $KEYLEN)
          - pattern: |
              $SALT := make([]byte, $SIZE)
              ...
              rand.Read($SALT)
              ...
              argon2.IDKey($PASSWORD, $SALT, $TIME, $MEMORY, $THREADS, $KEYLEN)
          - pattern: |
              $SALT := make([]byte, $SIZE)
              ...
              rand.Read($SALT)
              ...
              argon2.Key($PASSWORD, $SALT, $TIME, $MEMORY, $THREADS, $KEYLEN)
          - pattern: |
              $SALT := []byte("$STATIC_SALT")
              ...
              pbkdf2.Key($PASSWORD, $SALT, $ITER, $KEYLEN, $HASH)
          - pattern: |
              const $SALT = "$STATIC_SALT"
              ...
              pbkdf2.Key($PASSWORD, []byte($SALT), $ITER, $KEYLEN, $HASH)
          - pattern: |
              var $SALT = []byte("$STATIC_SALT")
              ...
              pbkdf2.Key($PASSWORD, $SALT, $ITER, $KEYLEN, $HASH)
          - pattern: |
              $SALT := make([]byte, $SIZE)
              ...
              io.ReadFull(rand.Reader, $SALT)
              ...
              pbkdf2.Key($PASSWORD, $SALT, $ITER, $KEYLEN, $HASH)
    metadata:
      category: crypto
      cwe: CWE-759
      impact: "Inventory: Salt generation for cryptographic use detected in codebase"
  - id: go-crypto-sha512
    message: SHA512 hash function usage detected
    severity: INFO
    languages:
      - go
    patterns:
      - pattern-either:
          - pattern: sha512.New()
          - pattern: sha512.Sum512($DATA)
          - pattern: |
              $HASHER := sha512.New()
              $HASHER.Write($DATA)
              $HASH := $HASHER.Sum($SUFFIX)
          - pattern: |
              $HASHER := sha512.New()
              ...
              $HASHER.Sum($SUFFIX)
          - pattern: crypto.SHA512.New()
          - pattern: |
              $HASH := crypto.SHA512
              $HASHER := $HASH.New()
          - pattern: var $HASHER hash.Hash = sha512.New()
          - pattern: $HASHER := hash.Hash(sha512.New())
          - pattern: hex.EncodeToString(sha512.Sum512($DATA))
          - pattern: base64.StdEncoding.EncodeToString(sha512.Sum512($DATA))
          - pattern: fmt.Sprintf("%x", sha512.Sum512($DATA))
          - pattern: fmt.Sprintf("%X", sha512.Sum512($DATA))
          - pattern: io.WriteString(sha512.New(), $DATA)
          - pattern: |
              $HASHER := sha512.New()
              io.Copy($HASHER, $READER)
          - pattern: hmac.New(sha512.New, $KEY)
          - pattern: hmac.New(crypto.SHA512.New, $KEY)
          - pattern: pbkdf2.Key($PASSWORD, $SALT, $ITER, $KEYLEN, sha512.New)
          - pattern: pbkdf2.Key($PASSWORD, $SALT, $ITER, $KEYLEN, crypto.SHA512.New)
          - pattern: rsa.SignPKCS1v15($RAND, $PRIV, crypto.SHA512, $HASHED)
          - pattern: rsa.VerifyPKCS1v15($PUB, crypto.SHA512, $HASHED, $SIG)
          - pattern: ecdsa.Sign($RAND, $PRIV, sha512.Sum512($DATA))
          - pattern: $HASH := sha512.Sum512($DATA)
          - pattern: $CHECKSUM := sha512.Sum512($DATA)
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: SHA512 hash function usage detected in codebase"
  - id: go-crypto-cipher-suites
    message: TLS cipher suite usage detected
    severity: INFO
    languages:
      - go
    patterns:
      - pattern-either:
          - pattern: tls.TLS_RSA_WITH_NULL_MD5
          - pattern: tls.TLS_RSA_WITH_NULL_SHA
          - pattern: tls.TLS_NULL_WITH_NULL_NULL
          - pattern: tls.TLS_RSA_EXPORT_WITH_RC4_40_MD5
          - pattern: tls.TLS_RSA_EXPORT_WITH_RC2_CBC_40_MD5
          - pattern: tls.TLS_DH_anon_EXPORT_WITH_RC4_40_MD5
          - pattern: tls.TLS_DH_anon_WITH_RC4_128_MD5
          - pattern: tls.TLS_DH_anon_WITH_3DES_EDE_CBC_SHA
          - pattern: tls.TLS_DH_anon_WITH_AES_128_CBC_SHA
          - pattern: tls.TLS_DH_anon_WITH_AES_256_CBC_SHA
          - pattern: tls.TLS_RSA_WITH_RC4_128_MD5
          - pattern: tls.TLS_RSA_WITH_RC4_128_SHA
          - pattern: tls.TLS_ECDHE_RSA_WITH_RC4_128_SHA
          - pattern: tls.TLS_ECDHE_ECDSA_WITH_RC4_128_SHA
          - pattern: tls.TLS_RSA_WITH_DES_CBC_SHA
          - pattern: tls.TLS_DHE_RSA_WITH_DES_CBC_SHA
          - pattern: tls.TLS_RSA_WITH_3DES_EDE_CBC_SHA
          - pattern: tls.TLS_DHE_RSA_WITH_3DES_EDE_CBC_SHA
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: TLS cipher suite usage detected in codebase"
  - id: go-crypto-aes-ecb-mode
    message: AES ECB cipher mode usage detected
    severity: INFO
    languages:
      - go
    patterns:
      - pattern-either:
          - pattern: cipher.NewECBDecrypter($BLOCK)
          - pattern: cipher.NewECBEncrypter($BLOCK)
          - pattern: |
              $BLOCK := aes.NewCipher($KEY)
              ...
              cipher.NewECBDecrypter($BLOCK)
          - pattern: |
              $BLOCK := aes.NewCipher($KEY)
              ...
              cipher.NewECBEncrypter($BLOCK)
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: AES ECB cipher mode usage detected in codebase"
  - id: go-crypto-digital-signatures
    message: Digital signature operations detected
    severity: INFO
    languages:
      - go
    patterns:
      - pattern-either:
          - pattern: rsa.SignPKCS1v15($RAND, $PRIV, $HASH, $HASHED)
          - pattern: rsa.SignPSS($RAND, $PRIV, $HASH, $HASHED, $OPTS)
          - pattern: rsa.VerifyPKCS1v15($PUB, $HASH, $HASHED, $SIG)
          - pattern: rsa.VerifyPSS($PUB, $HASH, $HASHED, $SIG, $OPTS)
          - pattern: ecdsa.Sign($RAND, $PRIV, $HASH)
          - pattern: ecdsa.Verify($PUB, $HASH, $R, $S)
          - pattern: dsa.Sign($RAND, $PRIV, $HASH)
          - pattern: dsa.Verify($PUB, $HASH, $R, $S)
          - pattern: ed25519.Sign($PRIV, $MSG)
          - pattern: ed25519.Verify($PUB, $MSG, $SIG)
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: Digital signature operations detected in codebase"
  - id: go-crypto-cipher-des
    message: DES cipher usage detected
    severity: INFO
    languages:
      - go
    patterns:
      - pattern-either:
          - pattern: des.NewCipher($KEY)
          - pattern: des.NewTripleDESCipher($KEY)
          - pattern: $CIPHER := des.NewCipher($KEY)
          - pattern: $CIPHER := des.NewTripleDESCipher($KEY)
          - pattern: cipher.NewCBCDecrypter(des.NewCipher($KEY), $IV)
          - pattern: cipher.NewCBCEncrypter(des.NewCipher($KEY), $IV)
          - pattern: cipher.NewOFB(des.NewCipher($KEY), $IV)
          - pattern: cipher.NewCFBDecrypter(des.NewCipher($KEY), $IV)
          - pattern: cipher.NewCFBEncrypter(des.NewCipher($KEY), $IV)
          - pattern: cipher.NewCTR(des.NewCipher($KEY), $IV)
          - pattern: |
              $BLOCK := des.NewCipher($KEY)
              ...
              cipher.NewCBCEncrypter($BLOCK, $IV)
          - pattern: |
              $BLOCK := des.NewCipher($KEY)
              ...
              cipher.NewCBCDecrypter($BLOCK, $IV)
          - pattern: |
              $BLOCK := des.NewTripleDESCipher($KEY)
              ...
              cipher.NewCBCEncrypter($BLOCK, $IV)
          - pattern: var $CIPHER cipher.Block = des.NewCipher($KEY)
          - pattern: $CIPHER := cipher.Block(des.NewCipher($KEY))
          - pattern: |
              func $FNAME($CIPHER cipher.Block) {
                ...
              }
              ...
              $FNAME(des.NewCipher($KEY))
          - pattern: |
              $STREAM := cipher.NewOFB(des.NewCipher($KEY), $IV)
              $STREAM.XORKeyStream($DST, $SRC)
          - pattern: |
              $KEY24 := append($KEY8, $KEY8...)
              ...
              des.NewTripleDESCipher($KEY24)
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: DES cipher usage detected in codebase"
  - id: go-crypto-sha256
    message: SHA256 hash function usage detected
    severity: INFO
    languages:
      - go
    patterns:
      - pattern-either:
          - pattern: sha256.New()
          - pattern: sha256.Sum256($DATA)
          - pattern: |
              $HASHER := sha256.New()
              $HASHER.Write($DATA)
              $HASH := $HASHER.Sum($SUFFIX)
          - pattern: |
              $HASHER := sha256.New()
              ...
              $HASHER.Sum($SUFFIX)
          - pattern: crypto.SHA256.New()
          - pattern: |
              $HASH := crypto.SHA256
              $HASHER := $HASH.New()
          - pattern: var $HASHER hash.Hash = sha256.New()
          - pattern: $HASHER := hash.Hash(sha256.New())
          - pattern: hex.EncodeToString(sha256.Sum256($DATA))
          - pattern: base64.StdEncoding.EncodeToString(sha256.Sum256($DATA))
          - pattern: fmt.Sprintf("%x", sha256.Sum256($DATA))
          - pattern: fmt.Sprintf("%X", sha256.Sum256($DATA))
          - pattern: io.WriteString(sha256.New(), $DATA)
          - pattern: |
              $HASHER := sha256.New()
              io.Copy($HASHER, $READER)
          - pattern: hmac.New(sha256.New, $KEY)
          - pattern: hmac.New(crypto.SHA256.New, $KEY)
          - pattern: pbkdf2.Key($PASSWORD, $SALT, $ITER, $KEYLEN, sha256.New)
          - pattern: pbkdf2.Key($PASSWORD, $SALT, $ITER, $KEYLEN, crypto.SHA256.New)
          - pattern: rsa.SignPKCS1v15($RAND, $PRIV, crypto.SHA256, $HASHED)
          - pattern: rsa.VerifyPKCS1v15($PUB, crypto.SHA256, $HASHED, $SIG)
          - pattern: ecdsa.Sign($RAND, $PRIV, sha256.Sum256($DATA))
          - pattern: $HASH := sha256.Sum256($DATA)
          - pattern: $CHECKSUM := sha256.Sum256($DATA)
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: SHA256 hash function usage detected in codebase"
  - id: go-crypto-hash-interface
    message: Hash algorithm used via generic hash.Hash interface detected
    severity: INFO
    languages:
      - go
    patterns:
      - pattern-either:
          - pattern: |
              func $FNAME($HASHER hash.Hash) {
                ...
              }
              ...
              $FNAME(md5.New())
          - pattern: |
              func $FNAME($HASHER hash.Hash) {
                ...
              }
              ...
              $FNAME(sha1.New())
          - pattern: |
              func $FNAME() hash.Hash {
                return md5.New()
              }
          - pattern: |
              func $FNAME() hash.Hash {
                return sha1.New()
              }
          - pattern: |
              $HASHERS := map[$KEY]hash.Hash{
                ...,
                $ENTRY: md5.New(),
                ...
              }
          - pattern: |
              $HASHERS := []hash.Hash{
                ...,
                md5.New(),
                ...
              }
    metadata:
      category: crypto
      cwe: CWE-327
      impact:
        "Inventory: Hash algorithm used via generic hash.Hash interface detected
        in codebase"
  - id: go-crypto-hardcoded-key
    message: Hardcoded cryptographic key detected
    severity: INFO
    languages:
      - go
    patterns:
      - pattern-either:
          - pattern: |
              $KEY := "$VALUE"
              ...
              aes.NewCipher($KEY)
          - pattern: aes.NewCipher("$KEY")
          - pattern: aes.NewCipher([]byte("$KEY"))
          - pattern: |
              const $KEY = "$VALUE"
              ...
              aes.NewCipher([]byte($KEY))
          - pattern: |
              var $KEY = "$VALUE"
              ...
              aes.NewCipher([]byte($KEY))
          - pattern: |
              var $KEY = []byte("$VALUE")
              ...
              aes.NewCipher($KEY)
          - pattern: |
              var $KEY string = "$VALUE"
              ...
              aes.NewCipher([]byte($KEY))
          - pattern: |
              var $KEY []byte = []byte("$VALUE")
              ...
              aes.NewCipher($KEY)
          - pattern: |
              type $CONFIG struct {
                $FIELD string
              }
              ...
              $CONFIG{$FIELD: "$KEY"}
              ...
              aes.NewCipher([]byte($CONFIG.$FIELD))
          - pattern: |
              type $CONFIG struct {
                $FIELD []byte
              }
              ...
              $CONFIG{$FIELD: []byte("$KEY")}
              ...
              aes.NewCipher($CONFIG.$FIELD)
          - pattern: |
              $KEY := os.Getenv("$ENV_VAR")
              if $KEY == "" {
                $KEY = "$DEFAULT_KEY"
              }
              ...
              aes.NewCipher([]byte($KEY))
          - pattern: |
              $KEY := os.Getenv("$ENV_VAR")
              if len($KEY) == 0 {
                $KEY = "$DEFAULT_KEY"
              }
              ...
              aes.NewCipher([]byte($KEY))
          - pattern: |
              $KEY := os.Getenv("$ENV_VAR")
              if $KEY == "" {
                $KEY = "$DEFAULT_KEY"
              }
              ...
              aes.NewCipher($KEY)
          - pattern: |
              $KEY := os.Getenv("$ENV_VAR")
              if $KEY == "" {
                $KEY = "$DEFAULT_KEY"
              }
              ...
              des.NewCipher([]byte($KEY))
          - pattern: |
              $KEY := os.Getenv("$ENV_VAR")
              if $KEY == "" {
                $KEY = "$DEFAULT_KEY"
              }
              ...
              rc4.NewCipher([]byte($KEY))
          - pattern: cipher.NewCFBDecrypter($BLOCK, "$IV")
          - pattern: cipher.NewCFBEncrypter($BLOCK, []byte("$IV"))
          - pattern: cipher.NewCBCEncrypter($BLOCK, []byte("$IV"))
          - pattern: cipher.NewCBCDecrypter($BLOCK, []byte("$IV"))
          - pattern: cipher.NewOFB($BLOCK, []byte("$IV"))
          - pattern: |
              $IV := "$STATIC_IV"
              ...
              cipher.NewCFBDecrypter($BLOCK, []byte($IV))
          - pattern: |
              $IV := "$STATIC_IV"
              ...
              cipher.NewCFBEncrypter($BLOCK, []byte($IV))
          - pattern: |
              const $IV = "$STATIC_IV"
              ...
              cipher.NewCFBDecrypter($BLOCK, []byte($IV))
          - pattern: |
              var $IV = "$STATIC_IV"
              ...
              cipher.NewCFBDecrypter($BLOCK, []byte($IV))
    metadata:
      category: crypto
      cwe: CWE-798
      impact: "Inventory: Hardcoded cryptographic key detected in codebase"
  - id: go-crypto-rsa
    message: RSA cryptographic operations detected
    severity: INFO
    languages:
      - go
    patterns:
      - pattern-either:
          - pattern: rsa.GenerateKey($RAND, $BITS)
          - pattern: rsa.GenerateMultiPrimeKey($RAND, $PRIMES, $BITS)
          - pattern: rsa.EncryptPKCS1v15($RAND, $PUB, $MSG)
          - pattern: rsa.EncryptOAEP($HASH, $RAND, $PUB, $MSG, $LABEL)
          - pattern: rsa.DecryptPKCS1v15($RAND, $PRIV, $CIPHERTEXT)
          - pattern: rsa.DecryptOAEP($HASH, $RAND, $PRIV, $CIPHERTEXT, $LABEL)
          - pattern: rsa.SignPKCS1v15($RAND, $PRIV, $HASH, $HASHED)
          - pattern: rsa.SignPSS($RAND, $PRIV, $HASH, $HASHED, $OPTS)
          - pattern: rsa.VerifyPKCS1v15($PUB, $HASH, $HASHED, $SIG)
          - pattern: rsa.VerifyPSS($PUB, $HASH, $HASHED, $SIG, $OPTS)
          - pattern: |
              $PRIV, $ERR := rsa.GenerateKey($RAND, $BITS)
              ...
              $PRIV.PublicKey
          - patterns:
              - pattern: rsa.GenerateKey($RAND, $BITS)
              - metavariable-regex:
                  metavariable: $BITS
                  regex: \d+
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: RSA cryptographic operations detected in codebase"
  - id: go-crypto-aes
    message: AES cipher usage detected
    severity: INFO
    languages:
      - go
    patterns:
      - pattern-either:
          - pattern: aes.NewCipher($KEY)
          - pattern: $CIPHER := aes.NewCipher($KEY)
          - pattern: cipher.NewCBCDecrypter(aes.NewCipher($KEY), $IV)
          - pattern: cipher.NewCBCEncrypter(aes.NewCipher($KEY), $IV)
          - pattern: cipher.NewGCM(aes.NewCipher($KEY))
          - pattern: cipher.NewCFBDecrypter(aes.NewCipher($KEY), $IV)
          - pattern: cipher.NewCFBEncrypter(aes.NewCipher($KEY), $IV)
          - pattern: cipher.NewCTR(aes.NewCipher($KEY), $IV)
          - pattern: |
              $BLOCK := aes.NewCipher($KEY)
              ...
              cipher.NewCBCEncrypter($BLOCK, $IV)
          - pattern: |
              $BLOCK := aes.NewCipher($KEY)
              ...
              cipher.NewGCM($BLOCK)
          - pattern: var $CIPHER cipher.Block = aes.NewCipher($KEY)
          - pattern: $CIPHER := cipher.Block(aes.NewCipher($KEY))
          - patterns:
              - pattern: aes.NewCipher(make([]byte, $SIZE))
              - metavariable-regex:
                  metavariable: $SIZE
                  regex: \d+
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: AES cipher usage detected in codebase"
  - id: go-crypto-hkdf
    message: HKDF key derivation function usage detected
    severity: INFO
    languages:
      - go
    patterns:
      - pattern-either:
          - pattern: hkdf.New($HASH, $SECRET, $SALT, $INFO)
          - pattern: hkdf.Extract($HASH, $SECRET, $SALT)
          - pattern: hkdf.Expand($HASH, $PRK, $INFO)
          - pattern: |
              $HKDF := hkdf.New($HASH, $SECRET, $SALT, $INFO)
              $HKDF.Read($KEY)
          - pattern: |
              $PRK := hkdf.Extract($HASH, $SECRET, $SALT)
              ...
              hkdf.Expand($HASH, $PRK, $INFO)
    metadata:
      category: crypto
      cwe: CWE-326
      impact: "Inventory: HKDF key derivation function usage detected in codebase"
  - id: go-crypto-random-generation
    message: Random number generation for cryptographic use detected
    severity: INFO
    languages:
      - go
    patterns:
      - pattern-either:
          - pattern: |
              $KEY := make([]byte, $SIZE)
              ...
              rand.Read($KEY)
          - pattern: |
              $IV := make([]byte, $SIZE)
              ...
              rand.Read($IV)
          - pattern: rand.Read($BYTES)
          - pattern: rand.Int($RANDOM, $MAX)
          - pattern: rand.Prime($RANDOM, $BITS)
          - pattern: io.ReadFull(rand.Reader, $BUFFER)
          - pattern: |
              $BUFFER := make([]byte, $SIZE)
              ...
              io.ReadFull(rand.Reader, $BUFFER)
          - pattern: math/rand.Read($BYTES)
          - pattern: mathrand.Read($BYTES)
          - pattern: |
              rand.Seed($SEED)
              ...
              rand.Intn($MAX)
          - pattern: |
              mathrand.Seed($SEED)
              ...
              mathrand.Intn($MAX)
          - pattern: math/rand.New($SOURCE)
          - pattern: mathrand.New($SOURCE)
          - pattern: math/rand.NewSource($SEED)
          - pattern: mathrand.NewSource($SEED)
    metadata:
      category: crypto
      cwe: CWE-338
      impact:
        "Inventory: Random number generation for cryptographic use detected in
        codebase"
  - id: go-crypto-scrypt
    message: scrypt key derivation function usage detected
    severity: INFO
    languages:
      - go
    patterns:
      - pattern-either:
          - pattern: scrypt.Key($PASSWORD, $SALT, $N, $R, $P, $KEYLEN)
          - pattern: |
              $KEY, $ERR := scrypt.Key($PASSWORD, $SALT, $N, $R, $P, $KEYLEN)
              ...
              $KEY
          - patterns:
              - pattern: scrypt.Key($PASSWORD, $SALT, $N, $R, $P, $KEYLEN)
              - metavariable-regex:
                  metavariable: $N
                  regex: \d+
              - metavariable-regex:
                  metavariable: $R
                  regex: \d+
              - metavariable-regex:
                  metavariable: $P
                  regex: \d+
              - metavariable-regex:
                  metavariable: $KEYLEN
                  regex: \d+
    metadata:
      category: crypto
      cwe: CWE-326
      impact: "Inventory: scrypt key derivation function usage detected in codebase"
  - id: go-crypto-key-length
    message: Cryptographic key length usage detected
    severity: INFO
    languages:
      - go
    patterns:
      - pattern-either:
          - pattern: |
              $KEY := make([]byte, 8)
              ...
              aes.NewCipher($KEY)
          - pattern: |
              $KEY := make([]byte, 16)
              ...
              aes.NewCipher($KEY)
          - pattern: aes.NewCipher([]byte("$KEY"))
          - patterns:
              - pattern: aes.NewCipher($KEY)
              - metavariable-pattern:
                  metavariable: $KEY
                  pattern: make([]byte, $SIZE)
    metadata:
      category: crypto
      cwe: CWE-326
      impact: "Inventory: Cryptographic key length usage detected in codebase"
  - id: go-crypto-sha3
    message: SHA3 hash function usage detected
    severity: INFO
    languages:
      - go
    patterns:
      - pattern-either:
          - pattern: sha3.New224()
          - pattern: sha3.New256()
          - pattern: sha3.New384()
          - pattern: sha3.New512()
          - pattern: |
              $HASHER := sha3.New224()
              $HASHER.Write($DATA)
              $HASH := $HASHER.Sum($SUFFIX)
          - pattern: |
              $HASHER := sha3.New256()
              $HASHER.Write($DATA)
              $HASH := $HASHER.Sum($SUFFIX)
          - pattern: |
              $HASHER := sha3.New384()
              $HASHER.Write($DATA)
              $HASH := $HASHER.Sum($SUFFIX)
          - pattern: |
              $HASHER := sha3.New512()
              $HASHER.Write($DATA)
              $HASH := $HASHER.Sum($SUFFIX)
          - pattern: crypto.SHA3_224.New()
          - pattern: crypto.SHA3_256.New()
          - pattern: crypto.SHA3_384.New()
          - pattern: crypto.SHA3_512.New()
          - pattern: var $HASHER hash.Hash = sha3.New256()
          - pattern: $HASHER := hash.Hash(sha3.New512())
          - pattern: hex.EncodeToString($HASHER.Sum(nil))
          - pattern: hmac.New(sha3.New256, $KEY)
          - pattern: hmac.New(crypto.SHA3_256.New, $KEY)
          - pattern: pbkdf2.Key($PASSWORD, $SALT, $ITER, $KEYLEN, sha3.New256)
          - pattern: pbkdf2.Key($PASSWORD, $SALT, $ITER, $KEYLEN, crypto.SHA3_256.New)
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: SHA3 hash function usage detected in codebase"
  - id: go-crypto-certificate-validation
    message: TLS certificate validation configuration detected
    severity: INFO
    languages:
      - go
    patterns:
      - pattern-either:
          - pattern: |
              &tls.Config{InsecureSkipVerify: $BOOL}
          - pattern: |
              $CONFIG := &tls.Config{
                InsecureSkipVerify: $BOOL,
                ...
              }
          - pattern: tls.DialWithDialer($DIALER, $NETWORK, $ADDR, $CONFIG)
          - pattern: tls.Dial($NETWORK, $ADDR, $CONFIG)
          - pattern: |
              $TRANSPORT := &http.Transport{
                TLSClientConfig: &tls.Config{InsecureSkipVerify: $BOOL},
                ...
              }
    metadata:
      category: crypto
      cwe: CWE-295
      impact: "Inventory: TLS certificate validation configuration detected in codebase"
  - id: go-crypto-ecdsa
    message: ECDSA cryptographic operations detected
    severity: INFO
    languages:
      - go
    patterns:
      - pattern-either:
          - pattern: ecdsa.GenerateKey($CURVE, $RAND)
          - pattern: ecdsa.Sign($RAND, $PRIV, $HASH)
          - pattern: ecdsa.Verify($PUB, $HASH, $R, $S)
          - pattern: |
              $PRIV, $ERR := ecdsa.GenerateKey($CURVE, $RAND)
              ...
              $PRIV.PublicKey
          - pattern: |
              $R, $S, $ERR := ecdsa.Sign($RAND, $PRIV, $HASH)
              ...
              ecdsa.Verify(&$PRIV.PublicKey, $HASH, $R, $S)
          - pattern: elliptic.P256()
          - pattern: elliptic.P384()
          - pattern: elliptic.P521()
          - pattern: elliptic.Secp256k1()
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: ECDSA cryptographic operations detected in codebase"
  - id: go-crypto-blake2
    message: BLAKE2 hash function usage detected
    severity: INFO
    languages:
      - go
    patterns:
      - pattern-either:
          - pattern: blake2b.New256($KEY)
          - pattern: blake2b.New512($KEY)
          - pattern: blake2s.New256($KEY)
          - pattern: |
              $HASHER, $ERR := blake2b.New256($KEY)
              $HASHER.Write($DATA)
              $HASH := $HASHER.Sum($SUFFIX)
          - pattern: |
              $HASHER, $ERR := blake2b.New512($KEY)
              $HASHER.Write($DATA)
              $HASH := $HASHER.Sum($SUFFIX)
          - pattern: |
              $HASHER, $ERR := blake2s.New256($KEY)
              $HASHER.Write($DATA)
              $HASH := $HASHER.Sum($SUFFIX)
          - pattern: var $HASHER hash.Hash = $BLAKE2_HASHER
          - pattern: hex.EncodeToString($HASHER.Sum(nil))
          - pattern: hmac.New($BLAKE2_HASHER, $KEY)
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: BLAKE2 hash function usage detected in codebase"
  - id: go-crypto-sha1
    message: SHA1 hash function usage detected
    severity: INFO
    languages:
      - go
    patterns:
      - pattern-either:
          - pattern: sha1.New()
          - pattern: sha1.Sum($DATA)
          - pattern: |
              $HASHER := sha1.New()
              $HASHER.Write($DATA)
              $HASH := $HASHER.Sum($SUFFIX)
          - pattern: |
              $HASHER := sha1.New()
              ...
              $HASHER.Sum($SUFFIX)
          - pattern: crypto.SHA1.New()
          - pattern: |
              $HASH := crypto.SHA1
              $HASHER := $HASH.New()
          - pattern: var $HASHER hash.Hash = sha1.New()
          - pattern: $HASHER := hash.Hash(sha1.New())
          - pattern: hex.EncodeToString(sha1.Sum($DATA))
          - pattern: base64.StdEncoding.EncodeToString(sha1.Sum($DATA))
          - pattern: fmt.Sprintf("%x", sha1.Sum($DATA))
          - pattern: fmt.Sprintf("%X", sha1.Sum($DATA))
          - pattern: io.WriteString(sha1.New(), $DATA)
          - pattern: |
              $HASHER := sha1.New()
              io.Copy($HASHER, $READER)
          - pattern: hmac.New(sha1.New, $KEY)
          - pattern: hmac.New(crypto.SHA1.New, $KEY)
          - pattern: pbkdf2.Key($PASSWORD, $SALT, $ITER, $KEYLEN, sha1.New)
          - pattern: pbkdf2.Key($PASSWORD, $SALT, $ITER, $KEYLEN, crypto.SHA1.New)
          - pattern: rsa.SignPKCS1v15($RAND, $PRIV, crypto.SHA1, $HASHED)
          - pattern: rsa.VerifyPKCS1v15($PUB, crypto.SHA1, $HASHED, $SIG)
          - pattern: ecdsa.Sign($RAND, $PRIV, sha1.Sum($DATA))
          - pattern: $HASH := sha1.Sum($DATA)
          - pattern: $CHECKSUM := sha1.Sum($DATA)
    metadata:
      category: crypto
      cwe: CWE-327
      impact: "Inventory: SHA1 hash function usage detected in codebase"
